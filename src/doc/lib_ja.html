<html lang="ja">
<head>
<meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<style>
<!--
table {
  caption-side : top }
code, samp, kbd {
  font-family : Consolas, 'Courier New', Courier, Monaco, monospace }
kbd {
  font-weight : bolder }
.toc, .run-sample, .code-sample, .def, .usage {
  white-space : pre }
.toc-ref {
  text-align : right }
.check-mark {
  text-align : center }
.note-ref {
  vertical-align : super }
-->
</style>
<title>Sango 1.6.0　ライブラリ解説</title>
</head>

<body>

<h1>はじめに</h1>
<p>標準提供されているモジュールについて，外部モジュールから利用可能な定義について解説します。
  解説の都合上，以下の表記を行います。</p>
<ul>
  <li>実際のプログラム中では「モジュール識別子<code>.</code>識別子」と記述する事項を，「<code>"</code>モジュール名<code>".</code>識別子」と表記します。</li>
  <li><code>data</code>文，<code>extend</code>文の解説において，属性を特定するために，「<code>（</code>ラベル名<code>:）</code>」と便宜的なラベル名を付けることがあります。</li>
</ul>
<p>定義，機能のアベイラビリティ（使用可能性）は【】に入れて表示します。</p>
<table border>
<tr><th>アベイラビリティ</th><th>説明</th></tr>
<tr><td>（非表示）</td><td>仕様は確定し，品質は十分確保されている</td></tr>
<tr><td>Alpha</td><td>開発中であり，仕様が確定されていないか，品質が不十分</td></tr>
<tr><td>Beta</td><td>開発中であり，仕様，品質ともにほぼ確立されている</td></tr>
<tr><td>Limited</td><td>使用は限定されている。例：テスト／デバッグ用の機能，不具合回避のための一時的な機能</td></tr>
<tr><td>Deprecated</td><td>推奨されない。不具合が発見されても修復されない，ドキュメントが更新されない，将来のバージョンで削除される等の可能性がある</td></tr>
</table>

<p>SangoはMIT Licenseに基いて配布されています。</p>
<table border><tr><td>
<p>MIT License </p>
<p>Copyright (c) 2022 AKIYAMA Isao </p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</td></tr></table>

<h1 id="toc">目次</h1>

<div class="toc"><a href="#sango.lang"><code>sango.lang</code></a>
  <a href="#sango.lang.1">型と定数</a>
  <a href="#sango.lang.2">例外</a>
  <a href="#sango.lang.3">オブジェクトの等価判定</a>
  <a href="#sango.lang.4">論理演算</a>
  <a href="#sango.lang.5">算術演算</a>
  <a href="#sango.lang.6">ビット演算</a>
  <a href="#sango.lang.7">大小判定（順序付け）</a>
  <a href="#sango.lang.8">型変換など</a>
  <a href="#sango.lang.9">その他</a>
<a href="#sango.actor"><code>sango.actor</code></a>
  <a href="#sango.actor.1">アクタ</a>
  <a href="#sango.actor.2">メッセージ交換</a>
  <a href="#sango.actor.3">アクタの監視</a>
  <a href="#sango.actor.4">アクタの優先度</a>
<a href="#sango.actor.util"><code>sango.actor.util</code></a>
  <a href="#sango.actor.util.1">アクタの初期化待ち</a>
  <a href="#sango.actor.util.2">serializer</a>
  <a href="#sango.actor.util.3">entity monitor</a>
<a href="#sango.arith"><code>sango.arith</code></a>
  <a href="#sango.arith.1">和</a>
  <a href="#sango.arith.2">最大・最小</a>
  <a href="#sango.arith.3">各種関数</a>
<a href="#sango.arith.math"><code>sango.arith.math</code></a>
  <a href="#sango.arith.math.1">型と定数</a>
  <a href="#sango.arith.math.2">各種関数</a>
<a href="#sango.bool"><code>sango.bool</code></a>
  <a href="#sango.bool.1">可変個入力</code></a>
  <a href="#sango.bool.2">遅延評価</code></a>
<a href="#sango.char"><code>sango.char</code></a>
  <a href="#sango.char.1">判定</a>
  <a href="#sango.char.2">変換</a>
<a href="#sango.char.encoding"><code>sango.char.encoding</code></a>
  <a href="#sango.char.encoding.1">エンコード</code></a>
  <a href="#sango.char.encoding.2">デコード</code></a>
<a href="#sango.cstr"><code>sango.cstr</code></a>
  <a href="#sango.cstr.1">生成</a>
  <a href="#sango.cstr.2">要素処理</a>
  <a href="#sango.cstr.3">行</a>
<a href="#sango.debug"><code>sango.debug</code></a>
  <a href="#sango.debug.1">オブジェクト情報</a>
  <a href="#sango.debug.2">アサーション</a>
  <a href="#sango.debug.3">例外情報</a>
<a href="#sango.entity"><code>sango.entity</code></a>
  <a href="#sango.entity.1">実体</a>
  <a href="#sango.entity.2">弱参照</a>
<a href="#sango.entity.box"><code>sango.entity.box</code></a>
  <a href="#sango.entity.box.1">ボックス</a>
  <a href="#sango.entity.box.2">弱参照</a>
<a href="#sango.entity.domain"><code>sango.entity.domain</code></a>
  <a href="#sango.entity.domain.1">ドメイン</a>
  <a href="#sango.entity.domain.2">実体</a>
  <a href="#sango.entity.domain.3">弱参照</a>
  <a href="#sango.entity.domain.4">固有番号，大小比較</a>
<a href="#sango.entity.existence"><code>sango.entity.existence</code></a> 【Beta】
  <a href="#sango.entity.existence.1">存在</a>
  <a href="#sango.entity.existence.2">弱参照</a>
  <a href="#sango.entity.existence.3">undress・redress</a>
<a href="#sango.fun"><code>sango.fun</code></a>
  <a href="#sango.fun.1">1引数関数への変換</a>
<a href="#sango.io"><code>sango.io</code></a>
  <a href="#sango.io.1">データ定義</a>
  <a href="#sango.io.2">入力ストリーム</a>
  <a href="#sango.io.3">出力ストリーム</a>
  <a href="#sango.io.4">文字入出力ストリーム</a>
  <a href="#sango.io.5">行入力ストリーム</a>
  <a href="#sango.io.6">プリントストリーム</a>
<a href="#sango.io.filesys"><code>sango.io.filesys</code></a> 【Beta】
  <a href="#sango.io.filesys.1">ディレクトリとファイルの操作</a>
  <a href="#sango.io.filesys.2">パスの操作</a>
  <a href="#sango.io.filesys.3">ファイルの入出力</a>
  <a href="#sango.io.filesys.4">一時ファイル</a>
<a href="#sango.io.stdio"><code>sango.io.stdio</code></a>
  <a href="#sango.io.stdio.1">標準入力</a>
  <a href="#sango.io.stdio.2">標準出力</a>
  <a href="#sango.io.stdio.3">標準エラー出力</a>
<a href="#sango.io.util"><code>sango.io.util</code></a>
  <a href="#sango.io.util.1">空ストリーム</a>
  <a href="#sango.io.util.2">ストリングからの入力ストリーム</a>
  <a href="#sango.io.util.3">ストリームデータの連結</a>
  <a href="#sango.io.util.4">pump</a>
<a href="#sango.lang.module"><code>sango.lang.module</code></a> 【Beta】
  <a href="#sango.lang.module.1">モジュールの動的ロード</a>
<a href="#sango.list"><code>sango.list</code></a>
  <a href="#sango.list.1">生成</a>
  <a href="#sango.list.2">判定</a>
  <a href="#sango.list.3">データ供給</a>
  <a href="#sango.list.4">要素処理</a>
<a href="#sango.net.inet"><code>sango.net.inet</code></a> 【Alpha】
<a href="#sango.net.socket"><code>sango.net.socket</code></a> 【Alpha】
<a href="#sango.num.bigint"><code>sango.num.bigint</code></a>
  <a href="#sango.num.bigint.1">生成</a>
  <a href="#sango.num.bigint.2">比較</a>
  <a href="#sango.num.bigint.3">算術演算</a>
  <a href="#sango.num.bigint.4">ビット演算</a>
  <a href="#sango.num.bigint.5">文字表現との変換</a>
  <a href="#sango.num.bigint.6">その他</a>
<a href="#sango.num.int"><code>sango.num.int</code></a>
  <a href="#sango.num.int.1">列挙</a>
  <a href="#sango.num.int.2">文字表現との変換</a>
<a href="#sango.num.real"><code>sango.num.real</code></a>
  <a href="#sango.num.real.1">文字表現との変換</a>
<a href="#sango.string"><code>sango.string</code></a>
  <a href="#sango.string.1">生成</a>
  <a href="#sango.string.2">データ供給</a>
  <a href="#sango.string.3">要素処理</a>
  <a href="#sango.string.4">string buffer</a>
<a href="#sango.system"><code>sango.system</code></a>
  <a href="#sango.system.1">システムプロパティ</a>
<a href="#sango.system.os"><code>sango.system.os</code></a> 【Alpha】
  <a href="#sango.system.os.1">サブプロセス起動</a>
<a href="#sango.system.runtime"><code>sango.system.runtime</code></a>
  <a href="#sango.system.runtime.1">プログラム実行環境</a>
  <a href="#sango.system.runtime.2">終了</a>
  <a href="#sango.system.runtime.3">その他</a>
<a href="#sango.tuple"><code>sango.tuple</code></a>
  <a href="#sango.tuple.1">要素取得</a>
<a href="#sango.util.array"><code>sango.util.array</code></a> 【Alpha】
  <a href="#sango.util.array.1">フレームワーク</a>
  <a href="#sango.util.array.2">実装者向け情報</a>
<a href="#sango.util.avltree"><code>sango.util.avltree</code></a> 【Deprecated】
<a href="#sango.util.avltree.array"><code>sango.util.avltree.array</code></a> 【Alpha】
<a href="#sango.util.avltree.bag"><code>sango.util.avltree.bag</code></a>
<a href="#sango.util.avltree.map"><code>sango.util.avltree.map</code></a>
<a href="#sango.util.avltree.queue"><code>sango.util.avltree.queue</code></a>
<a href="#sango.util.avltree.ralist"><code>sango.util.avltree.ralist</code></a>
<a href="#sango.util.avltree.set"><code>sango.util.avltree.set</code></a>
<a href="#sango.util.bag"><code>sango.util.bag</code></a>
  <a href="#sango.util.bag.1">フレームワーク</a>
  <a href="#sango.util.bag.2">実装者向け情報</a>
<a href="#sango.util.bag.simplebag"><code>sango.util.bag.simplebag</code></a>
<a href="#sango.util.datetime"><code>sango.util.datetime</code></a>
  <a href="#sango.util.datetime.1">生成・変換</a>
  <a href="#sango.util.datetime.2">判定</a>
  <a href="#sango.util.datetime.3">比較</a>
  <a href="#sango.util.datetime.4">現在時刻取得</a>
<a href="#sango.util.enum"><code>sango.util.enum</code></a> 【Alpha】
  <a href="#sango.util.enum.1">フレームワーク</a>
  <a href="#sango.util.enum.2">実装者向け情報</a>
<a href="#sango.util.iter"><code>sango.util.iter</code></a>
  <a href="#sango.util.iter.1">定数の供給</a>
  <a href="#sango.util.iter.2">変形</a>
<a href="#sango.util.locale"><code>sango.util.locale</code></a> 【Alpha】
  <a href="#sango.util.locale.1">生成</a>
  <a href="#sango.util.locale.2">デフォルト値</a>
<a href="#sango.util.map"><code>sango.util.map</code></a>
  <a href="#sango.util.map.1">フレームワーク</a>
  <a href="#sango.util.map.2">実装者向け情報</a>
<a href="#sango.util.map.hashmap"><code>sango.util.map.hashmap</code></a>
<a href="#sango.util.map.simplemap"><code>sango.util.map.simplemap</code></a>
<a href="#sango.util.map.weakkeymap"><code>sango.util.map.weakkeymap</code></a> 【Alpha】
<a href="#sango.util.map.weakvaluemap"><code>sango.util.map.weakvaluemap</code></a> 【Alpha】
<a href="#sango.util.prop"><code>sango.util.prop</code></a> 【Alpha】
<a href="#sango.util.queue"><code>sango.util.queue</code></a>
  <a href="#sango.util.queue.1">フレームワーク</a>
  <a href="#sango.util.queue.2">実装者向け情報</a>
<a href="#sango.util.queue.simplequeue"><code>sango.util.queue.simplequeue</code></a>
<a href="#sango.util.random"><code>sango.util.random</code></a>
<a href="#sango.util.ralist"><code>sango.util.ralist</code></a>
  <a href="#sango.util.ralist.1">フレームワーク</a>
  <a href="#sango.util.ralist.2">実装者向け情報</a>
<a href="#sango.util.set"><code>sango.util.set</code></a>
  <a href="#sango.util.set.1">フレームワーク</a>
  <a href="#sango.util.set.2">実装者向け情報</a>
<a href="#sango.util.set.hashset"><code>sango.util.set.hashset</code></a>
<a href="#sango.util.set.simpleset"><code>sango.util.set.simpleset</code></a>
<a href="#sango.util.set.weakset"><code>sango.util.set.weakset</code></a> 【Alpha】
<a href="#sango.util.shell"><code>sango.util.shell</code></a> 【Alpha】
  <a href="#sango.util.shell.1">プログラム実行環境取得</a>
  <a href="#sango.util.shell.2">ディレクトリとファイルの操作</a>
  <a href="#sango.util.shell.3">パスの操作</a>
  <a href="#sango.util.shell.4">バイトストリーム</a>
  <a href="#sango.util.shell.5">文字ストリーム</a>
  <a href="#sango.util.shell.6">行入力ストリーム</a>
  <a href="#sango.util.shell.7">プリントストリーム</a>
  <a href="#sango.util.shell.8">標準入出力</a>
  <a href="#sango.util.shell.9">システムプロパティ</a>
  <a href="#sango.util.shell.10">サブプロセス起動</a>
<a href="#sango.util.sort"><code>sango.util.sort</code></a>
<a href="#sango.util.stack"><code>sango.util.stack</code></a>
  <a href="#sango.util.stack.1">フレームワーク</a>
  <a href="#sango.util.stack.2">実装者向け情報</a>
<a href="#sango.util.stack.liststack"><code>sango.util.stack.liststack</code></a>
</div>

<hr/>

<h1 id="sango.lang"><code>sango.lang</code></h1>
<p>Sangoの基本的な定義を提供します。
  このモジュールに限り，インポートは不要です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.1"><code>sango.lang</code> - 型と定数</h2>
<p>基本的な型，多用される型，および関連する定数を示します。
  定数は関数の返り値として提供されます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;_?_&gt; @opaque ;;</code></td></tr></table>
<p>プログラム文脈から離れているため，型が不明になっていることを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;_&gt; @opaque ;;</code></td></tr></table>
<p>Sangoの全ての型の基底である型を表します（すべての型はこの型を拡張した型とみなします）。
  この型のオブジェクトは存在しません。
  この型の特別な意味として，関数の結果型に用いられた場合に，その関数から制御が戻らないことを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;void&gt; @public := void$ ;;</code></td></tr></table>
<p>関数から返すべき値が無いことを表す便宜的な型です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;_0&gt; @public := _0$ ;;
data &lt;*A _1&gt; @public := _1$ ;;
data &lt;*A *B _2&gt; @public := _2$ ;;
data &lt;*A *B *C _3&gt; @public := _3$ ;;
data &lt;*A *B *C *D _4&gt; @public := _4$ ;;
data &lt;*A *B *C *D *E _5&gt; @public := _5$ ;;</code></td></tr></table>
<p>n個の型パラメタを持つ型を表したいとき，拡張して使用します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;bool&gt; @public := true$ | false$ ;;</code></td></tr></table>
<p>論理的な「真」と「偽」を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;byte&gt; @opaque ;;</code></td></tr></table>
<p>バイト（0～255）を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;int&gt; @opaque ;;</code></td></tr></table>
<p>-21474836487（-2<sup>31</sup>）～ 0 ～+2147483647（+2<sup>31</sup>-1）の整数を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;real&gt; @opaque ;;</code></td></tr></table>
<p>実数（IEEE754の64ビット浮動小数点数）を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;char&gt; @opaque ;;</code></td></tr></table>
<p>文字を表します。
  内部表現はUnicodeです。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;+*A list&gt; @opaque ;;</code></td></tr></table>
<p>リストを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;+*A string&gt; @opaque ;;</code></td></tr></table>
<p>ストリングを表します。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;bstr&gt; @public := &lt;byte string&gt; ;;</code></td></tr></table>
<p>バイトのストリングの別名です。
  入出力などで使用されます。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;cstr&gt; @public := &lt;char string&gt; ;;</code></td></tr></table>
<p>文字のストリングの別名で，文字列のことです。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;independent&gt; @public := &lt;_?_&gt; exposed$ ;;</code></td></tr></table>
<p>文脈から独立している型を表します。
  必要に応じて拡張して使用します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A seal_fs&gt; @public :=
  seal_f: &lt;A independent+ fun&gt;
  unseal_f: &lt;independent+ &lt;A maybe&gt; fun&gt;
  seal_fs$ ;;</code></td></tr></table>
<p>オブジェクトを<code>&lt;independent+&gt;</code>に変換する関数，その逆の関数を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;+*A maybe&gt; @public := &lt;A&gt; value$ | none$ ;;</code></td></tr></table>
<p><code>&lt;A&gt;</code>の値がある場合と無い場合を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A iter&gt; @public := next_f: &lt;&lt;A iter_res&gt; fun&gt; iter$ ;;</code></td></tr></table>
<p>イテレータ（データを次々と供給するオブジェクト）を表します。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;*A iter_res&gt; @public := &lt;&lt;A &lt;A iter&gt; tuple&gt; maybe&gt; ;;
</code></td></tr></table>
<p>イテレータの実行結果を表します。
  値の供給は，値とイテレータのタプルを返すことによって行われます。
  返されたイテレータを使用して，次の供給を要求します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A dummy&gt; @public :=
| &lt;A&gt; dummy_obj$
| &lt;A void fun&gt; dummy_fun$ ;;</code></td></tr></table></code></td></tr></table>
<p>【Beta】型情報を渡すためのダミーのオブジェクトを表します。
  Sangoの関数呼び出しにはオブジェクトを渡しますが，具象型を要求するコンテナオブジェクトの生成時など，型情報だけが必要なことがあります。
  そのような場合にこの型を使用します。</p>
<p><code>dummy_fun$</code>の場合，<code>T</code>を渡したい型として，<code>ignore</code>を使用して次のように書くことができます。</p>
<blockquote class="code-sample"><code>&amp;\\ &lt;T dummy&gt; { ^ignore dummy_fun$ }</code></blockquote>

<table border width="100%"><tr><td class="def"><code>eval max_byte @public -&gt; &lt;byte&gt; ;;</code></td></tr></table></code></td></tr></table>
<p>バイトの最大値（255）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval min_int @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>整数の最小値（-2147483648）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval max_int @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>整数の最大値（2147483647）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval nan @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>非数（NaN）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval pos_inf @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>正の無限大を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval neg_inf @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>負の無限大を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval otherwise @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>常に真を返します。
  慣習として，条件分岐の「その他の場合」に使います。</p>

<p>型にはこれらの他に，タプルを表す<code>&lt;～ tuple&gt;</code>と関数を表す<code>&lt;～ fun&gt;</code>があります。
  型パラメタの数は可変です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.2"><code>sango.lang</code> - 例外</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;exception&gt; @protected :=
  desc: &lt;exc_desc+&gt; msg: &lt;cstr&gt; info: &lt;exc_info&gt; org: &lt;exception maybe&gt;
  exception$ ;;</code></td></tr></table>
<p>例外オブジェクトを表します。
  <code>desc</code>は例外理由，<code>msg</code>は補足メッセージ，<code>info</code>は例外発生状況です。
  捕捉した例外を別の例外に変換して再送出する場合，元になった例外オブジェクトを保持することできます。
  その場合に，<code>org</code>は元になったオブジェクトを示します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;exc_desc&gt; @public :=
| assertion_error$ | intentional$ | unsupported$ | security_error$
| bad_arg$ | bad_status$ | &lt;runtime_failure+&gt; runtime_failure$
| &lt;arith_failure+&gt; arith_failure$ | sys_error$ | &lt;exc_desc+&gt; thru$ ;;</code></td></tr></table>
<p>例外理由を表します。
  データ構築子名が理由を示しています。独自の例外理由を定義する場合には，この定義を拡張します。</p>
<p><code>intentional$</code>は，プログラマが何らかの理由で処理を中断させるときに使用できます。
  <code>sys_error$</code>は，Sangoランタイムの内部エラーを示します。
  <code>thru$</code>は，アクタを速やかに終了すべき例外を示し，<code>try</code>で捕捉されません。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;runtime_failure&gt; @public := incompat$ | no_case$ | no_elem$ ;;</code></td></tr></table>
<p>Sangoランタイムが検出した例外を表します。
  それぞれ，パターンマッチの失敗，条件分岐の全てのガードの失敗，該当する要素（オブジェクト）の取得の失敗を示します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;arith_failure&gt; @public := zero_div$ | overflow$ | underflow$ | arith_error$ ;;</code></td></tr></table>
<p>算術エラーを表します。
  それぞれ，ゼロによる除算，オーバーフロー，アンダーフロー，その他の算術エラーを示します。
  <code>&quot;sango.lang&quot;</code>に定義されている<code>&lt;real&gt;</code>の計算では例外は発生せず，結果が無限大や非数（NaN）になります。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;exc_info&gt; @opaque ;;</code></td></tr></table>
<p>例外の発生状況を表します。
  このオブジェクトから情報を得る関数が<code>&quot;sango.debug&quot;</code>から提供されています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;+*A result&gt; @public := fin: &lt;A&gt; fin$ | &lt;exception&gt; exc$ ;;</code></td></tr></table>
<p>関数の実行結果として，正常終了して結果が返された場合か，例外が発生した場合を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exc_desc+&gt; *Desc &lt;cstr&gt; *Msg &lt;exception maybe&gt; *Original_exc_
  new_exception @public -&gt; &lt;exception&gt; ;;</code></td></tr></table>
<p>例外オブジェクトを生成します。
  既存の例外オブジェクトを保持する場合は<code>Original_exc_</code>に指定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exc_desc+&gt; *Desc &lt;cstr&gt; *Msg
  new_original_exception | new_exception @public -&gt; &lt;exception&gt; ;;</code></td></tr></table>
<p>新たな例外発生を示す例外オブジェクトを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exc_desc+&gt; *Desc &lt;cstr&gt; *Msg &lt;exception&gt; *Original_exc
  new_chained_exception | new_exception @public -&gt; &lt;exception&gt; ;;</code></td></tr></table>
<p>既存例外オブジェクトを保持した例外オブジェクトを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exception&gt; *E renew_exception @public -&gt; &lt;exception&gt; ;;</code></td></tr></table>
<p>例外を再作成します。元の例外が既存例外オブジェクトとして保持されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exception&gt; *E throw @public -&gt; &lt;_&gt; ;;</code></td></tr></table>
<p>例外を送出します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exception&gt; *E renew_and_throw @public -&gt; &lt;_&gt; ;;</code></td></tr></table>
<p>例外を再作成して送出します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A fun&gt; *F try @public -&gt; &lt;A result&gt; ;;</code></td></tr></table>
<p>クロージャを実行し，結果（正常終了あるいは例外発生）を受け取ります。
  <code>thru$</code>例外は捕捉されません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A fun&gt; *F catch_all_try @public -&gt; &lt;A result&gt; ;;</code></td></tr></table>
<p>クロージャを実行し，結果（正常終了あるいは例外発生）を受け取ります。
  <code>thru$</code>例外を含め，全ての例外が捕捉されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exception&gt; *E thru @public -&gt; &lt;exception&gt; ;;</code></td></tr></table>
<p><code>thru$</code>例外に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exception&gt; *E catchable @public -&gt; &lt;exception&gt; ;;</code></td></tr></table>
<p><code>thru$</code>例外を<code>try</code>で捕捉される例外に変換します。</p>


<table border width="100%"><tr><td class="def"><code>eval &lt;*A result&gt; *R unwrap @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p><code>&lt;A result&gt;</code>オブジェクトから返り値を取り出します。
  例外の場合は，例外を再作成して送出します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.3"><code>sango.lang</code> - オブジェクトの等価判定</h2>

<p>オブジェクト間でパターンマッチが成功することを，「hardに等しい」と呼びます。
  そうでない場合，例えば，データの一部のみをキーとして等価判定をすることもあります。
  この場合は「softに等しい」と呼びます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X0 &lt;A&gt; *X1 hard_eq? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>オブジェクトが「hardに等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X0 &lt;A&gt; *X1 hard_ne? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>オブジェクトが「hardに等しいわけではない」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A eq_fs&gt; @public :=
  eq?_f: &lt;A A bool fun&gt;
  ne?_f_: &lt;&lt;A A bool fun&gt; maybe&gt;
  hash_f: &lt;A int fun&gt;
  eq_fs$ ;;</code></td></tr></table>
<p>等価判定の機能群を表します。
  「hardに等しい」か「softに等しい」かによらず，抽象的な等価判定に使います。
  <code>hash_f</code>には，この等価判定の一環として使用するハッシュ関数を指定します。
  ハッシュ関数が返す値（ハッシュ値）の制約条件については，関数<code>hash</code>の説明を参照してください。</p>

<table border width="100%"><tr><td class="def"><code>eval hard_eq_fs @public -&gt; &lt;*A eq_fs&gt; ;;</code></td></tr></table>
<p>「hardに等しい」判定の機能群を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval byte_eq_fs @public -&gt; &lt;byte eq_fs&gt; ;;
eval int_eq_fs @public -&gt; &lt;int eq_fs&gt; ;;
eval real_eq_fs @public -&gt; &lt;real eq_fs&gt; ;;
eval char_eq_fs @public -&gt; &lt;char eq_fs&gt; ;;</code></td></tr></table>
<p>それぞれ，バイト，整数，実数，文字に対する等価判定の機能群を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A eq_fs&gt; *Funs eq_fs_ne?_f | ne?_f @public -&gt; &lt;A A bool fun&gt; ;;</code></td></tr></table>
<p><code>&lt;A eq_fs&gt;</code>の中から「等しくない」かどうか判定する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A eq_fs&gt; *Funs eqcmp_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A eq_fs&gt; *Funs eqcmp_ne? | ne? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;A eq_fs&gt;</code>を使用して，それぞれ，「等しい」「等しくない」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X hash @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>ハッシュ値を返します。
  ハッシュ値は，主にコレクションの中から等価なオブジェクトを探索するために使われます。
  「XとYが等価ならばXのハッシュ値とYのハッシュ値が等しい」「Xのハッシュ値とYのハッシュ値が異なればXとYは等価ではない」（＝先の命題の待遇）が成り立ちます。
  被構築データのハッシュ値はランタイムエンジンの内部アルゴリズムにより算出しますが，使用者が定義した型は算出アルゴリズムを変更することができます。
  そのためには，データ定義しているモジュールの中で上記制約条件を満たすように「<code>eval &lt;t&gt; *X _hash_T -&gt; &lt;int&gt;</code>」（<code>&lt;t&gt;</code>は型定義のシグネチャ，<code>T</code>は型構築子）という関数を定義します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.4"><code>sango.lang</code> - 論理演算</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *B not @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>否定を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *B0 &lt;bool&gt; *B1 and @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>論理積を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *B0 &lt;bool fun&gt; *B1f lazy_and | and @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>論理積を求めます。
  <code>B1f</code>は<code>B0</code>が真の場合にのみ評価されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *B0 &lt;bool&gt; *B1 or @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>論理和を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *B0 &lt;bool fun&gt; *B1f lazy_or | or @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>論理和を求めます。
  <code>B1f</code>は<code>B0</code>が偽の場合にのみ評価されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *B0 &lt;bool&gt; *B1 xor @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>排他的論理和を求めます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.5"><code>sango.lang</code> - 算術演算</h2>

<p>算術演算は，整数型と実数型にそれぞれ関数が提供されています。型の変換はプログラマが行います。</p>
<p>整数の演算では，0で除算すると<code>(zero_div$ arith_failure$)</code>例外，結果が整数の範囲を超えると<code>(overflow$ arith_failure$)</code>例外が発生します。
  実数の演算では，これらの場合に例外は発生せず，その場合の結果は無限大や非数（NaN）になります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_sum | sum @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_sum | sum @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>和を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_diff | diff @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_diff | diff @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>差を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_prod | prod @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_prod | prod @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>積を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *i0 &lt;int&gt; *I1 int_quot | quot @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_quot | quot @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>商を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_div | div @public -&gt; &lt;int int tuple&gt; ;;</code></td></tr></table>
<p>商と剰余を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_neg | neg @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R real_neg | neg @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>符号を反転します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_inc | inc | succ @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>整数を1だけ増加させます（後者（successor）を求めます）。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_dec | dec | pred @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>整数を1だけ減少させます（前者（predecessor）を求めます）。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.6"><code>sango.lang</code> - ビット演算</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B byte_bit_not | bit_not @public -&gt; &lt;byte&gt; ;;
eval &lt;int&gt; *I int_bit_not | bit_not @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>ビット単位に論理否定を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_bit_and | bit_and @public -&gt; &lt;byte&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_bit_and | bit_and @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>ビット単位に論理積を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_bit_or | bit_or @public -&gt; &lt;byte&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_bit_or | bit_or @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>ビット単位に論理和を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_bit_xor | bit_xor @public -&gt; &lt;byte&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_bit_xor | bit_xor @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>ビット単位に排他的論理和を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B &lt;int&gt; *Count byte_shift_right | shift_right @public -&gt; &lt;byte&gt; ;;
eval &lt;int&gt; *I &lt;int&gt; *Count int_shift_right | shift_right @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p><code>Count</code>のビット数だけ右シフトします。
  最上位ビットは0になります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I &lt;int&gt; *Count
int_shift_right_keep_sign | shift_right_keep_sign @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p><code>Count</code>のビット数だけ右シフトします。
  最上位ビットは保持されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I &lt;int&gt; *Count int_shift_left | shift_left @public -&gt; &lt;int&gt; ;;
eval &lt;byte&gt; *B &lt;int&gt; *Count byte_shift_left | shift_left @public -&gt; &lt;byte&gt; ;;</code></td></tr></table>
<p><code>Count</code>のビット数だけ左シフトします。
  最下位ビットは0になります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.7"><code>sango.lang</code> - 大小判定（順序付け）</h2>
<p>数値の大小，文字の順序を判定します。文字の順序は，Unicodeの大小にて判定されます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;ordering&gt; @public := lt$ | eq$ | gt$ ;;</code></td></tr></table>
<p>より小さい（より前），等しい，より大きい（より後）を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A ord_fs&gt; @public :=
  compare_f: &lt;A A ordering fun&gt;
  eq?_f_: &lt;&lt;A A bool fun&gt; maybe&gt;
  lt?_f_: &lt;&lt;A A bool fun&gt; maybe&gt;
  le?_f_: &lt;&lt;A A bool fun&gt; maybe&gt;
  gt?_f_: &lt;&lt;A A bool fun&gt; maybe&gt;
  ge?_f_: &lt;&lt;A A bool fun&gt; maybe&gt;
  hash_f: &lt;A int fun&gt;
  ord_fs$ ;;</code></td></tr></table>
<p>大小判定するための機能群を表します。
  実装する場合は，最小限，<code>compare_f</code>を実装する必要があります。
  <code>hash_f</code>には，この等価判定と整合するハッシュ関数を指定します。
  ハッシュ関数が返す値（ハッシュ値）の制約条件については，関数<code>hash</code>の説明を参照してください。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ord_fs&gt; *Ord ord_fs_inverse | inverse @public -&gt; &lt;A ord_fs&gt; ;;</code></td></tr></table>
<p><code>Ord</code>から，大小判定を逆に行う機能群を作成します。</p>

<table border width="100%"><tr><td class="def"><code>eval byte_ord_fs @public -&gt; &lt;byte ord_fs&gt; ;;
eval int_ord_fs @public -&gt; &lt;int ord_fs&gt; ;;
eval real_ord_fs @public -&gt; &lt;real ord_fs&gt; ;;
eval char_ord_fs @public -&gt; &lt;char ord_fs&gt; ;;</code></td></tr></table>
<p>それぞれ，バイト，整数，実数，文字に対する大小判定機能群を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;ordering&gt; *O ordering_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;ordering&gt; *O ordering_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;ordering&gt; *O ordering_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;ordering&gt; *O ordering_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;ordering&gt; *O ordering_ge? | ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;ordering&gt;</code>が，それぞれ，「等しい」「より小さい」「より小さいか等しい」「より大きい」「より大きいか等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A ord_fs&gt; *Funs
  ordcmp_compare | compare @public -&gt; &lt;ordering&gt; ;;</code></td></tr></table>
<p><code>&lt;A ord_fs&gt;</code>を使用して，<code>X0</code>の<code>X1</code>に対する大小を比較します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A ord_fs&gt; *Funs ordcmp_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A ord_fs&gt; *Funs ordcmp_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A ord_fs&gt; *Funs ordcmp_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A ord_fs&gt; *Funs ordcmp_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A&gt; *X0 &lt;A&gt; *X1 &lt;A ord_fs&gt; *Funs ordcmp_ge? | ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;A ord_fs&gt;</code>を使用して，<code>X0</code>の<code>X1</code>に対する大小が，それぞれ，「等しい」「より小さい」「より小さいか等しい」「より大きい」「より大きいか等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ord_fs&gt; *Funs ord_fs_eq?_f | eq?_f @public -&gt; &lt;A A bool fun&gt; ;;
eval &lt;*A ord_fs&gt; *Funs ord_fs_lt?_f | lt?_f @public -&gt; &lt;A A bool fun&gt; ;;
eval &lt;*A ord_fs&gt; *Funs ord_fs_le?_f | le?_f @public -&gt; &lt;A A bool fun&gt; ;;
eval &lt;*A ord_fs&gt; *Funs ord_fs_gt?_f | gt?_f @public -&gt; &lt;A A bool fun&gt; ;;
eval &lt;*A ord_fs&gt; *Funs ord_fs_ge?_f | ge?_f @public -&gt; &lt;A A bool fun&gt; ;;</code></td></tr></table>
<p><code>&lt;A ord_fs&gt;</code>の中から，それぞれ，「等しい」「より小さい」「より小さいか等しい」「より大きい」「より大きいか等しい」かどうか判定する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;char&gt; *C0 &lt;char&gt; *C1 char_compare | compare @public -&gt; &lt;ordering&gt; ;;</code></td></tr></table>
<p>第1パラメタの第2パラメタに対する大小を判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;char&gt; *C0 &lt;char&gt; *C1 char_eq? | eq? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>第1パラメタが第2パラメタ対して等しいかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;char&gt; *C0 &lt;char&gt; *C1 char_lt? | lt? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>第1パラメタが第2パラメタに対してより小さいかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;char&gt; *C0 &lt;char&gt; *C1 char_le? | le? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>第1パラメタが第2パラメタに対して「より小さいあるいは等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;char&gt; *C0 &lt;char&gt; *C1 char_gt? | gt? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>第1パラメタが第2パラメタに対してより大きいかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B0 &lt;byte&gt; *B1 byte_ge? | ge? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 int_ge? | ge? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_ge? | ge? @public -&gt; &lt;bool&gt; ;;
eval &lt;char&gt; *C0 &lt;char&gt; *C1 char_ge? | ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>第1パラメタが第2パラメタに対して「より大きいあるいは等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B byte_zero? | zero? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I int_zero? | zero? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R real_zero? | zero? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>0に等しいかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_lt0? | lt0? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R real_lt0? | lt0? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>0より小さい（負である）かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_le0? | le0? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R real_le0? | le0? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>「0であるあるいは0より小さい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B byte_gt0? | gt0? @public -&gt; &lt;bool&gt; ;;
eval &lt;int&gt; *I int_gt0? | gt0? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R real_gt0? | gt0? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>0より大きい（正である）かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_ge0? | ge0? @public -&gt; &lt;bool&gt; ;;
eval &lt;real&gt; *R real_ge0? | ge0? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>「0であるあるいは0より大きい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R nan? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>非数（NaN）かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R infinite? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>正あるいは負の無限大かどうか判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.8"><code>sango.lang</code> - 型変換など</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte&gt; *B byte_to_int | to_int | int @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>バイトを整数に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_to_byte | to_byte | byte @public -&gt; &lt;byte&gt; ;;</code></td></tr></table>
<p>整数をバイトに変換します。バイトの範囲外の場合は<code>bad_arg$</code>例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_byte_part | byte_part @public -&gt; &lt;byte&gt; ;;</code></td></tr></table>
<p>整数の下位8ビットをバイトに変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_to_real | to_real | real @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>整数を実数に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C char_code | code @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>文字のUnicodeを取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I char_value @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p>Unicodeに対する文字を取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_byte_range? | byte_range? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>整数がバイトの範囲内にあるかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R
  real_to_int | to_int | int @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>実数を整数に変換します。
  小数点以下は切り捨てられます。
  非数，無限大，あるいは変換後に整数の範囲に入らない場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R
  real_int_convertible? | int_convertible? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>実数が整数に変換できるか判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.9"><code>sango.lang</code> - その他</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X itself | id @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p><code>X</code>をそのまま返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X ignore @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>常に<code>void$</code>を返します。
  関数の返り値を明示的に無視する場合に，この関数に渡します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X to_fun @public -&gt; &lt;A fun&gt; ;;</code></td></tr></table>
<p><code>X</code>を返すクロージャを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A fun&gt; *F eval @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>パラメタ無しのクロージャFを実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A maybe&gt; *X_ value @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p><code>X_</code>から値を取り出します。
  <code>none$</code>の場合は，例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A maybe&gt; *X_ something? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A maybe&gt; *X_ nothing? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>それぞれ，<code>X_</code>が値を持っているか，値を持っていないかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A maybe&gt; *X_ &lt;A *B fun&gt; *F
  apply_to_something | ats @public -&gt; &lt;B maybe&gt; ;;</code></td></tr></table>
<p><code>X_</code>が値をもっている場合にFを適用させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *I iter_next | next @public -&gt; &lt;A iter_res&gt; ;;</code></td></tr></table>
<p>イテレータから値を供給します。
  供給する値が無い場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X expose @public -&gt; &lt;_?_&gt; ;;</code></td></tr></table>
<p>型を文脈から引き離します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.actor"><code>sango.actor</code></h1>

<p>マルチアクタプログラミングの基本機能を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.1"><code>sango.actor</code> - アクタ</h2>

<table border width="100%"><tr><td class="def"><code>extend &lt;exc_desc&gt; @public :=
| exit$ ;;</code></td></tr></table>
<p><code>exit$</code>は，速やかに正常終了することを意味し，通常は<code>thru$</code>例外として使用されます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;actor_h&gt; @opaque ;;</code></td></tr></table>
<p>アクタに対するハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A async_h&gt; @opaque ;;</code></td></tr></table>
<p>別アクタで実行されているタスクに対するハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A async_result_h&gt; @opaque ;;</code></td></tr></table>
<p>別アクタで実行されているタスクの結果を受け取るためのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;wait&gt; @public := wait_forever$ | &lt;int&gt; wait_ms$ ;;</code></td></tr></table>
<p>待ち合わせのタイムアウトを表します。
  <code>wait_ms$</code>にはミリ秒を単位とした時間を指定します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;actor_state&gt; @public :=
  run: &lt;run_state&gt;
  prio: &lt;int&gt;
  bg: &lt;bool&gt;
  actor_state$ ;;</code></td></tr></table>
<p>アクタ状態を表します。
  <code>run</code>は実行状態を，<code>prio</code>は優先度を，<code>bg</code>はバックグラウンドか否かを示します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;run_state&gt; @public :=
| actor_born$
| actor_started$
| &lt;exception maybe&gt; actor_ended$ ;;</code></td></tr></table>
<p>アクタの実行状態を表します。
  <code>actor_born$</code>は生成直後で開始前であることを，<code>actor_started$</code>は実行中であることを，<code>actor_ended$</code>は終了したことを示します。</p>

<table border width="100%"><tr><td class="def"><code>eval yield @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>一時休止し他のアクタの実行を優先させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A fun&gt; *F spawn_actor | spawn @public -&gt; &lt;A async_h&gt; ;;</code></td></tr></table>
<p>アクタを生成します。
  生成されたアクタは開始待ち状態となります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *Actor background_actor? | background? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>アクタがバックグラウンド状態かを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *Actor &lt;bool&gt; *Bg
  actor_run_background | run_background @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>アクタをバックグラウンド状態，あるいはフォアグラウンド状態に移行します。</p>

<table border width="100%"><tr><td class="def"><code>eval my_actor_h @public -&gt; &lt;actor_h&gt; ;;</code></td></tr></table>
<p>自己の<code>&lt;actor_h&gt;</code>を取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A async_h&gt; *Async actor_h @public -&gt; &lt;actor_h&gt; ;;</code></td></tr></table>
<p><code>&lt;actor_h&gt;</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A async_h&gt; *Async async_result_h @public -&gt; &lt;A async_result_h&gt; ;;</code></td></tr></table>
<p><code>&lt;A async_result_h&gt;</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A async_h&gt; *Async start_async | start @public -&gt; &lt;void&gt; ;;
eval &lt;actor_h&gt; *Actor start_actor | start @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>アクタを開始します。
  すでに開始した，あるいは終了したアクタに対しては影響を及ぼしません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *Actor &lt;wait&gt; *Wait wait_actor_ended | join @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>アクタの終了を待ちます。
  <code>Wait</code>にタイムアウト時間を指定することができます。
  タイムアウト前にアクタが終了した場合に<code>true$</code>が，タイムアウトが発生した場合に<code>false$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h list&gt; *Actors &lt;wait&gt; *Wait
  wait_some_actors_ended | join @public -&gt; &lt;actor_h list&gt; ;;</code></td></tr></table>
<p>一つ以上のアクタの終了を待ち，終了したアクタの<code>&lt;actor_h&gt;</code>を返します。
  <code>Wait</code>にタイムアウト時間を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A async_h&gt; *Async
  async_peek_result | peek @public -&gt; &lt;&lt;A result&gt; maybe&gt; ;;
eval &lt;*A async_result_h&gt; *Result
  async_result_peek | peek @public -&gt; &lt;&lt;A result&gt; maybe&gt; ;;</code></td></tr></table>
<p>アクタの結果を取得します。
  アクタが終了していない場合は，<code>none$</code>が返ります。
  関数はブロックされず，即時に結果を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A async_h&gt; *Async sync @public -&gt; &lt;A result&gt; ;;</code></td></tr></table>
<p>アクタの終了を待ち，結果を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *Actor actor_state | state @public -&gt; &lt;actor_state&gt; ;;</code></td></tr></table>
<p>アクタの状態を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.2"><code>sango.actor</code> - メッセージ交換</h2>

<table border width="100%"><tr><td class="def"><code>extend &lt;independent&gt; -&gt; msg @public :=
| signal$
| no_post$
| &lt;sys_msg&gt; sys_msg$
| &lt;actor_h&gt; &lt;actor_state&gt; actor_state_changed$ ;;</code></td></tr></table>
<p>メッセージを表します。
  必要に応じて拡張して使用します。
  <code>signal$</code>は，空のメッセージです。
  <code>no_post$</code>はこれ以上のメッセージがポストされないことを示します。
  <code>sys_msg$</code>はシステムからのメッセージを示します。
  <code>actor_state_changed$</code>はアクタの状態変化を示します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;sys_msg&gt; @public :=
| shutdown$ ;;</code></td></tr></table>
<p><code>shutdown$</code>はプログラムの終了シーケンスが開始されたことの通知です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;mbox_h&gt; @opaque ;;</code></td></tr></table>
<p>メッセージボックスのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;post_h&gt; @opaque ;;</code></td></tr></table>
<p>メッセージボックスへのメッセージ送信のためのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;preserved_post_h&gt; @opaque ;;</code></td></tr></table>
<p><code>&lt;post_h&gt;</code>を弱く保持するためのデータを表します。
  メッセージボックスの受信アクタが<code>&lt;post_h&gt;</code>を保持すると<code>no_post$</code>メッセージがポストされません。
  受信アクタが<code>&lt;post_h&gt;</code>を使用する場合は，このデータを作成して保持しておき，必要になった時点で<code>&lt;post_h&gt;</code>を再度得ます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;mbox_opts&gt; @public :=
  notify_nopost: &lt;bool&gt;
  notify_sysmsg: &lt;bool&gt;
  mbox_opts$ ;;</code></td></tr></table>
<p>メッセージボックス作成のオプションを表します。
  <code>notify_nopost</code>には，<code>no_post$</code>がポストされることを指示します。
  <code>notify_sysmsg</code>には，<code>&lt;sys_msg&gt;</code>がポストされることを指示します。
  今後，属性が追加される可能性がありますので，<code>default_mbox_opts</code>で返される値を，必要に応じて変更して使うようにしてください。</p>

<table border width="100%"><tr><td class="def"><code>eval default_mbox_opts @public -&gt; &lt;mbox_opts&gt; ;;</code></td></tr></table>
<p><code>&lt;mbox_opts&gt;</code>のデフォルト値を返します。
  <code>notify_nopost</code>は<code>true$</code>，<code>notify_sysmsg</code>は<code>false$</code>です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;mbox_opts&gt; *Opts open_mbox @public -&gt; &lt;mbox_h post_h tuple&gt; ;;</code></td></tr></table>
<p>メッセージボックスをオープンします。</p>

<table border width="100%"><tr><td class="def"><code>eval open_mbox_with_default_opts | open_mbox @public
  -&gt; &lt;mbox_h post_h tuple&gt; ;;</code></td></tr></table>
<p>デフォルトの<code>&lt;mbox_opts&gt;</code>でメッセージボックスをオープンします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;post_h&gt; *P preserve_post_h_for_receiver @public -&gt; &lt;preserved_post_h&gt; ;;</code></td></tr></table>
<p><code>&lt;post_h&gt;</code>への参照を弱い状態にし必要になった時点で再取得するために，<code>&lt;preserved_post_h&gt;</code>に変換します。
  この処理後<code>&lt;post_h&gt;</code>が保持され続けないように注意してください。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;preserved_post_h&gt; *PP get_post_h @public -&gt; &lt;post_h maybe&gt; ;;</code></td></tr></table>
<p><code>&lt;post_h&gt;</code>を再取得します。
  対応する<code>&lt;post_h&gt;</code>オブジェクトが消滅している場合（どのアクタからも送信されないことが確実になっている場合）には，<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;post_h&gt; *P &lt;msg+&gt; *M mbox_send_msg | send_msg | send @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>メッセージを送信します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;mbox_h&gt; *B &lt;wait&gt; *Wait listen_mbox | listen @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>メッセージボックスにメッセージがポストされるのを待ちます。
  <code>Wait</code>にタイムアウト時間を指定することができます。 
  タイムアウト前にメッセージがポストされた場合に<code>true$</code>が，タイムアウトが発生した場合に<code>false$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;mbox_h list&gt; *Bs &lt;wait&gt; *Wait
  mbox_listen_multiple | listen_mboxes | listen @public -&gt; &lt;mbox_h list&gt; ;;</code></td></tr></table>
<p>一つ以上のメッセージボックスにメッセージがポストされているのを待ち，ポストされているメッセージボックスを返します。
  <code>Wait</code>にタイムアウト時間を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;mbox_h&gt; *B
  mbox_receive_msg | receive_msg | receive @public -&gt; &lt;msg+ maybe&gt; ;;</code></td></tr></table>
<p>メッセージボックスからメッセージを受信します。
  メッセージが無い場合は<code>none$</code>が返ります。
  関数はブロックされず，即時に結果を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.3"><code>sango.actor</code> - アクタの監視</h2>

<p>アクタの状態変化を<code>actor_state_changed$</code>メッセージで受け取ることができます。
  監視を開始するとまずその時点のアクタ状態が通知され，以降アクタ状態が変化するたびに通知が行われます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *A &lt;post_h&gt; *P start_monitoring @public -&gt; &lt;void&gt; ;;
eval &lt;actor_h&gt; *A &lt;post_h&gt; *P stop_monitoring @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>アクタに対して監視を開始／終了します。
  通知をポストするためのハンドルを<code>P</code>に指定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.4"><code>sango.actor</code> - アクタの優先度</h2>

<p>アクタは0から9の優先度をとります。
  0が最低，9が最高を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval highest_priority @public -&gt; &lt;int&gt; ;;
eval default_priority @public -&gt; &lt;int&gt; ;;
eval lowest_priority @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>それぞれ，9，4，0を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *Actor priority @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>アクタの優先度を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;actor_h&gt; *Actor &lt;int&gt; *Priority set_priority @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>アクタの優先度を設定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.actor.util"><code>sango.actor.util</code></h1>

<p>マルチアクタプログラミングのユーティリティ機能を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.util.1"><code>sango.actor</code> - アクタの初期化待ち</h2>

<p>例えばサーバとなるアクタを開始する場合，そのアクタに要求を送信する<code>&lt;post_h&gt;</code>は開始したアクタの中で生成されますが，起動側でそれを受け取りたいことがよくあります。
  この場合，<code>&lt;post_h&gt;</code>を内部的にやり取りするしくみがあると便利です。
  このように，アクタの初期化と同期する関数を提供しています。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;void fun&gt; void fun&gt; *F startup_actor @public -&gt; &lt;actor_h&gt; ;;</code></td></tr></table>
<p>アクタを開始し，その初期化を待ちます。
  開始されるアクタは，<code>&lt;void fun&gt;</code>をパラメタとして受け取る関数として定義し，初期化が完了した時点で，渡された関数を呼び出します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;post_h void fun&gt; void fun&gt; *F
  startup_svr @public -&gt; &lt;actor_h post_h tuple&gt; ;;</code></td></tr></table>
<p>アクタを開始し，その<code>&lt;actorh_h&gt;</code>と，要求受信用メッセージボックスの<code>&lt;post_h&gt;</code>を受け取ります。
  開始されるアクタは，<code>&lt;post_h void fun&gt;</code>を受け取る関数として定義し，要求受信用メッセージボックスの<code>&lt;post_h&gt;</code>をその関数に渡します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.util.2"><code>sango.actor.util</code> - serializer</h2>

<p>複数のタスクを一つずつ実行する（serialize）ための仕組みです。
  serializeする単位でserializerというアクタを起動し，serializerにタスクを依頼します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;serializer_h&gt; @opaque ;;</code></td></tr></table>
<p>serializerのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval start_serializer @public -&gt; &lt;serializer_h&gt; ;;</code></td></tr></table>
<p>serializerを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;serializer_h&gt; *S &lt;*A fun&gt; *F run_serialized @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>serializerにタスクを依頼し，結果を受け取ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;serializer_h&gt; *S &lt;*A fun&gt; *F run_serialized_async @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>serializerにタスクを依頼しますが，結果は受け取りません。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.actor.util.3"><code>sango.actor.util</code> - entity monitor</h2>

<p>「実体」（entity）の読み書き（<code>&quot;sango.entity&quot;</code>，<code>&quot;sango.entity.domain&quot;</code>あるいは<code>&quot;sango.entity.box&quot;</code>の<code>read</code>，<code>write</code>）は原子的に行われますが，読み出しと書き込みの間には他の処理が割り込むことがあります。
  「実体」に対する一連の処理に原子性を持たせるために，entity monitorが提供されています。
  「実体」単位にentity monitorを生成し，それ経由でタスクを実行します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;monitor_h&gt; @opaque ;;</code></td></tr></table>
<p><code>&lt;&quot;sango.entity&quot;.eref&gt;</code>に対するentity monitorのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! monitor2_h&gt; @opaque ;;</code></td></tr></table>
<p><code>&lt;A! &quot;sango.entity.domain&quot;.entity_h&gt;</code>に対するentity monitorのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! box_monitor_h&gt; @opaque ;;</code></td></tr></table>
<p><code>&lt;A! &quot;sango.entity.box&quot;.box_h&gt;</code>に対するentity monitorのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.entity&quot;.eref&gt; *E create_monitor @public -&gt; &lt;monitor_h&gt; ;;
eval &lt;*A! &quot;sango.entity.domain&quot;.entity_h&gt; *E create_monitor2 | create_monitor @public -&gt; &lt;A monitor2_h&gt; ;;
eval &lt;*A! &quot;sango.entity.box&quot;.box_h&gt; *Box create_box_monitor | create_monitor @public -&gt; &lt;A box_monitor_h&gt; ;;
</code></td></tr></table>
<p>entity monitorを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;monitor_h&gt; *M &lt;&quot;sango.entity&quot;.eref *A fun&gt; *F run_monitor | run @public -&gt; &lt;A&gt; ;;
eval &lt;*A! monitor2_h&gt; *M &lt;&quot;sango.entity.doinain&quot;.entity_h *B fun&gt; *F run_monitor2 | run @public -&gt; &lt;B&gt; ;;
eval &lt;*A! box_monitor_h&gt; *M &lt;&lt;A &quot;sango.entity.box&quot;.box_h&gt; *B fun&gt; *F run_box_monitor | run @public -&gt; &lt;B&gt; ;; </code></td></tr></table>
<p>タスク<code>F</code>を実行します。
  タスクは実体への参照を受け取り，処理を行い結果を返します。
  タスクから返された値が，この関数の結果となります。
  実体の値の更新が必要な場合は，タスクの中で行います。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.arith"><code>sango.arith</code></h1>
<p>算術演算のユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.arith.1"><code>sango.arith</code> - 和</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I0 &lt;int&gt; *I1 &lt;int&gt; *I2 int_sum_3 | sum @public -&gt; &lt;int&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 &lt;int&gt; *I2 &lt;int&gt; *I3 int_sum_4 | sum @public -&gt; &lt;int&gt; ;;
eval &lt;int&gt; *I0 &lt;int&gt; *I1 &lt;int&gt; *I2 &lt;int&gt; *I3 &lt;int&gt; *I4 int_sum_5 | sum @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 &lt;real&gt; *R2 real_sum_3 | sum @public -&gt; &lt;real&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 &lt;real&gt; *R2 &lt;real&gt; *R3 real_sum_4 | sum @public -&gt; &lt;real&gt; ;;
eval &lt;real&gt; *R0 &lt;real&gt; *R1 &lt;real&gt; *R2 &lt;real&gt; *R3 &lt;real&gt; *R4 real_sum_5 | sum @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>パラメタの和を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int list&gt; *Is int_sum_list | sum @public -&gt; &lt;int&gt; ;;
eval &lt;real list&gt; *Rs real_sum_list | sum @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>リストに含まれる数の和を求めます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.arith.2"><code>sango.arith</code> - 最大・最小</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte list&gt; *Bs byte_max | max @public -&gt; &lt;byte maybe&gt; ;;
eval &lt;int list&gt; *Is int_max | max @public -&gt; &lt;int maybe&gt; ;;
eval &lt;real list&gt; *Rs real_max | max @public -&gt; &lt;real maybe&gt; ;;</code></td></tr></table>
<p>最大値を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte list&gt; *Bs byte_min | min @public -&gt; &lt;byte maybe&gt; ;;
eval &lt;int list&gt; *Is int_min | min @public -&gt; &lt;int maybe&gt; ;;
eval &lt;real list&gt; *Rs real_min | min @public -&gt; &lt;real maybe&gt; ;;</code></td></tr></table>
<p>最小値を求めます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.arith.3"><code>sango.arith</code> - 各種関数</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I int_abs | abs @public -&gt; &lt;int&gt; ;;
eval &lt;real&gt; *R real_abs | abs @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>絶対値を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R real_floor | floor @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p><code>R</code>を超えない最大の整数を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R real_ceil | ceil @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p><code>R</code>を下回らない最小の整数を求めます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.arith.math"><code>sango.arith.math</code></h1>

<p>数学関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.arith.math.1"><code>sango.arith.math</code> - 型と定数</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;complex&gt; @public := re: &lt;real&gt; im: &lt;real&gt; complex$ ;;</code></td></tr></table>
<p>複素数を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval pi @public -&gt; &lt;real&gt; ;; </code></td></tr></table>
<p>円周率を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval e @public -&gt; &lt;real&gt; ;; </code></td></tr></table>
<p>ネイピア数（自然対数の底）を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.arith.math.2"><code>sango.arith.math</code> - 各種関数</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R0 &lt;real&gt; *R1 real_pow | pow @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p><code>R0</code>の<code>R1</code>乗を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R exp @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>eの<code>R</code>乗を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R log @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>自然対数の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R log10 @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>常用対数の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R sqrt @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>平方根を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R sin @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>正弦（sine）の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R cos @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>余弦（cosine）の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R tan @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>正接（tangent）の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R asin @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>正弦の逆関数（arc sine）の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R acos @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>余弦の逆関数（arc cosine）の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R atan @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>正接の逆関数（arc tangent）の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R complex @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p>実数を複素数に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z c_abs | abs @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>絶対値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z c_conj | conj @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p>共役の値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z c_neg | neg @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p><code>-1</code>を掛けた値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z0 &lt;complex&gt; *Z1 c_sum | sum @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p>和を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z0 &lt;complex&gt; *Z1 c_diff | diff @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p>差を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z0 &lt;complex&gt; *Z1 c_prod | prod @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p>積を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;complex&gt; *Z0 &lt;complex&gt; *Z1 c_quot | quot @public -&gt; &lt;complex&gt; ;;</code></td></tr></table>
<p>商を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.bool"><code>sango.bool</code></h1>

<p><code>&lt;bool&gt;</code>についてのユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.bool.1"><code>sango.bool</code> - 可変個入力</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool list&gt; *Bs list_and | and @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;bool&gt;</code>のリストに対して論理積を求めます。
  空リストに対しては<code>true$</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool list&gt; *Bs list_or | or @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;bool&gt;</code>のリストに対して論理和を求めます。
  空リストに対しては<code>false$</code>を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.bool.2"><code>sango.bool</code> - 遅延評価</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;bool fun&gt; list&gt; *BFs list_lazy_and | lazy_and @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;bool fun&gt;</code>のリストに対して論理積を求めます。
  先頭の関数から順に評価し，<code>false$</code>が出現したところで処理を打ち切り<code>false$</code>を返します。
  残りの関数は呼び出されません。
  空リストに対しては<code>true$</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;bool fun&gt; list&gt; *BFs list_lazy_or | lazy_or @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;bool fun&gt;</code>のリストに対して論理和を求めます。
  先頭の関数から順に評価し，<code>true$</code>が出現したところで処理を打ち切り<code>true$</code>を返します。
  残りの関数は呼び出されません。
  空リストに対しては<code>false$</code>を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.char"><code>sango.char</code></h1>

<p><code>&lt;char&gt;</code>についてのユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.char.1"><code>sango.char</code> - 判定</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C space? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>空白文字かどうか判定します。
  現在は，<code>'\t'</code>，<code>'\n'</code>，<code>'\r'</code>，<code>'`u20;'</code>を空白文字と判定しますが，将来，対象を拡大するかもしれません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C0 &lt;char&gt; *C1 eq_ignore_case? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>大文字か小文字かを区別せず，等価な文字かどうかを判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.char.2"><code>sango.char</code> - 変換</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C upper_case @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p><code>C</code>に対応する大文字があればそれを，なければ<code>C</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C lower_case @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p><code>C</code>に対応する小文字があればそれを，なければ<code>C</code>を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.char.encoding"><code>sango.char.encoding</code></h1>

<p>文字のエンコード／デコードを行います。
  このモジュールは暫定的実装であり，定義が大きく変更される可能性があります。</p>
<p>エンコード，デコードは，抽象化されたオブジェクト（エンコーダ，デコーダ）を通じて行います 。
  現在提供されているエンコーディングは，UTF-8，UTF-16，UTF-16BE，UTF-16LE，EUC-JP，Windows-31J（MS932，CP932）です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.char.encoding.1"><code>sango.char.encoding - エンコード</code></h2>

<p>文字をバイト列にエンコードします。</p>

<table border width="100%"><tr><td class="def"><code>eval default_encoding @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>オペレーティングシステムにおける，テキストファイルでのデフォルトのエンコーディング（以下，デフォルトエンコーディング）を返します。 </p>

<table border width="100%"><tr><td class="def"><code>data &lt;encoder_h&gt; @public :=
  encode_f: &lt;char bstr fun&gt;
  end_f: &lt;bstr fun&gt;
  encoder_h$ ;;</code></td></tr></table>
<p>エンコーダへのハンドルを表します。
  属性は実装関数で，使用者は意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Encoding start_encoder @public -&gt; &lt;encoder_h&gt; ;;</code></td></tr></table>
<p>エンコーダを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval start_default_encoder @public -&gt; &lt;encoder_h&gt; ;;</code></td></tr></table>
<p>デフォルトエンコーディングのエンコーダを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;encoder_h&gt; *E &lt;char&gt; *C
  encoder_encode | encode_char | encode @public -&gt; &lt;bstr&gt; ;;</code></td></tr></table>
<p>文字をエンコードし，変換されたバイト列を返します。
  どのタイミングでどこまでのバイトを返すかはエンコーダの実装に依存します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;encoder_h&gt; *E encoder_end | end_encode | end @public -&gt; &lt;bstr&gt; ;;</code></td></tr></table>
<p>これ以上エンコードする文字が無いことをエンコーダに通知し，エンコーダがステージングしていたバイト列を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.char.encoding.2"><code>sango.char.encoding - デコード</code></h2>

<p>バイト列から文字をデコードします。</p>

<table border width="100%"><tr><td class="def"><code>extend &lt;exc_desc&gt; @public := decode_failure$ ;;</code></td></tr></table>
<p>デコードでエラーが発生したことを表す例外です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;decode_error_action&gt; @public :=
| ignore_decode_error_input$
| recover_decoding$
| abort_decoding$ ;;</code></td></tr></table>
<p>デコードでエラーが発生したとき，デコーダが取るアクションを表します。
  <code>ignore_decode_error_input$</code>は入力を無視します。
  <code>recover_decoding$</code>は回復を試みます。
  <code>abort_decoding$</code>は例外を発生させます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;decode_props&gt; @public :=
  error_seq_action: &lt;decode_error_action&gt;
  mapping_error_action: &lt;decode_error_action&gt;
  replace_with: &lt;cstr&gt;
  decode_props$ ;;</code></td></tr></table>
<p>デコードの動作を表します。
  <code>replace_with</code>はマッピングに失敗した場合の代替文字列を示します。</p>

<table border width="100%"><tr><td class="def"><code>eval default_decode_props @public -&gt; &lt;decode_props&gt; ;;</code></td></tr></table>
<p><code>&lt;decode_props&gt;</code>のデフォルト値を返します。
  <code>error_seq_action</code>，<code>mapping_error_action</code>は<code>recover_decoding$</code>，<code>replace_with</code>は<code>&quot;`uFFFD;&quot;</code>です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;decoder_h&gt; @public :=
  decode_f: &lt;byte cstr fun&gt;
  end_f: &lt;cstr fun&gt;
  decoder_h$ ;;</code></td></tr></table>
<p>デコーダへのハンドルを表します。
  属性は実装関数で，使用者は意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Encoding &lt;decode_props&gt; *Ps
  start_decoder @public -&gt; &lt;decoder_h&gt; ;;</code></td></tr></table>
<p>デコーダを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;decode_props&gt; *Ps start_default_decoder @public -&gt; &lt;decoder_h&gt; ;;</code></td></tr></table>
<p>デフォルトエンコーディングのデコーダを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;decoder_h&gt; *D &lt;byte&gt; *B
  decoder_decode | decode_byte | decode @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>バイトをデコードし，変換された文字列を返します。
  どのタイミングでどこまでの文字を返すかはデコーダの実装に依存します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;decoder_h&gt; *D decoder_end | end_decode | end @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>これ以上デコードするバイトが無いことをデコーダに通知し，デコーダがステージングしていた文字列を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.cstr"><code>sango.cstr</code></h1>

<p>文字列についてのユーティリティ関数を提供します。文字列はストリングのため，ストリングの関数も適用可能です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.cstr.1"><code>sango.cstr</code> - 生成</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C char_to_string | string @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>一文字から成る文字列を生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char list&gt; *Cs
  char_list_to_string | to_string @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>文字リストを文字列に変換します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.cstr.2"><code>sango.cstr</code> - 要素処理</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>文字の個数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Pos char | elem @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p>指標<code>Pos</code>の文字を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Start &lt;int&gt; *Count slice @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>指標<code>Start</code>から<code>Count</code>個の文字を取り出します。
  文字の個数が不足する場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Count take @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>先頭から<code>Count</code>個の文字を取り出します。
  文字の個数が不足する場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Count drop @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>先頭から<code>Count</code>個の文字を取り除いた残りを返します。
  文字の個数が不足する場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 append @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>S0</code>の後に<code>S1</code>を連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Ss concat @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>文字列を順に連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Start &lt;int&gt; *Count chars | elems @public -&gt; &lt;char list&gt; ;;</code></td></tr></table>
<p>指標<code>Start</code>から<code>Count</code>個数の文字をリストとして返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S all_chars | all_elems @public -&gt; &lt;char list&gt; ;;</code></td></tr></table>
<p>全ての文字をリストとして返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *SS start_with_cstr? | start_with? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>S</code>が<code>SS</code>で開始しているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;char&gt; *C char_first_index | first_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p>文字<code>C</code>が最初に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;char&gt; *C &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  char_first_index_in_region | first_index_in_region @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>S</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲で，文字<code>C</code>が最初に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *SS cstr_first_index | first_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>S</code>の中で<code>SS</code>が最初に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *SS end_with_cstr? | end_with? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>S</code>が<code>SS</code>で終了しているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;char&gt; *C char_last_index | last_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p>文字<code>C</code>が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *SS cstr_last_index | last_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>S</code>の中で<code>SS</code>が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;char&gt; *C &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  char_last_index_in_region | last_index_in_region @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p>Sの指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲で，文字<code>C</code>が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;char&gt; *Sep split_by_char @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p>文字<code>Sep</code>で分割します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *Sep split_by_cstr @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p>部分文字列<code>Sep</code>で分割します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S split_by_space @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p>空白文字で分割します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Ss &lt;char&gt; *Sep join_with_char @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>Sep</code>をはさんで文字列を連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Ss &lt;cstr&gt; *Sep join_with_cstr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>Sep</code>をはさんで文字列を連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *Seq &lt;cstr&gt; *New replace_first_cstr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>S</code>に含まれる最初の<code>Seq</code>を<code>New</code>で置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *Seq &lt;cstr&gt; *New replace_last_cstr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>S</code>に含まれる最後の<code>Seq</code>を<code>New</code>で置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;cstr&gt; *Seq &lt;cstr&gt; *New replace_all_cstr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>S</code>に含まれる全ての<code>Seq</code>を<code>New</code>で置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 compare @public -&gt; &lt;ordering&gt; ;;</code></td></tr></table>
<p><code>S0</code>の<code>S1</code>に対する順序（大小）を求めます。
  順序は文字の比較にしたがいます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 le? @public -&gt; &lt;bool&gt; ;;
eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>S0</code>が<code>S1</code>に対して，それぞれ，「等しい」「より前」「より前か等しい」「より後」「より後か等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval ord_fs @public -&gt; &lt;cstr ord_fs&gt; ;;</code></td></tr></table>
<p>順序判定の機能群を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S0 &lt;cstr&gt; *S1 eq_ignore_case? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>大文字か小文字かを区別せず，文字列が等価かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S trim_spaces @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>先頭と末尾の空白文字を削除します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.cstr.3"><code>sango.cstr</code> - 行</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;line&gt; @public := line_text: &lt;cstr&gt; line_term: &lt;cstr&gt; line$ ;;</code></td></tr></table>
<p>行を表します。
  主に，行の終端をハンドリングする場合に使用します。
  終端は通常は改行シーケンスですが，任意のシーケンスとしても使用可能です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *CharStr split_into_lines | lines @public -&gt; &lt;line list&gt; ;;</code></td></tr></table>
<p>改行シーケンス（CR，LF，CR+LF）のいずれかを終端として，行に分割します。
  <code>CharStr</code>の末尾において，通常の文字があり，かつ，改行シーケンスが無い場合，終端無しの行として切り出します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.debug"><code>sango.debug</code></h1>

<p>プログラムのデバッグに有用な機能を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.debug.1"></code>sango.debug</code> - オブジェクト情報</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X repr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>オブジェクトのデバッグ用表現（型，構成情報）を返します。
  使用者が定義した型は表現を変更することができます。
  そのためには，定義しているモジュールの中で「<code>eval &lt;t&gt; *X _debug_repr_T -&gt; &lt;cstr&gt;</code>」（<code>&lt;t&gt;</code>は型定義のシグネチャ，<code>T</code>は型構築子）という関数を定義します。
</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.debug.2"></code>sango.debug</code> - アサーション</h2>

<table border width="100%"><tr><td class="def"><code>eval check_assertion? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>アサーションを検査するかどうかを返します。現バージョンでは常に<code>true$</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool&gt; *Check_assertion &lt;bool fun&gt; *Assertion &lt;cstr&gt; *Msg assert @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>Check_assertion</code>が<code>true$</code>のときに<code>Assertion</code>を実行し，<code>false$</code>が返された場合に<code>assertion_error$</code>例外を発生させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool fun&gt; *Assertion &lt;cstr&gt; *Msg assert_always @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>常に<code>Assertion</code>を実行し，<code>false$</code>が返された場合に<code>assertion_error$</code>例外を発生させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bool fun&gt; *Assertion &lt;cstr&gt; *Msg assert_on_demand @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>check_assertion?</code>の結果に応じて<code>Assertion</code>を実行し，<code>false$</code>が返された場合に<code>assertion_error$</code>例外を発生させます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.debug.3"></code>sango.debug</code> - 例外情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;frame&gt; @protected :=
  mod: &lt;cstr&gt;
  name: &lt;cstr&gt;
  loc_: &lt;cstr maybe&gt;
  transferred: &lt;bool&gt;
  frame$ ;;</code></td></tr></table>
<p>実行時の関数スタックの各フレームを表します。<code>mod</code>はモジュール名，<code>name</code>は関数の公式名，<code>loc_</code>はソースコードの位置情報（行番号）です。<code>transferred</code>は，呼び出しの最適化が行われたことを示します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exc_info&gt; *EI call_stack @public -&gt; &lt;frame list&gt; ;;</code></td></tr></table>
<p>実行時の関数スタックを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;exception&gt; *Exc &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out
  dump_exception_to | dump_to @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>例外情報をダンプします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.entity"><code>sango.entity</code></h1>

<p>「実体」（entity）を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.1"></code>sango.entity</code> - 実体</h2>

<table border width="100%"><tr><td class="def"><code>extend &lt;independent&gt; -&gt; ent_d @public :=
| existence$ ;;</code></td></tr></table>
<p>実体に紐づけられるデータを示します。
  必要に応じて拡張して使用します。
  <code>existence$</code>は，実体としての存在のみに意味がありデータが不要な場合に使用します。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;eref&gt; @public := &lt;ent_d+ &quot;sango.entity.box&quot;.box_h&gt; ;;</code></td></tr></table>
<p>実体への参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;ent_d+&gt; *X &lt;&lt;void fun&gt; maybe&gt; *Invalidator_
  create_entity @public -&gt; &lt;eref&gt; ;;</code></td></tr></table></p>
<p><code>X</code>を初期値として実体を生成します。
  実体がガーベジコレクトされた際に制御を受け取る関数（invalidator）を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;eref&gt; *Entity read @public -&gt; &lt;ent_d+&gt; ;;</code></td></tr></table>
<p>実体から値を読み出します。
  この処理は原子的に実行されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;eref&gt; *Entity &lt;ent_d+&gt; *X write | swap @public -&gt; &lt;ent_d+&gt; ;;</code></td></tr></table>
<p>実体に値を書き込み，以前の値を返します。
  この処理は原子的に実行されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.2"></code>sango.entity</code> - 弱参照</h2>

<table border width="100%"><tr><td class="def"><code>alias type &lt;wref&gt; @public := &lt;ent_d+ &quot;sango.entity.box&quot;.wbox_h&gt; ;;</code></td></tr></table>
<p>実体への弱参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;eref&gt; *Entity &lt;&lt;wref void fun&gt; maybe&gt; *Listener_
  create_weak_holder @public -&gt; &lt;wref&gt; ;;</code></td></tr></table>
<p>実体への弱参照を生成します。
  弱参照が無効になった際に制御を受け取る関数（リスナ）を指定することができます。
  リスナは，新しいアクタとして起動され，本関数で生成された弱参照オブジェクトが渡されます。
  なお，本関数で生成されたオブジェクトが存在しないとき（ガーベジコレクトされたとき）には，リスナは呼び出されません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;wref&gt; *W get @public -&gt; &lt;eref maybe&gt; ;;</code></td></tr></table>
<p>弱参照から参照（強参照）を取得します。
  弱参照が無効になっている場合には<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;wref&gt; *W clear @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>弱参照を無効にします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.entity.box"><code>sango.entity.box</code></h1>

<p>特定の型のデータだけを保持する「実体」（entity）を提供します。この「実体」をボックスと呼びます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.box.1"></code>sango.entity.box</code> - ボックス</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! box_h&gt; @opaque ;;</code></td></tr></table>
<p>ボックスへの参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A!&gt; *X &lt;&lt;void fun&gt; maybe&gt; *Invalidator_
  create_box @public -&gt; &lt;A box_h&gt; ;;</code></td></tr></table>
<p><code>X</code>を初期値としてボックスを生成します。
  <code>X</code>の型は具象型（不定の型パラメタを含まない型）でなければなりません。
  ボックスがガーベジコレクトされた際に制御を受け取る関数（invalidator）を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! box_h&gt; *Box read @public -&gt; &lt;A&gt; ;; </code></td></tr></table>
<p>ボックスから値を読み出します。
  この処理は原子的に実行されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! box_h&gt; *Box &lt;A&gt; *X write | swap @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>ボックスに値を書き込み，以前の値を返します。
  この処理は原子的に実行されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.box.2"></code>sango.entity.box</code> - 弱参照</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! wbox_h&gt; @opaque ;;</code></td></tr></table>
<p>ボックスへの弱参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! box_h&gt; *Box &lt;&lt;&lt;A wbox_h&gt; void fun&gt; maybe&gt; *Listener_
  create_weak_holder @public -&gt; &lt;A wbox_h&gt; ;;</code></td></tr></table>
<p>ボックスへの弱参照を生成します。
  弱参照が無効になった際に制御を受け取る関数（リスナ）を指定することができます。
  リスナは，新しいアクタとして起動され，本関数で生成された弱参照オブジェクトが渡されます。
  なお，本関数で生成されたオブジェクトが存在しないとき（ガーベジコレクトされたとき）には，リスナは呼び出されません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! wbox_h&gt; *W get @public -&gt; &lt;&lt;A box_h&gt; maybe&gt; ;;</code></td></tr></table>
<p>弱参照から参照（強参照）を取得します。
  弱参照が無効になっている場合には<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! wbox_h&gt; *W clear @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>弱参照を無効にします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.entity.domain"><code>sango.entity.domain</code></h1>

<p>「実体」（entity）に対し，ドメイン（領域）の中で固有番号を付与した参照を作成します。
  参照を固有番号で扱ったり，大小比較することが可能になります。
  固有番号は，参照が生存している間，有効です。
  参照オブジェクトが回収されると，固有番号は再利用されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.domain.1"></code>sango.entity.domain</code> - ドメイン</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;domain_h&gt; @opaque ;;</code></td></tr></table>
<p>ドメインへのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval default_domain @public -&gt; &lt;domain_h&gt; ;;</code></td></tr></table>
<p>デフォルト・ドメイン（あらかじめ用意されているドメイン）を取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval create_domain @public -&gt; &lt;domain_h&gt; ;;</code></td></tr></table>
<p>ドメインを作成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.domain.2"></code>sango.entity.domain</code> - 実体</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! entity_h&gt; @opaque ;;</code></td></tr></table>
<p>実体への参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;domain_h&gt; *Domain &lt;*A!&gt; *X &lt;&lt;void fun&gt; maybe&gt; *Invalidator_
  create_entity @public -&gt; &lt;A entity_h&gt; ;;</code></td></tr></table></p>
<p>ドメイン内に，<code>X</code>を初期値として実体を生成します。
  実体がガーベジコレクトされた際に制御を受け取る関数（invalidator）を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;domain_h&gt; *Domain &lt;*A! &quot;sango.entity.box&quot;.box_h&gt; *Box contain_box @public -&gt; &lt;A entity_h&gt; ;;</code></td></tr></table>
<p><code>ボックスをドメインに取り込み，参照を作成します。
  一つの参照を複数の異なったドメインに取り込むことは可能ですが，作成される参照は異なります。
  同一のドメイン内に複数回取り込んだ場合も，そのたびに作成される参照は異なります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! entity_h&gt; *Entity entity_domain | domain @public -&gt; &lt;domain_h&gt; ;;</code></td></tr></table>
<p>参照が属するドメインを取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! entity_h&gt; *Entity read @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>実体から値を読み出します。
  この処理は原子的に実行されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! entity_h&gt; *Entity &lt;A&gt; *X write | swap @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>実体に値を書き込み，以前の値を返します。
  この処理は原子的に実行されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.domain.3"></code>sango.entity.domain</code> - 弱参照</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! weak_holder_h&gt; @opaque ;;</code></td></tr></table>
<p>実体への弱参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;domain_h&gt; *Domain &lt;*A! entity_h&gt; *Entity &lt;&lt;A weak_holder_h void fun&gt; maybe&gt; *Listener_
  create_weak_holder @public -&gt; &lt;A weak_holder_h&gt; ;;</code></td></tr></table>
<p>ドメイン内に，実体への弱参照を生成します。
  付与される固有番号は，<code>Entity</code>のそれとは無関係，別系列です。
  ドメインは<code>Entity</code>の属するドメインとは異なっていても構いません。
  弱参照が無効になった際に制御を受け取る関数（リスナ）を指定することができます。
  リスナは，新しいアクタとして起動され，本関数で生成された弱参照オブジェクトが渡されます。
  なお，本関数で生成されたオブジェクトが存在しないとき（ガーベジコレクトされたとき）には，リスナは呼び出されません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! weak_holder_h&gt; *Weak_holder weak_holder_domain | domain @public -&gt; &lt;domain_h&gt; ;;</code></td></tr></table>
<p>弱参照が属するドメインを取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! weak_holder_h&gt; *Weak_holder get @public -&gt; &lt;&lt;A entity_h&gt; maybe&gt; ;;</code></td></tr></table>
<p>弱参照から参照（強参照）を取得します。
  弱参照が無効になっている場合には<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! weak_holder_h&gt; *Weak_holder clear @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>弱参照を無効にします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.domain.4"></code>sango.entity.domain</code> - 固有番号，大小比較</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! entity_h&gt; *Entity entity_unique_num | unique_num @public -&gt; &lt;int&gt; ;;
eval &lt;*A! weak_holder_h&gt; *Weak_holder weak_holder_unique_num | unique_num @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>固有番号を取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! entity_h&gt; *E0 &lt;*B! entity_h&gt; *E1 entity_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;*A! weak_holder_h&gt; *W0 &lt;*B! weak_holder_h&gt; *W1 weak_holder_compare | compare @public -&gt; &lt;ordering&gt; ;; </code></td></tr></table>
<p>固有番号に基づき，前者の後者に対する大小関係を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval entity_ord_fs @public -&gt; &lt;*A! entity_h ord_fs&gt; ;;
eval weak_holder_ord_fs @public -&gt; &lt;*A! weak_holder_h ord_fs&gt; ;;</code></td></tr></table>
<p>大小比較の機能群を返します。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;unique_num_invalidator&gt; @public := &lt;int void fun&gt; ;;</code></td></tr></table>
<p>固有番号の無効化処理関数を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! entity_h&gt; *Entity &lt;unique_num_invalidator&gt; *Invalidator
  entity_add_unique_num_invalidator | add_unique_num_invalidator @public -&gt; &lt;void&gt; ;;
eval &lt;*A! weak_holder_h&gt; *Weak_holder &lt;unique_num_invalidator&gt; *Invalidator
  weak_holder_add_unique_num_invalidator | add_unique_num_invalidator @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>固有番号の無効化処理関数を登録します。
  無効化処理関数は，参照あるいは弱参照オブジェクトの消滅（回収）後に，それぞれ別のアクタとして起動されます。
  また，実体の後処理関数の起動タイミングとも非同期です。
  正常終了，例外による終了にかかわらず，登録された関数がすべて終了した後で，当該固有番号は再使用の対象になります。
  この機能を使用する場合は，無効化処理関数が確実に成功するか，成功しなくても矛盾が発生しないようにしてください。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.entity.existence"><code>sango.entity.existence</code> 【Beta】</h1>

<p>「存在」は「実体」の中核になるもので，一つの「実体」は必ず一つの「存在」を持ちます。
  「存在」の一つ一つは，お互いに異なるものです。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.existence.1"></code>sango.entity.existence</code> - 存在</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;existence&gt; @opaque ;;</code></td></tr></table>
<p>「存在」を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A ro_slot&gt; @opaque ;;</code></td></tr></table>
<p>存在に結び付けられるデータ（関連データ）の格納場所を表します。
  この格納場所からは読み出しのみが可能です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! rw_slot&gt; @opaque ;;</code></td></tr></table>
<p>存在に結び付けられるデータ（関連データ）の格納場所を表します。
  この格納場所は同一の型のオブジェクトで更新可能です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A maybe&gt; *Assoc_ &lt;&lt;void fun&gt; maybe&gt; *Invalidator_ 
  create_immutable_existence @public -&gt; &lt;existence &lt;&lt;A ro_slot&gt; maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>存在を生成します。
  生成された存在は，お互いに異なります。
  生成にあたり，関連データを指定することができます。
  このデータは，返される<code>ro_slot</code>を使用して読み出しが可能です。
  存在がガーベジコレクトされた際に制御を受け取る関数（invalidator）を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A!&gt; *Assoc &lt;&lt;void fun&gt; maybe&gt; *Invalidator_
  create_mutable_existence @public -&gt; &lt;existence &lt;A rw_slot&gt; tuple&gt; ;;</code></td></tr></table>
<p>関連データを指定して，存在を生成します。
  生成された存在は，お互いに異なります。
  関連データは，返される<code>rw_slot</code>を使用して参照・更新が可能です。
  存在がガーベジコレクトされた際に制御を受け取る関数（invalidator）を指定することができます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;existence&gt; *Ex &lt;*A ro_slot&gt; *Slot imut_peek_assoc | peek_assoc @public -&gt; &lt;A&gt; ;;
eval &lt;existence&gt; *Ex &lt;*A! rw_slot&gt; *Slot mut_peek_assoc | peek_assoc @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>関連データを取得します。
  この関数は原子的に実行されます。
  <code>Ex</code>と<code>Slot</code>の整合性がとれていなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;existence&gt; *Ex &lt;*A! rw_slot&gt; *Slot &lt;A&gt; *New_assoc
  mut_replace_assoc | replace_assoc @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>関連データを置換します。
  以前に格納されていたデータが返されます。
  この関数は原子的に実行されます。
  <code>Ex</code>と<code>Slot</code>の整合性がとれていなければなりません。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.existence.2"></code>sango.entity.existence</code> - 弱参照</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;weak_ref&gt; @opaque ;;</code></td></tr></table>
<p>存在への弱参照を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;existence&gt; *Ex &lt;&lt;weak_ref void fun&gt; maybe&gt; *Listener_
  create_weak_ref @public -&gt; &lt;weak_ref&gt; ;;</code></td></tr></table>
<p>存在への弱参照を生成します。
  弱参照が無効になった際に制御を受け取る関数（リスナ）を指定することができます。
  リスナは，新しいアクタとして起動され，本関数で生成された弱参照オブジェクトが渡されます。
  なお，本関数で生成されたオブジェクトが存在しないとき（ガーベジコレクトされたとき）には，リスナは呼び出されません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;weak_ref&gt; *WR get @public -&gt; &lt;existence maybe&gt; ;;</code></td></tr></table>
<p>弱参照から参照（強参照）を取得します。
  弱参照が無効になっている場合には<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;weak_ref&gt; *WR clear @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>弱参照を無効にします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.entity.existence.3"></code>sango.entity.existence</code> - undress・redress</h2>
<p>存在が種々の情報をまとっているように実体を見立て，実体から存在を取り出すことを「undress」，存在をもとに実体を再構築することを「redress」と呼びます。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;*A undress_f&gt; @public := &lt;A &lt;existence &lt;A redress_f&gt; tuple&gt; fun&gt; ;;
alias type &lt;*A redress_f&gt; @public := &lt;existence A fun&gt; ;;</code></td></tr></table>
<p>undress，redress関数を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A dress_fs&gt; @public :=
  undress_f: &lt;A undress_f&gt;
  dress_fs$ ;;</code></td></tr></table>
<p>undress，redress機能群を表します。
  実際に含まれるのはundress関数のみです。</p>

<table border width="100%"><tr><td class="def"><code>eval dress_fs @public -&gt; &lt;existence dress_fs&gt; ;;</code></td></tr></table>
<p><code>&quot;sango.entity&quot;.existence</code>のundress・redress機能群を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.fun"><code>sango.fun</code></h1>

<p>関数・クロージャに関するユーティリティ機能を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.fun.1"><code>sango.fun</code> - 1引数関数への変換</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*T fun&gt; *F0 unary0 | unary @public -&gt; &lt;*A T fun&gt; ;;
eval &lt;*A *T fun&gt; *F1 unary1 | unary @public -&gt; &lt;A T fun&gt; ;;
eval &lt;*A *B *T fun&gt; *F2 unary2 | unary @public -&gt; &lt;&lt;A B tuple&gt; T fun&gt; ;;
eval &lt;*A *B *C *T fun&gt; *F3 unary3 | unary @public -&gt; &lt;&lt;A B C tuple&gt; T fun&gt; ;;
eval &lt;*A *B *C *D *T fun&gt; *F4 unary4 | unary @public -&gt; &lt;&lt;A B C D tuple&gt; T fun&gt; ;;
eval &lt;*A *B *C *D *E *T fun&gt; *F5 unary5 | unary @public -&gt; &lt;&lt;A B C D E tuple&gt; T fun&gt; ;; </code></td></tr></table>
<p>関数あるいはクロージャを1引数の関数オブジェクト（クロージャ）に変換します。
  「<code>... &gt;&gt; &amp;(^foo unary) ...</code>」のように使用すれば，関数のパイプラインを作れます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.io"><code>sango.io</code></h1>

<p>入出力の基本事項と，ストリーム型入出力のフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.1"><code>sango.io</code> - データ定義</h2>

<table border width="100%"><tr><td class="def"><code>extend &lt;exc_desc&gt; @public := &lt;io_failure+&gt; io_failure$ ;;
data &lt;io_failure&gt; @public := not_exist$ | not_available$ | not_allowed$
| bad_param$ | bad_data$ | timeout$ | interrupted$ | error$ ;;</code></td></tr></table>
<p>入出力に関する例外を表します。
  今後，データ構築子が追加される可能性があります。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A trial_res&gt; @public := &lt;A&gt; done$ | not_ready$ ;;</code></td></tr></table>
<p>「準備されているデータを読み込み，データが無かった場合は待ち合わせせずに復帰する」処理などの結果を表します。
  データを受け取った場合は<code>done$</code>，データが準備されていなかった場合は<code>not_ready$</code>が返ります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.2"><code>sango.io</code> - 入力ストリーム</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A instream_h&gt; @public :=
  read_f: &lt;&lt;A instream_read_res&gt; fun&gt;
  read_string_f: &lt;int &lt;&lt;A string&gt; instream_read_res&gt; fun&gt;
  try_read_f_: &lt;&lt;&lt;&lt;A instream_read_res&gt; trial_res&gt; fun&gt; maybe&gt;
  try_read_string_f_:
    &lt;&lt;int &lt;&lt;&lt;A string&gt; instream_read_res&gt; trial_res&gt; fun&gt; maybe&gt;
  close_f: &lt;void fun&gt;
  status_f: &lt;instream_status fun&gt;
  instream_h$ ;;</code></td></tr></table>
<p><code>&lt;A&gt;</code>を単位とする汎用入力ストリームのハンドルを表します。
  属性は実装関数で，使用者は意識する必要はありません。
  この中で，<code>try_*</code>はオプション機能です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;instream_status&gt; @public := instream_open$ | instream_eof$
| &lt;exception&gt; instream_error$ | instream_closed$ ;;</code></td></tr></table>
<p>入力ストリームの状態を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A instream_read_res&gt; @public :=
  &lt;A&gt; instream_data$ | instream_at_end$ ;;</code></td></tr></table>
<p>入力ストリームからの読み込み結果を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In &lt;cstr&gt; *Feature
  instream_feature_available? | feature_available? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>In</code>がオプション機能を持っているかどうか判定します。
  <code>Feature</code>には，<code>&quot;try_read&quot;</code>，<code>&quot;try_read_string&quot;</code>を指定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In
  read_from_instream | read @public -&gt; &lt;A instream_read_res&gt; ;;</code></td></tr></table>
<p>入力ストリームから一単位のデータを読み込みます。
  データが準備されていない場合は，データの到着を待ち合わせます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In &lt;int&gt; *Len
  read_string_from_instream | read_string @public
  -&gt; &lt;&lt;A string&gt; instream_read_res&gt; ;;</code></td></tr></table>
<p>入力ストリームから最大Len個のデータを読み込みます。
  返されるストリングの要素数はLenより小さいことがあります。
  データが準備されていない場合は，データの到着を待ち合わせます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In
  try_read_from_instream | try_read @public
  -&gt; &lt;&lt;A instream_read_res&gt; trial_res&gt; ;;</code></td></tr></table>
<p>入力ストリームから一単位のデータを読み込みます。
  データが準備されていない場合は，<code>not_ready$</code>が返ります。
  この関数がサポートされていない場合は<code>unsupported$</code>例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In &lt;int&gt; *Len
  try_read_string_from_instream | try_read_string @public
  -&gt; &lt;&lt;&lt;A string&gt; instream_read_res&gt; trial_res&gt; ;;</code></td></tr></table>
<p>入力ストリームから最大<code>Len</code>個のデータを読み込みます。
  返されるストリングの要素数は<code>Len</code>より小さいことがあります。
  データが準備されていない場合は，<code>not_ready$</code>が返ります。
  この関数がサポートされていない場合は<code>unsupported$</code>例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In close_instream | close @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>入力ストリームを閉じます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A instream_h&gt; *In
  instream_status | status @public -&gt; &lt;instream_status&gt; ;;</code></td></tr></table>
<p>入力ストリームの状態を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.3"><code>sango.io</code> - 出力ストリーム</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A outstream_h&gt; @public :=
  write_f: &lt;A void fun&gt;
  write_string_part_f: &lt;&lt;A string&gt; int int void fun&gt;
  flush_f: &lt;void fun&gt;
  close_f: &lt;void fun&gt;
  status_f: &lt;outstream_status fun&gt;
  outstream_h$ ;;</code></td></tr></table>
<p><code>&lt;A&gt;</code>を単位とする汎用出力ストリームのハンドルを表します。
  属性は実装関数で，使用者は意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;outstream_status&gt; @public := outstream_open$
| &lt;exception&gt; outstream_error$ | outstream_closed$ ;;</code></td></tr></table>
<p>出力ストリームの状態を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A outstream_h&gt; *Out &lt;A&gt; *Data
  write_data_to_outstream | write @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>出力ストリームへ一単位のデータを書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A outstream_h&gt; *Out &lt;A string&gt; *DataStr &lt;int&gt; *Start &lt;int&gt; *Len 
  write_string_part_to_outstream | write @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>出力ストリームへ，<code>DataStr</code>の指標<code>Start</code>から<code>Len</code>個の要素を書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A outstream_h&gt; *Out &lt;A string&gt; *DataStr
  write_string_to_outstream | write @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>出力ストリームへストリングを書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A outstream_h&gt; *Out flush_outstream | flush @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>出力ストリームをフラッシュ（flush）し，その結果を待ちます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A outstream_h&gt; *Out close_outstream | close @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>出力ストリームを閉じます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A outstream_h&gt; *Out
  outstream_status | status @public -&gt; &lt;outstream_status&gt; ;;</code></td></tr></table>
<p>出力ストリームの状態を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.4"><code>sango.io</code> - 文字入出力ストリーム</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte instream_h&gt; *BI &lt;&quot;sango.chara.encoding&quot;.decoder_h&gt; *Decoder
  open_char_instream @public -&gt; &lt;char instream_h&gt; ;;</code></td></tr></table>
<p>バイト入力ストリームから文字を読み込むストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte instream_h&gt; *BI
  open_char_instream_for_default_encoding | open_char_instream @public
  -&gt; &lt;char instream_h&gt; ;;</code></td></tr></table>
<p>システムのデフォルトのエンコーディングで，バイト入力ストリームから文字を読み込むストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.char.encoding&quot;.encoder_h&gt; *Encoder &lt;byte outstream_h&gt; *BO
  open_char_outstream @public -&gt; &lt;char outstream_h&gt; ;;</code></td></tr></table>
<p>バイト出力ストリームへ文字を書き込むストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte outstream_h&gt; *BO
  open_char_outstream_for_default_encoding | open_char_outstream @public
  -&gt; &lt;char outstream_h&gt; ;;</code></td></tr></table>
<p>システムのデフォルトのエンコーディングで，バイト出力ストリームへ文字を書き込むストリームを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.5"><code>sango.io</code> - 行入力ストリーム</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;line_instream_h&gt; @public :=
  read_line_f: &lt;&lt;&quot;sango.cstr&quot;.line instream_read_res&gt; fun&gt;
  close_f: &lt;void fun&gt;
  status_f: &lt;instream_status fun&gt;
  line_instream_h$ ;;</code></td></tr></table>
<p>行入力ストリームのハンドルを表します。
  属性は実装関数で，使用者は意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char instream_h&gt; *CI
  open_line_instream_from_char_instream | open_line_instream @public
  -&gt; &lt;line_instream_h&gt; ;;</code></td></tr></table>
<p>文字入力ストリームから行を読み込むストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte instream_h&gt; *BI
  open_line_instream_for_default_encoding_from_byte_instream
  | open_line_instream @public -&gt; &lt;line_instream_h&gt; ;;</code></td></tr></table>
<p>システムのデフォルトのエンコーディングで，バイト入力ストリームから行を読み込むストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;line_instream_h&gt; *In
  read_line_from_line_instream | read_line @public
  -&gt; &lt;&quot;sango.cstr&quot;.line instream_read_res&gt; ;;</code></td></tr></table>
<p>一行読み込みます。
  行が準備されていない場合は，入力を待ち合わせます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;line_instream_h&gt; *In close_line_instream | close @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>ストリームを閉じます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;line_instream_h&gt; *In
  line_instream_status | status @public -&gt; &lt;instream_status&gt; ;;</code></td></tr></table>
<p>ストリームの状態を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.6"><code>sango.io</code> - プリントストリーム</h2>

<p>表示やテキストファイルへの出力ストリームです。システムに応じた改行を行います。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;print_stream_h&gt; @public :=
  write_f: &lt;char void fun&gt;
  write_string_part_f: &lt;cstr int int void fun&gt;
  flush_f: &lt;void fun&gt;
  close_f: &lt;void fun&gt;
  status_f: &lt;outstream_status fun&gt;
  newline_f: &lt;void fun&gt;
  print_stream_h$ ;;</code></td></tr></table>
<p>プリントストリームのハンドルを表します。
  属性は実装関数で，使用者は意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Line_terminator &lt;char outstream_h&gt; *CO
  open_print_stream @public -&gt; &lt;print_stream_h&gt; ;;</code></td></tr></table>
<p>文字出力ストリームに書き込むプリントストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char outstream_h&gt; *CO
  open_print_stream_with_default_line_terminator
  | open_print_stream @public -&gt; &lt;print_stream_h&gt; ;;</code></td></tr></table>
<p>システムのデフォルト改行シーケンスを使用して，文字出力ストリームに書き込むプリントストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte outstream_h&gt; *BO
  open_default_print_stream_to_byte_outstream
  | open_print_stream @public -&gt; &lt;print_stream_h&gt; ;;</code></td></tr></table>
<p>システムのデフォルト改行シーケンスとデフォルトエンコーディングを使用して，バイト出力ストリームに書き込むプリントストリームを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;cstr&gt; *CharStr
  print_cstr | print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列を書き込みます。
  いずれかの改行シーケンスが含まれている場合は，その箇所で改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out break_print_stream | newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;cstr&gt; *Line print_and_newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列を書き込んだ後，改行します。
  いずれかの改行シーケンスが含まれている場合は，その箇所で改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;char&gt; *Char
  print_raw_char | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字を書き込みます。
  改行文字の場合もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;cstr&gt; *CharStr
  print_raw_cstr | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列を書き込みます。
  含まれている改行文字もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;cstr&gt; *CharStr &lt;int&gt; *Start &lt;int&gt; *Len
  print_raw_cstr_part | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列のうち，指標<coee>Start</code>から<code>Len</code>文字を書き込みます。
  含まれている改行文字もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;&quot;sango.cstr&quot;.line&gt; *Line
  print_line | print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>行を書き込みます。
  含まれている改行文字もその文字として<code>line_text</code>を書き込み，<code>line_term</code>が空文字列でなければ改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out &lt;&quot;sango.cstr&quot;.line&gt; *Line print_raw_line | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>行を書き込みます。
  <code>line_text</code>と<code>line_term</code>を，含まれている改行文字もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out flush_print_stream | flush @public  -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>プリントストリームをフラッシュ（flush）し，その結果を待ちます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out close_print_stream | close @public  -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>プリントストリームを閉じます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;print_stream_h&gt; *Out
  print_stream_status | status @public -&gt; &lt;outstream_status&gt; ;;</code></td></tr></table>
<p>プリントストリームの状態を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.io.filesys"><code>sango.io.filesys</code> 【Beta】</h1>

<p>ファイルシステムへのインタフェースを提供します。
  ファイルシステムの機能や動作はオペレーティングシステムに依存しますが，このモジュールでは，共通する範囲での機能を提供します 。
  Windows，UNIXそれぞれ固有のファイルシステム機能は，<code>&quot;sango.io.filesys.winnt&quot;</code>，<code>&quot;sango.io.filesys.unix&quot;</code>モジュールが提供しています。</p>
<p>このモジュールは整備中であり，将来変更される可能性があります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.filesys.1"><code>sango.io.filesys</code> - ディレクトリとファイルの操作</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr exist? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>ディレクトリあるいはファイルが存在するかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr directory? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>ディレクトリかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr file? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>ファイルかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr last_updated @public -&gt; &lt;&quot;sango.num.bigint&quot;.bigint&gt; ;;</code></td></tr></table>
<p>最終更新時刻を，1970年1月1日00：00：00からのミリ秒で返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr delete @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>ファイルあるいはディレクトリを削除します。
  ディレクトリの場合は，中身が空でなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr_cur &lt;cstr&gt; *Path_repr_new move @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>ファイルあるいはディレクトリを移動（名前を変更）し，移動後のパスを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr dir_entries @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p>「<code>.</code>」と「<code>..</code>」を除き，ディレクトリの要素を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr create_dir @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>ディレクトリを作成し，作成されたディレクトリのパスを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_repr create_dirs @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>ディレクトリを作成し，作成されたディレクトリのパスを返します。
  必要な親ディレクトリも作成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.filesys.2"><code>sango.io.filesys</code> - パスの操作</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;path_struct&gt; @opaque ;;</code></td></tr></table>
<p>パスの構造を表します。
  エリア（Windowsでの「<code>C:\</code>」，「<code>\\<var>host</var>\<var>shared</var></code>」，UNIXでのルートを示す「<code>/</code>」など）と名前の列から構成されます。</p>

<table border width="100%"><tr><td class="def"><code>eval file_separator @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>パスにおける名前の区切り文字を文字列として返します。</p>

<table border width="100%"><tr><td class="def"><code>eval file_separator_char @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p>パスにおける名前の区切り文字を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval path_separator @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>パスの並びの区切り文字を文字列として返します。</p>

<table border width="100%"><tr><td class="def"><code>eval path_separator_char @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p>パスの並びの区切り文字を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval current_dir_name @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>&quot;.&quot;</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval parent_dir_name @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>&quot;..&quot;</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS path_area @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>エリアを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS path_base_name @public -&gt; &lt;cstr maybe&gt; ;;</code></td></tr></table>
<p>パスの最後の名前を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS path_names @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p>名前の列を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Area &lt;cstr list&gt; *Names new_path @public -&gt; &lt;path_struct&gt; ;;</code></td></tr></table>
<p>パスを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS absolute_path? | absolute? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>絶対パスかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS parent_path @public -&gt; &lt;path_struct maybe&gt; ;;</code></td></tr></table>
<p>親のパスを返します。
  親が無い絶対パスの場合は<code>none$</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS &lt;cstr&gt; *Child child_path @public -&gt; &lt;path_struct&gt; ;;</code></td></tr></table>
<p>子のパスを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Names new_relative_path @public -&gt; &lt;path_struct&gt; ;;</code></td></tr></table>
<p>相対パスを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path parse_path | parse @public -&gt; &lt;path_struct&gt; ;;</code></td></tr></table>
<p>実行環境のOSにおいてパスを解析します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS path_repr | repr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>実行環境のOSにおいてパス構造をパス表現に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;path_struct&gt; *PS dir_path_repr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>実行環境のOSにおいてパス構造をディレクトリのパス表現に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Name split_ext @public -&gt; &lt;cstr cstr tuple&gt; ;;</code></td></tr></table>
<p>名前を本体と拡張子に分離します。
  最後に含まれる<code>&quot;.&quot;</code>以降を拡張子とみなします。
  結果は，第一要素が本体で，第二要素が拡張子（先頭は<code>&quot;.&quot;</code>）とするタプルになります。
  拡張子が無い場合，第二要素は空文字列になります。</p>
<ul>
  <li><code>&quot;.&quot;</code>と<code>&quot;..&quot;</code>の場合は，これ自体が本体で拡張子は空文字列です。</li>
  <li>名前の先頭の<code>&quot;.&quot;</code>は区切り文字ではなく通常の文字とみなされます。したがって，先頭にだけ<code>&quot;.&quot;</code>を含む場合は，全体が本体で拡張子は空文字列です。</li>
</ul>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path0 &lt;cstr&gt; *Path1 same_path? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>それぞれのパスが同一のものを示すか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path absolute_path | absolute @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>絶対パスに変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval path_eq_fs @public -&gt; &lt;cstr eq_fs&gt; ;;</code></td></tr></table>
<p><code>same_path?</code>でパスの等価判定を行う機能群を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.filesys.3"><code>sango.io.filesys</code> - ファイルの入出力</h2>

<p>ファイルに対するバイトストリームを提供します。
  操作は<code>&quot;sango.io&quot;</code>のフレームワークによって行います。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *File open_byte_instream @public -&gt; &lt;byte &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p>ファイルの先頭から読み込むバイト入力ストリームを開きます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *File open_byte_outstream_init | open_byte_outstream @public
  -&gt; &lt;byte &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p>ファイルの先頭から書き込むバイト出力ストリームを開きます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *File &lt;bool&gt; *Append
  open_byte_outstream @public -&gt; &lt;byte &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p>バイト出力ストリームを開きます。
  <code>Append</code>に<code>true$</code>を指定すると追加書き込みになります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.filesys.4"><code>sango.io.filesys</code> - 一時ファイル</h2>

<table border width="100%"><tr><td class="def"><code>eval temp_dir @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>一時ディレクトリのパスを返します。
  末尾には，パス区切り文字が付加されています。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Prefix &lt;cstr&gt; *Suffix &lt;bool&gt; *Delete_on_exit create_temp_file @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>一時ディレクトリの下に，ファイルを作成します。
 ファイル名の先頭を3文字以上の<code>Prefix</code>で，末尾を<code>Suffix</code>で指定します。
 <code>Delete_on_exit</code>に<code>true$</code>を指定すると，作成されたファイルはプログラム終了時に削除されます。
  </p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Prefix &lt;cstr&gt; *Suffix &lt;bool&gt; *Delete_on_exit &lt;cstr&gt; *Dir create_temp_file_in | create_temp_file @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>指定されたディレクトリの下に，一時ファイルを作成します。 </p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.io.stdio"><code>sango.io.stdio</code></h1>

<p>標準入出力を提供します。
  標準入力は行入力ストリーム，標準出力，標準エラー出力のハンドルはプリントストリームであり，置き換えることも可能です 。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.stdio.1"><code>sango.io.stdio</code> - 標準入力</h2>

<p>ハンドルを使ってデータを読み込みます。
  ハンドルを意識せずに呼び出せる関数も一部提供されています。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdin @public -&gt; &lt;&quot;sango.io&quot;.line_instream_h&gt; ;;</code></td></tr></table>
<p>標準入力のハンドルを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdin_org_impl @public -&gt; &lt;&quot;sango.io&quot;.line_instream_h&gt; ;;</code></td></tr></table>
<p>プログラム開始時の標準入力のハンドルを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdin_read_line | read_line @public -&gt; &lt;cstr &quot;sango.io&quot;.instream_read_res&gt; ;;</code></td></tr></table>
<p>標準入力から行を読み込みます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.stdio.2"><code>sango.io.stdio</code> - 標準出力</h2>

<p>ハンドルを使ってデータを書き込みます。
  ハンドルを意識せずに呼び出せる関数も一部提供されています。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdout @public -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p>標準出力のハンドルを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdout_org_impl @public -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p>プログラム開始時の標準出力のハンドルを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S cstdout_print_cstr | print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列を書き込みます。
  いずれかの改行シーケンスが含まれている場合は，その箇所で改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdout_newline | newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S
  cstdout_print_cstr_and_newline | print_and_newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列を書き込んだ後，改行します。
  いずれかの改行シーケンスが含まれている場合は，その箇所で改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C cstdout_print_raw_char | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字を書き込みます。
  改行文字の場合もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Start &lt;int&gt; *Len
  cstdout_print_cstr_raw_part | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>文字列のうち，指標<code>Start</code>から<code>Len</code>文字を書き込みます。
  含まれている改行文字もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.cstr.&quot;.line&gt; *L cstdout_print_line | print_line | print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>行を書き込みます。
  含まれている改行文字もその文字として<code>line_text</code>を書き込み，<code>line_term</code>が空文字列でなければ改行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.cstr&quot;.line&gt; *L cstdout_print_raw_line | print_raw_line | print_raw @public -&gt; &lt;void&gt; ;;
</code></td></tr></table>
<p>行を書き込みます。
  <code>line_text</code>と<code>line_term</code>を，含まれている改行文字もその文字として書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdout_flush | flush @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>標準出力をフラッシュ（flush）し，その結果を待ちます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.stdio.3"><code>sango.io.stdio</code> - 標準エラー出力</h2>

<p>ハンドルを返す関数が提供されています。
  ハンドルを使ってデータを書き込みます。</p>

<table border width="100%"><tr><td class="def"><code>eval cstderr @public -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p>標準エラー出力のハンドルを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstderr_org_impl @public -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p>プログラム開始時の標準エラー出力のハンドルを返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.io.util"><code>sango.io.util</code></h1>

<p>入出力のユーティリティ機能を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.util.1"><code>sango.io.util</code> - 空ストリーム</h2>

<p>空の入力ストリーム，空の出力ストリームを提供します。
  空の入力ストリームから読み込むと<code>&quot;sango.io&quot;.instream_at_end$</code>が返されます。
  空の出力ストリームに書き込んだデータは捨てられます。</p>

<table border width="100%"><tr><td class="def"><code>eval open_null_byte_instream @public -&gt; &lt;byte &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p>空のバイト入力ストリームを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval open_null_byte_outstream @public -&gt; &lt;byte &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p>空のバイト出力ストリームを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval open_null_char_instream @public -&gt; &lt;char &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p>空の文字入力ストリームを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval open_null_char_outstream @public -&gt; &lt;char &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p>空の文字出力ストリームを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval open_null_line_instream @public -&gt; &lt;&quot;sango.io&quot;.line_instream_h&gt; ;;</code></td></tr></table>
<p>空の行入力ストリームを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval open_null_print_stream @public -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p>空のプリントストリームを開始します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.util.2"><code>sango.io.util</code> - ストリングからの入力ストリーム</h2>

<p>ストリングをデータの供給源とする入力ストリームを提供します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Data open_string_instream @public -&gt; &lt;A &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p><code>Data</code>をデータの供給源とする入力ストリームを開始します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.util.3"><code>sango.io.util</code> - ストリームデータの連結</h2>

<p>ストリームデータを連結するユーティリティ機能（連結器）を提供します。
  連結器を生成すると出力ストリームのハンドラと結果を取得する関数が返されます。
  ハンドラを使用してストリームを書き込み，ストリームを閉じると結果が生成されます。
  結果はストリングバッファとして取得できます。
  メモリ上に結果を保持しますので，メモリ使用量に注意して使用してください。</p>

<table border width="100%"><tr><td class="def"><code>eval open_byte_stream_appender @public
  -&gt; &lt;&lt;byte &quot;sango.io&quot;.outstream_h&gt; &lt;&lt;byte &quot;sango.string&quot;.string_buf&gt; fun&gt; tuple&gt; ;;</code></td></tr></table>
<p>バイトストリームに対する連結器を生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval open_char_stream_appender @public
  -&gt; &lt;&lt;char &quot;sango.io&quot;.outstream_h&gt; &lt;&lt;char &quot;sango.string&quot;.string_buf&gt; fun&gt; tuple&gt; ;;</code></td></tr></table>
<p>文字ストリームに対する連結器を生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.io.util.4"><code>sango.io.util</code> - pump</h2>

<p>【Alpha】入力ストリームからデータを受け取りそのまま出力ストリームに書き込むアクタです。
  入力ストリームが終了するまで動作します。
  データのコピー，転送などに使用します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A pump_conf&gt; @public :=
  src: &lt;A &quot;sango.io&quot;.instream_h&gt;
  dst: &lt;A &quot;sango.io&quot;.outstream_h&gt;
  read_at_end_action: &lt;&lt;A pump_conf&gt; void fun&gt;
  read_error_action: &lt;&lt;A pump_conf&gt; &lt;exception&gt; void fun&gt;
  write_error_action: &lt;&lt;A pump_conf&gt; &lt;exception&gt; void fun&gt;
  pump_conf$ ;;</code></td></tr></table>
<p>pumpの構成を表します。
  今後拡張される可能性がありますので，次の関数で生成し，必要に応じて属性を変更して使用してください。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A &quot;sango.io&quot;.instream_h&gt; *Src &lt;A &quot;sango.io&quot;.outstream_h&gt; *Dst
  new_default_pump_conf @public -&gt; &lt;A pump_conf&gt; ;;</code></td></tr></table>
<p><code>Src</code>から<code>Dst</code>にデータを移送する<code>&lt;A pump_conf&gt;</code>を生成します。
  <code>read_at_end_action</code>は<code>pump_default_action_on_read_at_end</code>，<code>read_error_action</code>は<code>pump_default_action_on_read_error</code>，<code>write_error_action</code>は<code>pump_default_action_on_write_error</code>です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A pump_conf&gt; *Conf start_pump @public -&gt; &lt;void &quot;sango.actor&quot;.async_h&gt; ;;</code></td></tr></table>
<p>pumpを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A pump_conf&gt; *Conf
  pump_default_action_on_read_at_end @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>入力ストリームが終了した場合のデフォルトアクションです。
  入力ストリームを閉じた後，出力ストリームを強制書き出し(flush)し閉じます。
  出力ストリームの処理でエラーが発生した場合は，指定された，あるいはデフォルトのアクションが実行されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A pump_conf&gt; *Conf &lt;exception&gt; *E
  pump_default_action_on_read_error @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>入力ストリームの読み込みエラーが発生した場合のデフォルトアクションです。
  入力ストリームを閉じた後，出力ストリームを強制書き出し(flush)し閉じます。
  なお，この過程で例外が発生しても無視します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A pump_conf&gt; *Conf &lt;exception&gt; *E
  pump_default_action_on_write_error @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>出力ストリームの書き込みエラーが発生した場合のデフォルトアクションです。
  入力ストリーム，出力ストリームを閉じます。
  なお，この過程で例外が発生しても無視します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.lang.module"><code>sango.lang.module</code> 【Beta】</h1>

<p>モジュール管理機能へのインタフェースを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.lang.module.1"><code>sango.lang.module</code> - モジュールの動的ロード</h2>

<p>プログラム実行に必要であるとコンパイラが認識できたモジュールは，自動的にロードされます。
  それ以外のモジュールが必要であれば，プログラムから指示してロードします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Module_name require_module @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>モジュールをロードします。
  モジュールに初期化関数（<code>_init_</code>）が定義されている場合は，この関数の復帰と非同期に初期化が実行されます。
  すなわち，復帰時点で初期化が完了している保証はありません。
  すでにモジュールがロードされている場合は何もせずに終了します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Module_name wait_module_initialized @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>モジュールの初期化完了を待ち合わせます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Module_name
  module_init_actor_h @public -&gt; &lt;&quot;sango.actor&quot;.actor_h maybe&gt; ;;</code></td></tr></table>
<p>モジュールが初期化中の場合，それを実行しているアクタの<code>&lt;&quot;sango.actor&quot;.actor_h&gt;</code>を返します。
  初期化中でない場合，<code>none$</code>が返ります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.list"><code>sango.list</code></h1>

<p>リストについてのユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.list.1"><code>sango.list</code> - 生成</h2>

<table border width="100%"><tr><td class="def"><code>eval empty_list @public -&gt; &lt;*A list&gt; ;;</code></td></tr></table>
<p>空リストを作成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *Iter new_list @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>イテレータによってリストを作成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *Iter new_reverse_list @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>イテレータから供給される逆順にリストを作成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X &lt;A list&gt; *Xs cons @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p><code>Xs</code>の前に<code>X</code>を加えたリストを作成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A maybe&gt; *X_ &lt;A list&gt; *Xs cons_if_some @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p><code>X_</code>が<code>(*X value$)</code>であれば，<code>Xs</code>の前に<code>X</code>を加えたリストを作成します。
  <code>X_</code>が<code>none$</code>であれば，<code>Xs</code>を返します。 </p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *X0s &lt;A list&gt; *X1s cons_each @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p><code>X0s</code>の先頭から順次要素を取り出し<code>X1s</code>の前に加えたリストを作成し返します。
  結果は，<code>X1s</code>の前に<code>X0s</code>が逆順に加えられたものになります。 </p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.list.2"><code>sango.list</code> - 判定</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>空リストかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs non_empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>リストが要素を1個以上持っているか判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.list.3"><code>sango.list</code> - データ供給</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を順に供給するイテレータを返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.list.4"><code>sango.list</code> - 要素処理</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>リストの要素数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs head | first @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>リストの先頭要素を返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs tail @public -&gt; &lt;&lt;A list&gt; maybe&gt; ;;</code></td></tr></table>
<p>リストから先頭要素を除いた残りを返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs last @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>リストの末尾要素を返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;int&gt; *Index elem @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>リストのIndex番目の要素を返します。
  先頭は0番目です（以下同様）。
  該当する要素が無い場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;A&gt; *Y elem_index | index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p>Yに等価な（hardに等しい），先頭により近いオブジェクトがリストの何番目の要素かを返します。
  等価なオブジェクトが無い場合はnone$が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;A&gt; *Y elem_last_index | last_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p>Yに等価な（hardに等しい），末尾により近いオブジェクトがリストの何番目の要素かを返します。
  等価なオブジェクトが無い場合はnone$が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;int&gt; *Index &lt;A&gt; *Y insert_at @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素として<code>Y</code>を挿入します。
 <code>Index</code>が負の場合は先頭に挿入します。
 <code>Index</code>が要素の個数以上の場合は末尾に挿入します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;int&gt; *Index remove_at2 @public -&gt; &lt;&lt;A list&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を削除し，結果のリストと削除された要素の組を返します。
 該当する要素が無い場合は，リストは変化せず，タプルの第二要素は<code>none$</code>になります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;int&gt; *Index remove_at @public -&gt; &lt;&lt;&lt;A list&gt; A tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>【Deprecated】リストの<code>Index</code>番目の要素を削除し，結果のリストと削除された要素の組を返します。
 該当する要素が無い場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;int&gt; *Index &lt;A&gt; *Y replace_at2 @public -&gt; &lt;&lt;A list&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を<code>Y</code>で置換し，結果のリストと置換された要素の組を返します。
 該当する要素が無い場合は，リストは変化せず，タプルの第二要素は<code>none$</code>になります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;int&gt; *Index &lt;A&gt; *Y replace_at @public -&gt; &lt;&lt;&lt;A list&gt; A tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>【Deprecated】リストの<code>Index</code>番目の要素を<code>Y</code>で置換し，結果のリストと置換された要素の組を返します。
 該当する要素が無い場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs reverse @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>リストの順序を反転させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs0 &lt;A list&gt; *Xs1 append @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p><code>Xs0</code>の後ろに<code>Xs1</code>を連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;*A list&gt; list&gt; *Xss concat @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>要素のリストを全て連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;A *B fun&gt; *F map @public -&gt; &lt;B list&gt; ;;</code></td></tr></table>
<p>リストのそれぞれの要素に<code>F</code>を適用させて，結果をリストにして返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;A bool fun&gt; *F filter @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>リストのそれぞれの要素にFを適用させて，結果が<code>true$</code>の要素だけをリストにして返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X &lt;*B list&gt; *Ys &lt;A B A fun&gt; *F fold @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
 <p><code>(((X Ys<sub>0</sub> &amp;F) Ys<sub>1</sub> &amp;F) Ys<sub>2</sub> &amp;F)...</code> を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;*B&gt; *Y &lt;A B B fun&gt; *F fold_right @public -&gt; &lt;B&gt; ;;</code></td></tr></table>
<p><code>...(Xs<sub>n-3</sub> (Xs<sub>n-2</sub> (Xs<sub>n-1</sub> Y &amp;F) &amp;F) &amp;F)</code>を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;A A A fun&gt; *F reduce @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p><code>(((Xs<sub>0</sub> Xs<sub>1</sub> &amp;F) Xs<sub>2</sub> &amp;F) Xs<sub>3</sub> &amp;F)...</code> を返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs &lt;A A A fun&gt; *F reduce_right @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p><code>...(Xs<sub>n-4</sub> (Xs<sub>n-3</sub> (Xs<sub>n-2</sub> Xs<sub>n-1</sub> &amp;F) &amp;F) &amp;F)</code>を返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.net.inet"><code>sango.net.inet</code> 【Alpha】</h1>

<p>インターネットへのアクセス機能を提供します。
  整備中のため，解説しません。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.net.socket"><code>sango.net.socket</code> 【Alpha】</h1>

<p>ソケット機能を提供します。
  整備中のため，解説しません。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.num.bigint"><code>sango.num.bigint</code></h1>

<p><code>&lt;&quot;sango.num&quot;.bigint&gt;</code>を提供します。
  <code>&lt;&quot;sango.num&quot;.bigint&gt;は，</code>範囲の制約が無い整数です。
  内部表現としては，論理的に2の補数を取ります。
  処理効率は<code>&lt;int&gt;</code>より落ちますので，必要な場合だけ使用します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.bigint.1"><code>sango.num.bigint</code> - 生成</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;bigint&gt; @opaque ;;</code></td></tr></table>
<p><code>&lt;&quot;sango.num&quot;.bigint&gt;</code>を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I to_bigint | bigint @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p><code>&lt;int&gt;</code>を<code>&lt;&quot;sango.num&quot;.bigint&gt;</code>に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B to_int | int @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p><code>&lt;&quot;sango.num&quot;.bigint&gt;</code>を<code>&lt;int&gt;</code>に変換します。
  <code>&lt;int&gt;</code>の範囲外の場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B int_range? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>&lt;int&gt;</code>の範囲内かどうか判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.bigint.2"><code>sango.num.bigint</code> - 比較</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 compare @public -&gt; &lt;ordering&gt; ;;</code></td></tr></table>
<p><code>B0</code>の<code>B1</code>に対する大小を判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 le? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>B0</code>が<code>B1</code>に対して，それぞれ，「等しい」「より小さい」「より小さいか等しい」「より大きい」「より大きいか等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B zero? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B lt0? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B le0? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B gt0? @public -&gt; &lt;bool&gt; ;;
eval &lt;bigint&gt; *B ge0? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>それぞれ，「0に等しい」「0より小さい」「0より小さいか等しい」「0より大きい」「0より大きいか等しい」かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval eq_fs @public -&gt; &lt;bigint eq_fs&gt; ;;</code></td></tr></table>
<p>等価判定の機能群を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval ord_fs @public -&gt; &lt;bigint ord_fs&gt; ;;</code></td></tr></table>
<p>大小判定の機能群を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.bigint.3"><code>sango.num.bigint</code> - 算術演算</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 sum @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 diff @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 prod @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 quot @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 div @public -&gt; &lt;bigint bigint tuple&gt; ;;</code></td></tr></table>
<p>それぞれ，和，差，積，商，商と剰余の組を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B neg @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>符号を反転します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B inc | succ @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>1だけ増加させます（後者（successor）を求めます）。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B dec | pred @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>1だけ減少させます（前者（predecessor）を求めます）。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.bigint.4"><code>sango.num.bigint</code> - ビット演算</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B bit_not @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 bit_and @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 bit_or @public -&gt; &lt;bigint&gt; ;;
eval &lt;bigint&gt; *B0 &lt;bigint&gt; *B1 bit_xor @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>それぞれ，ビットごとの否定，論理積，論理和，排他的論理和を求めます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B &lt;int&gt; *I shift_left @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>左に<code>I</code>ビット分シフトします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B &lt;int&gt; *I shift_right_keep_sign @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>右に<code>I</code>ビット分シフトします。符号は保たれます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.bigint.5"><code>sango.num.bigint</code> - 文字表現との変換</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Str parse @public -&gt; &lt;bigint&gt; ;;</code></td></tr></table>
<p>文字列を十進数の整数として解析し<code>&lt;&quot;sango.num&quot;.bigint&gt;</code>に変換します。
  小数点を含んでいてはなりません。
  変換に失敗した場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>extend &lt;&quot;sango.cstr.format&quot;.fd&gt; @public := &lt;bigint&gt; bigint_fd$ ;;</code></td></tr></table>
<p>フォーマット用データを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B default_format | format @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>&lt;&quot;sango.num&quot;.bigint&gt;</code>を文字列にフォーマットします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.bigint.6"><code>sango.num.bigint</code> - その他</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;bigint&gt; *B bit_length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>符号ビットを除く，値のビット長を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.num.int"><code>sango.num.int</code></h1>

<p><code>&lt;int&gt;</code>についてのユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.int.1"><code>sango.num.int</code> - 列挙</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Start &lt;int&gt; *End &lt;int&gt; *Step enum @public -&gt; &lt;int &quot;sango.util.enum&quot;.enum&gt; ;;</code></td></tr></table>
<p>【Alpha】<code>Start</code>から<code>End</code>まで<code>Step</code>きざみの列挙を返します。
  <code>Step</code>には負の値も指定可能です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.int.2"><code>sango.num.int</code> - 文字表現との変換</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Str parse @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>文字列を十進数の整数として解析し<code>&lt;int&gt;</code>に変換します。
  小数点を含んでいてはなりません。
  変換に失敗した場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *I default_format | format @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>&lt;int&gt;</code>を文字列にフォーマットします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.num.real"><code>sango.num.real</code></h1>

<p><code>&lt;real&gt;</code>についてのユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.num.real.1"><code>sango.num.real</code> - 文字表現との変換</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Str parse @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>文字列を解析し<code>&lt;real&gt;</code>に変換します。
  <code>&quot;<var>xx</var>.<var>xx</var>&quot;</code>と<code>&quot;<var>xx</var>.<var>xx</var>E<var>xx</var>&quot;</code>の両方の形式，および<code>&quot;Infinity&quot;</code>，<code>&quot;NaN&quot;</code>に対応しています。
  変換に失敗した場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real&gt; *R default_format | format @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>&lt;real&gt;</code>を<code>&quot;<var>m</var>.<var>nnnnnnnnnnnn</var>E<var>xx</var>&quot;</code>形式の文字列にフォーマットします。
  非数，正負の無限大は，<code>&quot;NaN&quot;</code>，<code>&quot;Infinity&quot;</code>，<code>&quot;-Infinity&quot;</code>に変換されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.string"><code>sango.string</code></h1>

<p>ストリングを提供します。ストリングの要素の指標は，先頭を0として示します。</p>
<p>ストリングにおける連結，要素の更新，部分ストリングの取得は，新しいストリングを作るために要素をコピーしますので，効率に注意して使用してください。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.string.1"><code>sango.string</code> - 生成</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Count &lt;*A iter&gt; *Iter new_string @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>イテレータによってストリングを生成します。
  <code>Count</code>以上の個数のデータが供給されなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Count &lt;*A iter&gt; *Iter new_reverse_string @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>イテレータから供給される逆順にストリングを生成します。
  <code>Count</code>以上の個数のデータが供給されなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *X elem_to_string | string @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>1個の要素を持つストリングを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *Xs list_to_string | to_string @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>リストをストリングに変換します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.string.2"><code>sango.string</code> - データ供給</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を順に供給するイテレータを返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.string.3"><code>sango.string</code> - 要素処理</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>要素の個数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Pos elem @public -&gt; &lt;A&gt; ;;</code></td></tr></table>
<p>指標<code>Pos</code>の要素を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Start &lt;int&gt; *Count slice @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>指標<code>Start</code>から<code>Count</code>個の要素を取り出します。
  要素の個数が不足する場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Count take @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>先頭から<code>Count</code>個の要素を取り出します。
  要素の個数が不足する場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Count drop @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>先頭から<code>Count</code>個の要素を取り除いた残りを返します。
  要素の個数が不足する場合は例外が発生します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz0 &lt;A string&gt; *Xz1 append @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p><code>Xz0</code>の後に<code>Xz1</code>を連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;*A string&gt; list&gt; *Xzs concat @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>ストリングを順に連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Start &lt;int&gt; *Count elems @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>指標<code>Start</code>から<code>Count</code>個数の要素をリストとして返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz all_elems @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>全ての要素をリストとして返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz
  start_with_seq? | start_with? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>Xz</code>が<code>Yz</code>で開始しているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  start_with_seq_in_region? | start_with_in_region? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲がYzで開始しているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A&gt; *X elem_first_index | first_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>X</code>に等価な（hardに等しい）要素が最初に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A&gt; *X &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  elem_first_index_in_region | first_index_in_region @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲で，Xに等価な（hardに等しい）要素が最初に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz
  seq_first_index | first_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の中で<code>Yz</code>が最初に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  seq_first_index_in_region | first_index_in_region @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲で，<code>Yz</code>が最初に出現する指標を返します。
  等価な部分ストリングが無い場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz
  end_with_seq? | end_with? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>Xz</code>が<code>Yz</code>で終了しているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  end_with_seq_in_region? | end_with_in_region? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲がYzで終了しているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A&gt; *X elem_last_index | last_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>X</code>に等価な（hardに等しい）要素が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A&gt; *X &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  elem_last_index_in_region | last_index_in_region @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲で，<code>X</code>に等価な（hardに等しい）要素が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz
  seq_last_index | last_index @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の中で<code>Yz</code>が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Yz &lt;int&gt; *Range_start &lt;int&gt; *Range_ended
  seq_last_index_in_region | last_index_in_region @public -&gt; &lt;int maybe&gt; ;;</code></td></tr></table>
<p><code>Xz</code>の指標<code>Range_start</code>から(<code>Range_ended</code>-1)の範囲で，<code>Yz</code>が最後に出現する指標を返します。
  含まれていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Pos &lt;A&gt; *X
  replace_elem | replace @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>指標<code>Pos</code>の要素を<code>X</code>に置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;int&gt; *Pos &lt;A string&gt; *Yz
  replace_slice @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>指標<code>Pos</code>からの要素を，<code>Yz</code>の長さだけ<code>Yz</code>に置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A&gt; *Sep split_by_elem @public -&gt; &lt;&lt;A string&gt; list&gt; ;;</code></td></tr></table>
<p><code>Sep</code>に等しい要素で分割します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Sep
  split_by_seq @public -&gt; &lt;&lt;A string&gt; list&gt; ;;</code></td></tr></table>
<p><code>Sep</code>に等しい部分ストリングで分割します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;*A string&gt; list&gt; *Xzs &lt;A&gt; *Sep join_with_elem @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p><code>Sep</code>をはさんでストリングを連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&lt;*A string&gt; list&gt; *Xzs &lt;A string&gt; *Sep
  join_with_seq @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p><code>Sep</code>をはさんでストリングを連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Seq &lt;A string&gt; *New
  replace_first_seq @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p><code>Xz</code>に含まれる最初の<code>Seq</code>を<code>New</code>で置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Seq &lt;A string&gt; *New
  replace_last_seq @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p><code>Xz</code>に含まれる最後の<code>Seq</code>を<code>New</code>で置換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string&gt; *Xz &lt;A string&gt; *Seq &lt;A string&gt; *New
  replace_all_seq @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p><code>Xz</code>に含まれる全ての<code>Seq</code>を<code>New</code>で置換します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.string.4"><code>sango.string</code> - string buffer</h2>

<p>連結するストリングを蓄積しておくオブジェクトです。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A string_buf&gt; @opaque ;;</code></td></tr></table>
<p>string bufferを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval new_string_buf @public -&gt; &lt;*A string_buf&gt; ;;</code></td></tr></table>
<p>空のstring bufferを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string_buf&gt; *Buf &lt;A string&gt; *Az
  sbuf_append_string | append @public -&gt; &lt;A string_buf&gt; ;;</code></td></tr></table>
<p>ストリングを追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string_buf&gt; *Buf sbuf_empty? | empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>空かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string_buf&gt; *Buf sbuf_length | length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>蓄積されている要素の総数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string_buf&gt; *Buf sbuf_pack_all | pack_all @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>蓄積されている要素を全て連結します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A string_buf&gt; *Buf &lt;int&gt; *Len
  sbuf_pack | pack @public -&gt; &lt;&lt;A string&gt; &lt;A string_buf&gt; tuple&gt; ;;</code></td></tr></table>
<p>蓄積されている要素を先頭から<code>Len</code>個連結したストリングと残りの要素を蓄積するstring bufferを返します。
  蓄積されている要素が<code>Len</code>個以下の場合は，すべての要素が連結されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.system"><code>sango.system</code></h1>

<p>システム実行環境等についての関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.system.1"><code>sango.system</code> - システムプロパティ</h2>
<p>システムプロパティは，実行エンジンやプログラムの実行における，いわば環境変数です。
  追加や変更が可能ですが，実行エンジンの動作に不具合を生じる可能性がありますので，あらかじめ登録されている値は変更しないでください。</p>
<p>開始時には，以下のプロパティが登録されています。</p>

<table border>
<tr><th>プロパティ名</th><th>値の型</th><th>説明</th></tr>
<tr><td><code>os.type</code></td><td><code>&lt;cstr&gt;</code></td><td>オペレーティングシステムのタイプ。
  現在サポートされているのは，<code>&quot;winnt&quot;</code>，<code>&quot;unix&quot;</code>。
  この情報は，<code>os_type</code>関数でも取得可能</td></tr>
<tr><td><code>line.terminator</code></td><td><code>&lt;cstr&gt;</code></td><td>行の終端（改行シーケンス。CR，LF，CR+LF）。
  この情報は，<code>line_terminator</code>関数でも取得可能</td></tr>
<tr><td><code>file.separator_char</code></td><td><code>&lt;char&gt;</code></td><td>パスにおける名前の区切り文字。
  この情報は，<code>&quot;sango.io.filesys&quot;.file_separator_char</code>，<code>&quot;sango.io.filesys&quot;.file_separator</code>関数でも取得可能</td></tr>
<tr><td><code>path.separator_char</code></td><td><code>&lt;char&gt;</code></td><td>パスの並びの区切り文字。
  この情報は，<code>&quot;sango.io.filesys&quot;.path_separator_char</code>，<code>&quot;sango.io.filesys&quot;.path_separator</code>関数でも取得可能</td></tr>
<tr><td><code>file.encoding</code></td><td><code>&lt;cstr&gt;</code></td><td>テキストファイルのデフォルトのエンコーディング。
  この情報は，<code>&quot;sango.char.encoding&quot;.default_encoding</code>関数でも取得可能</td></tr>
<tr><td><code>byte_order</code></td><td><code>&lt;cstr&gt;</code></td><td>バイト順。
  ビッグ・エンディアンは<code>&quot;big endian&quot;</code>，リトル・エンディアンは<code>&quot;little endian&quot;</code>
  この情報は，<code>byte_order</code>関数でも取得可能</td></tr>
<tr><td><code>io.temp_dir</code></td><td><code>&lt;cstr&gt;</code></td><td>一時ディレクトリのパス。
  末尾には，パスにおける名前の区切り文字が付加されています。
  この情報は，<code>&quot;sango.io.filesys&quot;.temp_dir</code>関数でも取得可能</td></tr>
<tr><td><code>user.name</code></td><td><code>&lt;cstr&gt;</code></td><td>ユーザのアカウント名</td></tr>
<tr><td><code>user.home_dir</code></td><td><code>&lt;cstr&gt;</code></td><td>ユーザのホームディレクトリのパス。
  末尾には，パスにおける名前の区切り文字が付加されています。</td></tr>
</table>
<p></p>

<table border width="100%"><tr><td class="def"><code>data &lt;prop&gt; @public :=
| &lt;int&gt; int_prop$
| &lt;char&gt; char_prop$
| &lt;cstr&gt; cstr_prop$ ;;</code></td></tr></table>
<p>システムプロパティの値を表します。
  型によってデータ構築子を使い分けます。
  今後，型が追加される可能性があります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Key property @public -&gt; &lt;prop+ maybe&gt; ;;</code></td></tr></table>
<p><code>Key</code>に合致するシステムプロパティを取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Key int_property @public -&gt; &lt;int maybe&gt; ;;
eval &lt;cstr&gt; *Key char_property @public -&gt; &lt;char maybe&gt; ;;
eval &lt;cstr&gt; *Key cstr_property @public -&gt; &lt;cstr maybe&gt; ;;</code></td></tr></table>
<p><code>Key</code>に合致する，それぞれ<code>&lt;int&gt;</code>，<code>&lt;char&gt;</code>，<code>&lt;cstr&gt;</code>のシステムプロパティを取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Key &lt;int&gt; *Default
  int_property_with_default_value | int_property @public -&gt; &lt;int&gt; ;;
eval &lt;cstr&gt; *Key &lt;char&gt; *Default
  char_property_with_default_value | char_property @public -&gt; &lt;char&gt; ;;
eval &lt;cstr&gt; *Key &lt;cstr&gt; *Default
  cstr_property_with_default_value | cstr_property @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>Key</code>に合致する，それぞれ<code>&lt;int&gt;</code>，<code>&lt;char&gt;</code>，<code>&lt;cstr&gt;</code>のシステムプロパティを取得します。
  合致する値が無い場合は，<code>Default</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval os_type @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>オペレーティングシステムのタイプを返します。
  現在サポートされているのは，<code>&quot;winnt&quot;</code>，<code>&quot;unix&quot;</code>です。</p>

<table border width="100%"><tr><td class="def"><code>eval line_terminator @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>行の終端（改行シーケンス。CR，LF，CR+LF）を返します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;byte_order&gt; @public := big_endian$ | little_endian$ ;;
eval byte_order @public -&gt; &lt;byte_order&gt; ;;</code></td></tr></table>
<p>バイト順（ビッグ・エンディアン，リトル・エンディアン）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Key &lt;prop+&gt; *Value add_property @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>システムプロパティとして<code>Value</code>を追加あるいは置き換えます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Key &lt;prop+ prop+ fun&gt; *Upd update_property @public -&gt; &lt;prop+&gt; ;;</code></td></tr></table>
<p>システムプロパティを取得し<code>Upd</code>によって更新した値で置き換えます。
  新しい値を結果として返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.system.os"><code>sango.system.os</code> 【Alpha】</h1>

<p>オペレーティングシステムとのインタフェースを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.system.os.1"><code>sango.system.os</code> - サブプロセス起動</h2>

<p>実行エンジンからサブプロセスを起動し，オペレーティングシステム上のコマンドを実行します。
  サブプロセスを起動すると，その終了待ちを行うアクタが起動されます。
  アクタの終了を待つことでサブプロセスの終了を待ち合わせることができ，サブプロセスの終了コードは，アクタの処理結果として取得できます。
  また，サブプロセスの標準入力，標準出力，標準エラー出力とデータ授受ができます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;process_opts&gt; @public :=
  redirect_err_to_out: &lt;bool&gt;  process_opts$ ;;</code></td></tr></table>
<p>サブプロセス起動のオプションを表します。
  <code>redirect_err_to_out</code>には，標準エラー出力を標準出力にリダイレクトするかどうかを指示します。
  <code>&lt;process_opts&gt;</code>は，今後，拡張されることがありますので，次に示す関数によってデフォルト値を得て，必要な属性を変更して使用してください。</p>

<table border width="100%"><tr><td class="def"><code>eval default_process_opts @public -&gt; &lt;process_opts&gt; ;;</code></td></tr></table>
<p><code>&lt;process_opts&gt;</code>のデフォルト値を返します。<code>redirect_err_to_out</code>は<code>false$</code>です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Command &lt;cstr&gt; *Dir &lt;process_opts&gt; *Opts
  exec @public -&gt; &lt;process_h&gt; ;;</code></td></tr></table>
<p>コマンドをサブプロセスとして起動します。
  <code>Command</code>には，コマンド名とコマンドに渡す引数を指定します。
  <code>Dir</code>には起動されるサブプロセスの作業ディレクトリを指定します。
  <code>&quot;&quot;</code>あるいは<code>&quot;.&quot;</code>の場合，現在の作業ディレクトリが引き継がれます。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;process_h&gt; @opaque ;;</code></td></tr></table>
<p>起動されたサブプロセスへのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *P wait_process_ended | wait | join @public   -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>サブプロセスの終了を待ちます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *P exit_code @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>サブプロセスが実行中の場合は終了を待ち，終了コードを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *P byte_stream_to_process_stdin | to_stdin @public
  -&gt; &lt;byte &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p>サブプロセスの標準入力へのバイトストリームを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *P byte_stream_from_process_stdout | from_stdout @public
  -&gt; &lt;byte &quot;sango.io&quot;.instream_h&gt;</code></td></tr></table>
<p>サブプロセスの標準出力からのバイトストリームを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *P byte_stream_from_process_stderr | from_stderr @public
  -&gt; &lt;&lt;byte &quot;sango.io&quot;.instream_h&gt; maybe&gt;</code></td></tr></table>
<p>サブプロセスの標準エラー出力からのバイトストリームを返します。<code>redirect_err_to_out</code>が<code>true$</code>で起動された場合は，<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *P terminate_process | terminate | kill @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>サブプロセスに終了シグナルを送信します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;process_h&gt; *Producer &lt;process_h&gt; *Consumer 
  connect_processes @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>Producer</code>の標準出力を<code>Consumer</code>の標準入力に接続します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.system.runtime"><code>sango.system.runtime</code></h1>

<p>ランタイムシステムについての関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.system.runtime.1"><code>sango.system.runtime</code> - プログラム実行環境</h2>

<table border width="100%"><tr><td class="def"><code>eval prog_name @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>メインモジュール名を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval args @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p>プログラムに指定されたパラメタを返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.system.runtime.2"><code>sango.system.runtime</code> - 終了</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Exit_code exit @public -&gt; &lt;_&gt; ;;</code></td></tr></table>
<p>終了コード<code>Exit_code</code>にて終了シーケンスを開始します。
  制御は戻りません。</p>
<p>この関数の実装は，<code>{ Exit_code 10000 shutdown, (&quot;sango.actor&quot;.exit$ thru$) "" new_exception &gt;&gt; throw }</code>です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Exit_code &lt;int&gt; *Timeout shutdown @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>終了コード<code>Exit_code</code>，タイムアウト時間<code>timeout</code>ミリ秒にて終了シーケンスを開始します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.actor&quot;.actor_h&gt; *Actor terminate_on_abnormal_end @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>アクタの終了を監視し例外で終了した場合に例外情報を標準エラー出力に出力しプログラム全体をエラー終了させます。
  正常終了した場合，<code>&quot;sango.actor&quot;.exit$</code>例外，<code>(&quot;sango.actor&quot;.exit$ &quot;sango.lang&quot;.thru$)</code>例外の場合には何もしません。
  終了しているアクタに対しても呼び出すことができます。
  メインルーチンあるいはモジュール初期化処理に割り当てられたアクタは，すでにこの関数を呼び出した状態にあります。
  自アクタに対する監視を開始するには，次の関数を呼び出すと簡便です。</p>

<table border width="100%"><tr><td class="def"><code>eval terminate_on_my_abnormal_end @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>これを呼び出したアクタが例外で終了した場合に例外情報を標準エラー出力に出力しプログラム全体をエラー終了させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;void fun&gt; *Action add_action_to_shutdown @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>終了シーケンスが開始されたときに起動されるアクションを登録します。
  すでに終了シーケンスに入っている場合は，速やかにアクションが起動されます。
  起動順序は登録順序と無関係です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.system.runtime.3"><code>sango.system.runtime</code> - その他</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;version&gt; @public :=
  ver_major: &lt;int&gt; ver_minor: &lt;int&gt; ver_micro: &lt;int&gt;
  ver_level_: &lt;cstr maybe&gt; ver_build: &lt;int&gt; ver_full: &lt;cstr&gt; version$ ;;
eval version @public -&gt; &lt;version&gt; ;;</code></td></tr></table>
<p>ランタイムシステムのバージョンを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval gc @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>ランタイムシステムにガーベジコレクションを示唆します。
  実際にガーベジコレクションが起動されるタイミング，およびその終了を待ち合わせるかどうかは，ランタイムシステムの実装に依存します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.tuple"><code>sango.tuple</code></h1>

<p>タプルについてのユーティリティ関数を提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.tuple.1"><code>sango.tuple</code> - 要素取得</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tuple&gt; *X pair_first @public -&gt; &lt;A&gt; ;;
eval &lt;*A *B tuple&gt; *X pair_second @public -&gt; &lt;B&gt; ;;
eval &lt;*A *B *C tuple&gt; *X triple_frist @public -&gt; &lt;A&gt; ;;
eval &lt;*A *B *C tuple&gt; *X triple_second @public -&gt; &lt;B&gt; ;;
eval &lt;*A *B *C tuple&gt; *X triple_third @public -&gt; &lt;C&gt; ;;
eval &lt;*A *B *C *D tuple&gt; *X quadruple_frist @public -&gt; &lt;A&gt; ;;
eval &lt;*A *B *C *D tuple&gt; *X quadruple_second @public -&gt; &lt;B&gt; ;;
eval &lt;*A *B *C *D tuple&gt; *X quadruple_third @public -&gt; &lt;C&gt; ;;
eval &lt;*A *B *C *D tuple&gt; *X quadruple_forth @public -&gt; &lt;D&gt; ;;
eval &lt;*A *B *C *D *E tuple&gt; *X quintuple_frist @public -&gt; &lt;A&gt; ;;
eval &lt;*A *B *C *D *E tuple&gt; *X quintuple_second @public -&gt; &lt;B&gt; ;;
eval &lt;*A *B *C *D *E tuple&gt; *X quintuple_third @public -&gt; &lt;C&gt; ;;
eval &lt;*A *B *C *D *E tuple&gt; *X quintuple_forth @public -&gt; &lt;D&gt; ;;
eval &lt;*A *B *C *D *E tuple&gt; *X quintuple_fifth @public -&gt; &lt;E&gt; ;;</code></td></tr></table>
<p>タプルの要素を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.array"><code>sango.util.array</code> 【Alpha】</h1>

<p>配列は，固定個数の要素を持つコレクションです。
  指標を使って，個々の要素の参照，更新ができます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.array.1"><code>sango.util.array</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A *B array&gt; @public :=
  d: &lt;A B _2+&gt;
  ix: &lt;A &quot;sango.util.enum&quot;.enum&gt;
  fs: &lt;A B array_fs&gt;
  array$ ;;</code></td></tr></table>
<p>カプセル化された配列オブジェクトを表します。
  <code>&lt;A&gt;</code>は指標の型，<code>&lt;B&gt;</code>は要素の型です。
  配列を使用するには属性を意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B array&gt; *Array length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>要素の個数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B array&gt; *Array &lt;A&gt; *Index get @public -&gt; &lt;B&gt; ;;</code></td></tr></table>
<p>指標に対応する要素を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B array&gt; *Array &lt;A&gt; *Index &lt;B&gt; *Value set @public -&gt; &lt;A B array&gt; ;;</code></td></tr></table>
<p>指標に対応する要素を更新し，配列全体を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B array&gt; *Array iter @public -&gt; &lt;&lt;A B tuple&gt; iter&gt; ;;</code></td></tr></table>
<p>指標と要素の組を供給するイテレータを返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.array.2"><code>sango.util.array</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A *B array_fs&gt; @public :=
  get_f: &lt;&lt;A B _2+&gt; A B fun&gt;
  set_f: &lt;&lt;A B _2+&gt; A B &lt;A B _2+&gt; fun&gt;
  array_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree"><code>sango.util.avltree</code> 【Deprecated】</h1>

<p>AVL木の構造をしたマップを提供します。
  キーは順序付け可能でなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A *B tree&gt; @opaque ;;</code></td></tr></table>
<p><code>&lt;A&gt;</code>のキーに対する<code>&lt;B&gt;</code>の値を持つマップを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ord_fs&gt; *Ord new_tree @public -&gt; &lt;A *B tree&gt; ;;</code></td></tr></table>
<p>空のマップを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>マップが空かどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree size @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>マップの大きさ（キーと値のペアの数）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K get @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>キーと値のペアを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K assoc @public -&gt; &lt;B maybe&gt; ;;</code></td></tr></table>
<p>キーに対する値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K contain_key? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>キーが登録されているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K &lt;B&gt; *V
  put @public -&gt; &lt;&lt;A B tree&gt; &lt;&lt;A B tuple&gt; maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>キーと値のペアを登録します。
  キーがすでに登録されている場合は置き換えられた値が共に返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K &lt;B&gt; *V put_new @public -&gt; &lt;&lt;A B tree&gt; bool tuple&gt; ;;</code></td></tr></table>
<p>新しいキーと値のペアを登録します。
  すでにキーが登録されている場合は，マップは変更されずfalse$と共に返されます。
  キーが登録されていない場合は，更新されたマップと<code>true$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K &lt;B&gt; *V add @public -&gt; &lt;A B tree&gt; ;;</code></td></tr></table>
<p>キーと値のペアを登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K remove @public -&gt; &lt;&lt;A B tree&gt; &lt;B maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>キーと値のペアを削除します。
  削除された値が共に返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;A&gt; *K delete @public -&gt; &lt;A B tree&gt; ;;</code></td></tr></table>
<p>キーと値のペアを削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree take @public -&gt; &lt;&lt;&lt;A B tuple&gt; &lt;A B tree&gt; tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>登録されている最も小さいキーと値のペアを削除し，削除されたキーと値のペア，および更新されたマップを返します。
  マップが空だった場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree clear @public -&gt; &lt;A B tree&gt; ;;</code></td></tr></table>
<p>マップを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B tree&gt; *Tree &lt;&lt;A B tuple&gt; list&gt; *KVs add_list @public -&gt; &lt;A B tree&gt; ;;</code></td></tr></table>
<p>リストに含まれるキーと値のペアを全て登録します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree.array"><code>sango.util.avltree.array</code> 【Alpha】</h1>

<p>AVL木による配列の実装です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum.enum&gt; *Enum
  &lt;A *B fun&gt; *Supplier
  &lt;&lt;B &lt;B bool fun&gt; tuple&gt; maybe&gt; *Compact_ 
  new_array @public -&gt; &lt;A B &quot;sango.util.array&quot;.array&gt; ;;</code></td></tr></table>
<p>配列を生成します。<code>Enum</code>には指標を指定します。<code>Supplier</code>には，指標に対する要素の初期値を返す関数を指定します。</p>
<p><code>Compact_<code>には，配列のメモリサイズを小さくする設定を指定します。
  本機能は，タプルの第一要素（以降，C）をAVL木の内部データとして作成することを抑制します。
  Cに配列の中に多く含まれる値を指定すると，効果が増大します。
  タプルの第二要素は，更新しようとする値がCに等しいかどうか判定する関数を指定します。
  例えば，<code>&lt;real&gt;</code>の配列においてCを0.0にする場合，0.0とみなす値の絶対値の範囲を1.0eｰ5以下とするといった設定ができます。
  この場合，更新した要素を参照する場合は0.0が返されます。
</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree.bag"><code>sango.util.avltree.bag</code></h1>

<p>AVL木によるバッグの実装です。
  値は順序付け可能でなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ord_fs&gt; *Ord new_bag @public -&gt; &lt;A &quot;sango.util.bag&quot;.bag&gt; ;;</code></td></tr></table>
<p>空のバッグを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree.map"><code>sango.util.avltree.map</code></h1>

<p>AVL木によるマップの実装です。
  キーは順序付け可能でなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ord_fs&gt; *Ord new_map @public -&gt; &lt;A *B &quot;sango.util.map&quot;.map&gt; ;;</code></td></tr></table>
<p>空のマップを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree.queue"><code>sango.util.avltree.queue</code></h1>

<p>AVL木によるキューの実装です。</p>

<table border width="100%"><tr><td class="def"><code>eval new_queue -&gt; &lt;*A &quot;sango.util.queue&quot;.queue&gt; ;;</code></td></tr></table>
<p>空のキューを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree.ralist"><code>sango.util.avltree.ralist</code></h1>

<p>AVL木によるランダム・アクセス・リストの実装です。</p>

<table border width="100%"><tr><td class="def"><code>eval new_ralist @public -&gt; &lt;*A &quot;sango.util.ralist&quot;.ralist&gt; ;;</code></td></tr></table>
<p>空のランダム・アクセス・リストを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.avltree.set"><code>sango.util.avltree.set</code></h1>

<p>AVL木によるセットの実装です。
  値は順序付け可能でなければなりません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ord_fs&gt; *Ord new_set @public -&gt; &lt;A &quot;sango.util.set&quot;.set&gt; ;;</code></td></tr></table>
<p>空のセットを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.bag"><code>sango.util.bag</code></h1>

<p>バッグは，重複を許す値の集合です。
  バッグを実装するには，さまざまなデータ構造が用いられます。
  それらを統一的に扱えるようにしたフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.bag.1"><code>sango.util.bag</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A bag&gt; @public :=
  d: &lt;A _1+&gt;
  fs: &lt;A bag_fs&gt;
  bag$ ;;</code></td></tr></table>
<p>カプセル化されたバッグオブジェクトを表します。
  <code>&lt;A&gt;</code>は要素の型です。
  バッグを使用するには属性を意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>バッグが空かどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag size @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>バッグの大きさ（要素の数）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem contain? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>値がバッグに登録されているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem get_all @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>バッグに登録されている等価な要素を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem add @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>値をバッグに追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem remove @public -&gt; &lt;&lt;A bag&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p><code>Elem</code>に等価な一つの要素をバッグから削除します。
  処理後のバッグと，実際に削除された（事前に含まれていた）要素が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem
remove_all @public -&gt; &lt;&lt;A bag&gt; &lt;A list&gt; tuple&gt; ;;</code></td></tr></table>
<p><code>Elem</code>に等価な全ての要素をバッグから削除します。
  処理後のバッグと，実際に削除された（事前に含まれていた）要素が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem delete @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p><code>Elem</code>に等価な一つの要素をバッグから削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A&gt; *Elem delete_all @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p><code>Elem</code>に等価な全ての要素をバッグから削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag take @public -&gt; &lt;&lt;A &lt;A bag&gt; tuple&gt; maybe&gt; ;;
</code></td></tr></table>
<p>要素をバッグから一個取り出します。
  取り出された要素と，残りのバッグが返されます。
  バッグが空の場合，<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag clear @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>バッグを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A list&gt; *Elems add_list @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>リストに含まれる値を全て追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A iter&gt; *Iter add_iter @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を全て追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A list&gt; *Elems delete_list @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>リストに含まれる値をそれぞれ削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A iter&gt; *Iter delete_iter @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値をそれぞれ削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A list&gt; *Elems delete_all_list @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>リストに含まれる値を全て削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag&gt; *Bag &lt;A iter&gt; *Iter delete_all_iter @public -&gt; &lt;A bag&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を全て削除します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.bag.2"><code>sango.util.bag</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A bag_fs&gt; @public :=
  empty?_f: &lt;&lt;A _1+&gt; bool fun&gt;
  size_f: &lt;&lt;A _1+&gt; int fun&gt;
  contain?_f: &lt;&lt;A _1+&gt; A bool fun&gt;
  get_all_f: &lt;&lt;A _1+&gt; A &lt;A list&gt; fun&gt;
  add_f: &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt;
  remove_f: &lt;&lt;A _1+&gt; A &lt;&lt;A _1+&gt; &lt;A maybe&gt; tuple&gt; fun&gt;
  remove_all_f: &lt;&lt;A _1+&gt; A &lt;&lt;A _1+&gt; &lt;A list&gt; tuple&gt; fun&gt;
  delete_f_: &lt;&lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; maybe&gt;
  delete_all_f_: &lt;&lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; maybe&gt;
  take_f: &lt;&lt;A _1+&gt; &lt;&lt;A &lt;A _1+&gt; tuple&gt; maybe&gt; fun&gt;
  clear_f: &lt;&lt;A _1+&gt; &lt;A _1+&gt; fun&gt;
  bag_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag_fs&gt; *Fs bag_fs_delete_f | delete_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>指定された値に等価な一つの要素をバッグから削除する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A bag_fs&gt; *Fs
  bag_fs_delete_all_f | delete_all_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>指定された値に等価な全ての要素をバッグから削除する関数を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.bag.simplebag"><code>sango.util.bag.simplebag</code></h1>

<p>バッグの単純な実装（simple bag）を提供します。
  サイズに比例したアクセスコストがかかります。</p>

<table border width="100%"><tr><td class="def"><code>eval new_bag @public -&gt; &lt;*A &quot;sango.util.bag&quot;.bag&gt; ;;</code></td></tr></table>
<p>simple bagのオブジェクトを生成します。
  オブジェクトの等価比較以外でキーを比較する場合は，次の関数を使用します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A eq_fs&gt; *Eq new_bag_eq | new_bag @public -&gt; &lt;A &quot;sango.util.bag&quot;.bag&gt; ;;</code></td></tr></table>
<p>simple bagのオブジェクトを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.datetime"><code>sango.util.datetime</code></h1>

<p>グレオリオ歴での日時に関する機能を提供します。
 扱える期間は協定世界時（Coordinated Universal Time: UTC）で1～9999年，精度はミリ秒です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.datetime.1"><code>sango.util.datetime</code> - 生成・変換</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;date&gt; @protected := year: &lt;int&gt; month: &lt;int&gt; day: &lt;int&gt; date$ ;;</code></td></tr></table>
<p>日付を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;time&gt; @protected := hour: &lt;int&gt; minute: &lt;int&gt; second: &lt;int&gt; millisec: &lt;int&gt; time$ ;;
</code></td></tr></table>
<p>時刻を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;date_time&gt; @public := date: &lt;date&gt; time: &lt;time&gt; date_time$ ;;</code></td></tr></table>
<p>UTCでの日付・時刻を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;local_date_time&gt; @protected :=
 zone_id: &lt;cstr&gt;
 zone_offset: &lt;int&gt;
 date: &lt;date&gt;
 time: &lt;time&gt;
 local_date_time$ ;;</code></td></tr></table>
<p>【Alpha】タイムゾーンでの日付・時刻を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval min_year @public -&gt; &lt;int&gt; ;;
eval max_year @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>扱える年の最小値（1），最大値（9999）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Year &lt;int&gt; *Month &lt;int&gt; *Day date @public -&gt; &lt;date&gt; ;;</code></td></tr></table>
<p>日付データを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Hour &lt;int&gt; *Minute &lt;int&gt; *Second &lt;int&gt; *Millisec time @public -&gt; &lt;time&gt; ;;</code></td></tr></table>
<p>時刻データを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;date&gt; *Date day_in_year @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p><code>Date</code>が1年の何番目の日かを返します。1月1日は0です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Year &lt;int&gt; *Day date_in_year | date @public -&gt; &lt;date&gt; ;;</code></td></tr></table>
<p><code>Year</code>年の<code>Day</code>番目の日付を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;time&gt; *Time millisecs_from_midnight @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p><code>Time</code>の00:00:00からのミリ秒を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Millisecs millisecs_from_midnight_to_time | time @public -&gt; &lt;time&gt; ;;</code></td></tr></table>
<p>00:00:00から<code>Millisecs</code>ミリ秒後の時刻を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bi.bigint&gt; *Millisecs millisecs_to_date_time | date_time @public -&gt; &lt;date_time&gt; ;;</code></td></tr></table>
<p>UTCでの1970年1月1日00:00:00からのミリ秒を日付・時刻に変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;bi.bigint&gt; *Millisecs &lt;cstr&gt; *TZ_id millisecs_to_local_date_time | date_time @public -&gt; &lt;local_date_time&gt; ;;</code></td></tr></table>
<p>UTCでの1970年1月1日00:00:00からのミリ秒を，指定されたタイムゾーンでの日付・時刻に変換します。
 タイムゾーン識別子は，「Asia/Tokyo」のような形式で指定します。
 認識できないタイムゾーン識別子に対しては，世界標準時が使用されます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.datetime.2"><code>sango.util.datetime</code> - 判定</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;int&gt; *Year leap_year? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>閏年かどうかを判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.datetime.3"><code>sango.util.datetime</code> - 比較</h2>

<table border width="100%"><tr><td class="def"><code>eval date_eq_fs @public -&gt; &lt;date eq_fs&gt; ;;
eval time_eq_fs @public -&gt; &lt;time eq_fs&gt; ;;
eval date_time_eq_fs @public -&gt; &lt;date_time eq_fs&gt; ;;</code></td></tr></table>
<p>それぞれの等価判定機能を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval date_ord_fs @public -&gt; &lt;date ord_fs&gt; ;;
eval time_ord_fs @public -&gt; &lt;time ord_fs&gt; ;;
eval date_time_ord_fs @public -&gt; &lt;date_time ord_fs&gt; ;;</code></td></tr></table>
<p>それぞれの大小比較判定機能を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;date&gt; *D0 &lt;date&gt; *D1 date_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;date&gt; *D0 &lt;date&gt; *D1 date_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;date&gt; *D0 &lt;date&gt; *D1 date_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;date&gt; *D0 &lt;date&gt; *D1 date_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;date&gt; *D0 &lt;date&gt; *D1 date_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;date&gt; *D0 &lt;date&gt; *D1 date_ge? | ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>D0</code>の<code>D1</code>に対する大小を判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;time&gt; *T0 &lt;time&gt; *T1 time_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;time&gt; *T0 &lt;time&gt; *T1 time_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;time&gt; *T0 &lt;time&gt; *T1 time_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;time&gt; *T0 &lt;time&gt; *T1 time_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;time&gt; *T0 &lt;time&gt; *T1 time_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;time&gt; *T0 &lt;time&gt; *T1 time_ge? | ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>T0</code>の<code>T1</code>に対する大小を判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;date_time&gt; *DT0 &lt;date_time&gt; *DT1 date_time_compare | compare @public -&gt; &lt;ordering&gt; ;;
eval &lt;date_time&gt; *DT0 &lt;date_time&gt; *DT1 date_time_eq? | eq? @public -&gt; &lt;bool&gt; ;;
eval &lt;date_time&gt; *DT0 &lt;date_time&gt; *DT1 date_time_lt? | lt? @public -&gt; &lt;bool&gt; ;;
eval &lt;date_time&gt; *DT0 &lt;date_time&gt; *DT1 date_time_le? | le? @public -&gt; &lt;bool&gt; ;;
eval &lt;date_time&gt; *DT0 &lt;date_time&gt; *DT1 date_time_gt? | gt? @public -&gt; &lt;bool&gt; ;;
eval &lt;date_time&gt; *DT0 &lt;date_time&gt; *DT1 date_time_ge? | ge? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>DT0</code>の<code>DT1</code>に対する大小を判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.datetime.4"><code>sango.util.datetime</code> - 現在時刻取得</h2>

<table border width="100%"><tr><td class="def"><code>eval millisecs_from_1970 | now @public -&gt; &lt;&quot;sango.num.bigint&quot;.bigint&gt; ;;</code></td></tr></table>
<p>現在の時刻を1970年1月1日00:00:00からのミリ秒で返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.enum"><code>sango.util.enum</code> 【Alpha】</h1>

<p>列挙(enumeration)のフレームワークを提供します。
  列挙は，単一の型の，特定の文脈（context）において順序付けされた有限個の値からなります。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.enum.1"><code>sango.util.enum</code> - フレームワーク</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A enum&gt; @public :=
  context: &lt;A context&gt;
  bounds: &lt;A A tuple&gt;
  enum$ ;;</code></td></tr></table>
<p>カプセル化された列挙オブジェクトを表します。
  <code>&lt;A&gt;</code>は値の型です。
  列挙を使用するには属性を意識する必要はありません。
  </p>
<p><code>context</code>は，文脈です。
  <code>bounds</code>は，範囲（下限と上限）です。要素と一致するとは限りません。</p> 

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum count @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>列挙を構成する要素の個数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum first @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>最初の要素を返します。
  要素が一つも含まれないときは<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum last @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>最後の要素を返します。
  要素が一つも含まれないときは<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum &lt;A&gt; *X contain? @public -&gt; &lt;bool&gt;</code></td></tr></table>
<p><code>X</code>を要素として含むかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum &lt;A&gt; *X succ @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>次の要素を返します。
  <code>X</code>は要素でなければなりません。
  最後の要素に対しては，<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum &lt;A&gt; *X pred @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>前の要素を返します。
  <code>X</code>は要素でなければなりません。
  最初の要素に対しては，<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A enum&gt; *Enum reverse_iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を逆順に供給するイテレータを返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.enum.2"><code>sango.util.enum</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A context&gt; @public :=
  d: &lt;A _1+&gt;
  fs: &lt;A context_fs&gt;
  context$ ;;</code></td></tr></table>
<p>列挙の文脈を表します。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A context_fs&gt; @public :=
  min_ge: &lt;&lt;A _1+&gt; A &lt;A maybe&gt; fun&gt;
  min_gt: &lt;&lt;A _1+&gt; A &lt;A maybe&gt; fun&gt;
  max_le: &lt;&lt;A _1+&gt; A &lt;A maybe&gt; fun&gt;
  max_lt: &lt;&lt;A _1+&gt; A &lt;A maybe&gt; fun&gt;
  contain?_f: &lt;&lt;A _1+&gt; A bool fun&gt;
  count_f: &lt;&lt;A _1+&gt; &lt;A A tuple&gt; int fun&gt;
  ord_fs: &lt;A ord_fs&gt;
  context_fs$ ;;</code></td></tr></table>
<p>文脈の実装関数群を表します。
  <code>min_ge</code>は，その値以上の最小の要素を返します。
  <code>min_gt</code>は，その値より大きい最小の要素を返します。
  <code>max_le</code>は，その値以下の最大の要素を返します。
  <code>max_lt</code>は，その値より小さい最大の要素を返します。
  <code>contain?_f</code>は，値が要素として含まれるかどうかを返します。
  <code>count_f</code>は，要素の個数を返します。
  <code>ord_fs</code>は，大小関係を判定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.iter"><code>sango.util.iter</code></h1>

<p>繰り返しに関する各種オブジェクトを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.iter.1"><code>sango.util.iter</code> - 定数の供給</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A&gt; *K const_iter @public -&gt; &lt;A iter&gt; ;;
</code></td></tr></table>
<p>定数Xを供給し続けるイテレータを返します。
  限りなく値を生成しますので，生成関数を呼び出す側で停止する場合のみに使用してください 。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.iter.2"><code>sango.util.iter</code> - 変形</h2>

<p>イテレータを変形します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *I &lt;A bool fun&gt; *F add_filter @public -&gt; &lt;A iter&gt; ;;
</code></td></tr></table>
<p>値をフィルタする関数を追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *I &lt;A *B fun&gt; *M add_modifier @public -&gt; &lt;B iter&gt; ;; </code></td></tr></table>
<p>値を変更する関数を追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *I &lt;A bool fun&gt; *W add_while @public -&gt; &lt;A iter&gt; ;;
</code></td></tr></table>
<p>【Alpha】生成の継続条件を付加します。
  <code>I</code>が生成した値に対して<code>W</code>が<code>false$</code>を返すと生成を終了します（全体が<code>none$</code>を返します）。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.locale"><code>sango.util.locale</code> 【Alpha】</h1>

<p>言語，国を識別する情報です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;locale&gt; @protected :=
  language: &lt;cstr&gt;
  country: &lt;cstr&gt;
  variant: &lt;cstr&gt;
  locale$ ;;</code></td></tr></table>
<p>ロケールを表します。
  各属性は空文字列の可能性がありますが，少なくとも，<code>language</code>か<code>country</code>のいずれかは空文字列ではありません。
  <code>variant</code>の使用方法は未定義です。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.locale.1"><code>sango.util.locale</code> - 生成</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Language &lt;cstr&gt; *Country locale @public -&gt; &lt;locale&gt; ;;
eval &lt;cstr&gt; *Language &lt;cstr&gt; *Country &lt;cstr&gt; *Variant
  locale_with_variant | locale @public -&gt; &lt;locale&gt; ;;</code></td></tr></table>
<p>ロケールオブジェクトを生成します。
  少なくとも，<code>Language</code>か<code>Country</code>のいずれかは空文字列であってはなりません。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.locale.2"><code>sango.util.locale</code> - デフォルト値</h2>

<table border width="100%"><tr><td class="def"><code>eval default_locale @public -&gt; &lt;locale&gt; ;;</code></td></tr></table>
<p>このプログラムのデフォルトのロケールを取得します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;locale&gt; *Locale set_default_locale @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>このプログラムのデフォルトのロケールを設定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.map"><code>sango.util.map</code></h1>

<p>マップは，キーと値のペアの集合です。
  マップを実装するには，さまざまなデータ構造が用いられます。
  それらを統一的に扱えるようにしたフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.map.1"><code>sango.util.map</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A *B map&gt; @public :=
  d: &lt;A B _2+&gt;
  fs: &lt;A B map_fs&gt;
  map$ ;;</code></td></tr></table>
<p>カプセル化されたマップオブジェクトを表します。
  <code>&lt;A&gt;</code>はキー，<code>&lt;B&gt;</code>は値の型です。
  マップを使用するには属性を意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>マップが空かどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map size @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>マップの大きさ（キーと値のペアの数）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key get @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>キーと値のペアを返します。
  登録されていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key assoc @public -&gt; &lt;B maybe&gt; ;;</code></td></tr></table>
<p>キーに対する値を返します。
  登録されていない場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key contain_key? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>キーがマップに登録されているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key &lt;B&gt; *Value
  put @public -&gt; &lt;&lt;A B map&gt; &lt;&lt;A B tuple&gt; maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップに登録します。
  処理後のマップとすでに登録されていた値が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key &lt;B&gt; *Value
  put_new @public -&gt; &lt;&lt;A B map&gt; bool tuple&gt; ;;</code></td></tr></table>
<p>新しいキーと値のペアをマップに登録します。
  すでにキーが登録されている場合，マップは変化しません。
  処理後のマップとマップの更新有無が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key &lt;B&gt; *Value add @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップに登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key
  remove @public -&gt; &lt;&lt;A B map&gt; &lt;&lt;A B tuple&gt; maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップから削除します。
  処理後のマップと登録されていたペアが返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A&gt; *Key delete @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップから削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map take @public -&gt; &lt;&lt;&lt;A B tuple&gt; &lt;A B map&gt; tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップから一組取り出します。
  取り出されたペアと，残りのマップが返されます。
  マップが空の場合，<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map clear @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>マップを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map iter @public -&gt; &lt;&lt;A B tuple&gt; iter&gt; ;;</code></td></tr></table>
<p>キーと値のペアを供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;&lt;A B tuple&gt; list&gt; *KVs
  add_list @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>リストに含まれるキーと値のペアを全て登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;&lt;A B tuple&gt; iter&gt; *Iter
  add_iter @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>イテレータが供給するキーと値のペアを全て登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A list&gt; *Ks
  delete_list @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>リストに含まれるキーを全て削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map&gt; *Map &lt;A iter&gt; *Iter
  delete_iter @public -&gt; &lt;A B map&gt; ;;</code></td></tr></table>
<p>イテレータが供給するキーを全て削除します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.map.2"><code>sango.util.map</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A *B map_fs&gt; @public :=
  empty?_f: &lt;&lt;A B _2+&gt; bool fun&gt;
  size_f: &lt;&lt;A B _2+&gt; int fun&gt;
  get_f: &lt;&lt;A B _2+&gt; A &lt;&lt;A B tuple&gt; maybe&gt; fun&gt;
  assoc_f_: &lt;&lt;&lt;A B _2+&gt; A &lt;B maybe&gt; fun&gt; maybe&gt;
  contain_key?_f_: &lt;&lt;&lt;A B _2+&gt; A bool fun&gt; maybe&gt;
  put_f: &lt;&lt;A B _2+&gt; A B &lt;&lt;A B _2+&gt; &lt;&lt;A B tuple&gt; maybe&gt; tuple&gt; fun&gt;
  put_new_f_: &lt;&lt;&lt;A B _2+&gt; A B &lt;&lt;A B _2+&gt; bool tuple&gt; fun&gt; maybe&gt;
  add_f_: &lt;&lt;&lt;A B _2+&gt; A B &lt;A B _2+&gt; fun&gt; maybe&gt;
  remove_f: &lt;&lt;A B _2+&gt; A &lt;&lt;A B _2+&gt; &lt;&lt;A B tuple&gt; maybe&gt; tuple&gt; fun&gt;
  delete_f_: &lt;&lt;&lt;A B _2+&gt; A &lt;A B _2+&gt; fun&gt; maybe&gt;
  take_f: &lt;&lt;A B _2+&gt; &lt;&lt;&lt;A B tuple&gt; &lt;A B _2+&gt; tuple&gt; maybe&gt; fun&gt;
  clear_f: &lt;&lt;A B _2+&gt; &lt;A B _2+&gt; fun&gt;
  map_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map_fs&gt; *Fs
  map_fs_assoc_f | assoc_f @public -&gt; &lt;&lt;A B _2+&gt; A &lt;B maybe&gt; fun&gt; ;;</code></td></tr></table>
<p>キーに対する値を返す関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map_fs&gt; *Fs
  map_fs_contain_key?_f | contain_key?_f @public -&gt; &lt;&lt;A B _2+&gt; A bool fun&gt; ;;</code></td></tr></table>
<p>キーがマップに登録されているかどうか判定する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map_fs&gt; *Fs
  map_fs_put_new_f | put_new_f @public -&gt; &lt;&lt;A B _2+&gt; A B &lt;&lt;A B _2+&gt; bool tuple&gt; fun&gt; ;;</code></td></tr></table>
<p>新しいキーと値のペアをマップに登録する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map_fs&gt; *Fs map_fs_add_f | add_f @public -&gt; &lt;&lt;A B _2+&gt; A B &lt;A B _2+&gt; fun&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップに登録する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A *B map_fs&gt; *Fs map_fs_delete_f | delete_f @public -&gt; &lt;&lt;A B _2+&gt; A &lt;A B _2+&gt; fun&gt; ;;</code></td></tr></table>
<p>キーと値のペアをマップから削除する関数を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.map.hashmap"><code>sango.util.map.hashmap</code></h1>

<p>オブジェクトのハッシュ値を使用して，コレクション内部のキー探索を高速化したマップです。</p>

<table border width="100%"><tr><td class="def"><code>eval new_map @public -&gt; &lt;*A *B &quot;sango.util.map&quot;.map&gt; ;;</code></td></tr></table>
<p>マップを生成します。
  オブジェクトの等価比較以外でキーを比較する場合は，次の関数を使用します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A eq_fs&gt; *Eq new_map_eq | new_map @public -&gt; &lt;A *B &quot;sango.util.map&quot;.map&gt; ;;</code></td></tr></table>
<p>マップを生成します。
  <code>Eq</code>にキーの等価比較を行う関数群を指定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.map.simplemap"><code>sango.util.map.simplemap</code></h1>

<p>簡易なマップの実装を提供します。
  サイズに比例したアクセスコストがかかります。</p>

<table border width="100%"><tr><td class="def"><code>eval new_map @public -&gt; &lt;*A *B &quot;sango.util.map&quot;.map&gt; ;;</code></td></tr></table>
<p>simple mapのオブジェクトを生成します。
  オブジェクトの等価比較以外でキーを比較する場合は，次の関数を使用します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A eq_fs&gt; *Eq new_map_eq | new_map @public -&gt; &lt;A *B &quot;sango.util.map&quot;.map&gt; ;;</code></td></tr></table>
<p>simple mapのオブジェクトを生成します。
  <code>Eq</code>にキーの等価比較を行う関数群を指定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.map.weakkeymap"><code>sango.util.map.weakkeymap</code> 【Alpha】</h1>

<p>実体をキーとするマップです。
  キーは弱参照で保持され，これ以外からの参照がなくなると，当該キーと関連データが自動的に削除されます。
  このマップは複数のアクタから共有可能です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! *B! map_h&gt; @opaque ;;</code></td></tr></table>
<p>マップへのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! &quot;sango.entity.existence&quot;.dress_fs&gt; *Dress_fs &lt;*B! dummy&gt; *Assoc
  create_weak_key_map @public -&gt; &lt;A B map_h&gt; ;;</code></td></tr></table>
<p>マップを生成し，ハンドルを返します。
  <code>Dress_fs</code>には，キーとする実体のundress・redress機能関数群を指定します。
  <code>Assoc</code>は関連データの型を指定するためのものです。
  以下に呼び出し例を示します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! *B! map_h&gt; *Map_h all_kvs @public -&gt; &lt;&lt;A B tuple&gt; list&gt; ;;</code></td></tr></table>
<p>有効なキーと関連データの組をリストします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! *B! map_h&gt; *Map_h empty? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h size @public -&gt; &lt;int&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key get @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key assoc @public -&gt; &lt;B maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key contain_key? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key &lt;B&gt; *Value put @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key &lt;B&gt; *Value put_new @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key &lt;B&gt; *Value add @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key remove @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key delete @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h take @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h clear @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;&lt;A B tuple&gt; list&gt; *KVs add_list @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;&lt;A B tuple&gt; iter&gt; *Iter add_iter @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A list&gt; *Ks delete_list @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A iter&gt; *Iter delete_iter @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>マップの対応する関数の機能を提供します。
  ただし，マップ本体は返り値に含まれません。
  <code>empty?</code>関数，<code>size</code>関数においては，実行効率にまつわる実装上の都合により，無効になった弱参照もカウントされることがあるため，厳密な結果が返されるわけではないことに注意してください。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.map.weakvaluemap"><code>sango.util.map.weakvaluemap</code> 【Alpha】</h1>

<p>実体を関連データとするマップです。
  関連データは弱参照で保持され，これ以外からの参照がなくなると，そのキーと当該データが自動的に削除されます。
  このマップは複数のアクタから共有可能です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A *B map_h&gt; @opaque ;;</code></td></tr></table>
<p>マップへのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>alias type &lt;*A *B container&gt; @public := &lt;A &lt;B v&gt; &quot;sango.util.map&quot;.map&gt; ;;
data &lt;*A v&gt; @opaque ;;</code></td></tr></table>
<p>マップの実体（入れ物）を表します。
  生成時にユーザが指定します。
  <code>v</code>は当モジュール内部で使用するデータであり，その内容についてユーザは意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! *B! container&gt; *Container &lt;B &quot;sango.entity.existence&quot;.dress_fs&gt; *Dress_fs
  create_weak_value_map @public -&gt; &lt;A B map_h&gt; ;;
</code></td></tr></table>
<p>マップを生成し，ハンドルを返します。
  <code>Container</code>にはマップの実体（入れ物）を指定します。
  キーへのアクセス効率やメモリ効率を考慮して，適切な実装のマップを指定してください。
  <code>Dress_fs</code>には，関連データとする実体のundress・redress機能関数群を指定します。
  以下に呼び出し例を示します。</p>
<blockquote class="code-sample">コード例
<code>import &quot;sango.util.map.weakvaluemap&quot; -&gt; wvm ;;
import &quot;sango.entity.existence&quot; -&gt; ex ;;
import &quot;sango.entity.box&quot; -&gt; box ;;
import &quot;sango.util.map.simplemap&quot; -&gt; smap ;;
(&amp;\\ &lt;cstr &lt;int box.box_h&gt; wvm.container&gt; { smap.new_map })
  (&amp;\\ &lt;&lt;int box.box_h&gt; ex.dress_fs&gt; { box.dress_fs })
  wvm.create_weak_value_map = ...
</code></blockquote>
<p>この例では，キーが<code>&lt;cstr&gt;</code>，関連データが<code>&lt;int &quot;sango.entity.box&quot;.box_h&gt;</code>のマップを生成しています。
  引数を具象型にするためcastします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! *B! map_h&gt; *Map_h all_kvs @public -&gt; &lt;&lt;A B tuple&gt; list&gt; ;;</code></td></tr></table>
<p>有効なキーと関連データの組をリストします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! *B! map_h&gt; *Map_h empty? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h size @public -&gt; &lt;int&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key get @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key assoc @public -&gt; &lt;B maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key contain_key? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key &lt;B&gt; *Value put @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key &lt;B&gt; *Value put_new @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key &lt;B&gt; *Value add @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key remove @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A&gt; *Key delete @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h take @public -&gt; &lt;&lt;A B tuple&gt; maybe&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h clear @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;&lt;A B tuple&gt; list&gt; *KVs add_list @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;&lt;A B tuple&gt; iter&gt; *Iter add_iter @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A list&gt; *Ks delete_list @public -&gt; &lt;void&gt; ;;
eval &lt;*A! *B! map_h&gt; *Map_h &lt;A iter&gt; *Iter delete_iter @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>マップの対応する関数の機能を提供します。
  ただし，マップ本体は返り値に含まれません。
  <code>empty?</code>関数，<code>size</code>関数においては，実行効率にまつわる実装上の都合により，無効になった弱参照もカウントされることがあるため，厳密な結果が返されるわけではないことに注意してください。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.prop"><code>sango.util.prop</code> 【Alpha】</h1>

<p>プロパティファイルへのアクセス機能を提供します。
  整備中のため，解説しません。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.queue"><code>sango.util.queue</code></h1>

<p>キューは，先入れ先出し（First in First Out，FIFO）のコレクションです。
  キューを実装するには，さまざまなデータ構造が用いられます。
  それらを統一的に扱えるようにしたフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.queue.1"><code>sango.util.queue</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A queue&gt; @public :=
  d: &lt;A _1+&gt;
  fs: &lt;A queue_fs&gt;
  queue$ ;;</code></td></tr></table>
<p>カプセル化されたキューオブジェクトを表します。
  <code>&lt;A&gt;</code>は値の型です。
  キューを使用するには属性を意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>キューが空かどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>キューの長さを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue &lt;A&gt; *Elem enqueue @public -&gt; &lt;A queue&gt; ;;</code></td></tr></table>
<p>値をキューに登録します。
  登録された値はキューの末尾に位置づけられます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue head @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>キューの先頭の値を返します。
  キューが空の場合は，<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue dequeue @public -&gt; &lt;&lt;A &lt;A queue&gt; tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>キューの先頭の値を取り出し，残りのキューと共に返します。
  キューが空の場合は，<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue clear @public -&gt; &lt;A queue&gt; ;;</code></td></tr></table>
<p>キューを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を先頭から順に供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue &lt;A list&gt; *Elems enqueue_list @public -&gt; &lt;A queue&gt; ;;</code></td></tr></table>
<p>リストに含まれる値を順に登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A queue&gt; *Queue &lt;A iter&gt; *Iter enqueue_iter @public -&gt; &lt;A queue&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を順に登録します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.queue.2"><code>sango.util.queue</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A queue_fs&gt; @public :=
  empty?_f: &lt;&lt;A _1+&gt; bool fun&gt;
  length_f: &lt;&lt;A _1+&gt; int fun&gt;
  enqueue_f: &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt;
  head_f: &lt;&lt;A _1+&gt; &lt;A maybe&gt; fun&gt;
  dequeue_f: &lt;&lt;A _1+&gt; &lt;&lt;A &lt;A _1+&gt; tuple&gt; maybe&gt; fun&gt;
  clear_f: &lt;&lt;A _1+&gt; &lt;A _1+&gt; fun&gt;
  queue_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.queue.simplequeue"><code>sango.util.queue.simplequeue</code></h1>

<p>簡易なキューの実装を提供します。長さに比例したアクセスコストがかかることがあります。</p>

<table border width="100%"><tr><td class="def"><code>eval new_queue @public -&gt; &lt;*A &quot;sango.util.queue&quot;.queue&gt; ;;</code></td></tr></table>
<p>simple queueのオブジェクトを生成します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.random"><code>sango.util.random</code></h1>

<p>0.0以上1.0未満の乱数を発生させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.num.bigint&quot;.bigint&gt; *Seed new_generator @public -&gt; &lt;real iter&gt; ;;</code></td></tr></table>
<p>乱数発生器を生成します。<code>Seed</code>には，1以上2<sup>64</sup>-1以下の値を指定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real iter&gt; *Gen start_service @public -&gt; &lt;svc_h&gt; ;;</code></td></tr></table>
<p>乱数発生サービスを開始します。ハンドルを使用して乱数を発生できます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;svc_h&gt; *Svc svc_generate | generate @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>乱数を発生させます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;svc_h&gt; *Svc &lt;real iter&gt; *New_gen svc_set_generator | set_generator @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>乱数発生サービスに乱数発生器を設定しなおします。</p>

<table border width="100%"><tr><td class="def"><code>eval builtin_generate | generate @public -&gt; &lt;real&gt; ;;</code></td></tr></table>
<p>モジュールに組み込まれた乱数発生サービスを使用して乱数を発生させます。このサービスはモジュール初期化時に開始しています。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;real iter&gt; *Gen builtin_set_generator | set_generator @public -&gt; &lt;void&gt;</code></td></tr></table>
<p>モジュールに組み込まれた乱数発生サービスに乱数発生器を設定しなおします。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.ralist"><code>sango.util.ralist</code></h1>

<p>リストの要素を指標によってアクセスするには，指標に比例するコストがかかります。
  このコストを下げたリスト・モデルの実装をランダム・アクセス・リストと呼び，このモジュールでフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.ralist.1"><code>sango.util.ralist</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A ralist&gt; @public :=
  d: &lt;A _1+&gt;
  fs: &lt;A ralist_fs&gt;
  ralist$ ;;</code></td></tr></table>
<p>カプセル化されたランダム・アクセス・リストのオブジェクトを表します。
  <code>&lt;A&gt;</code>は要素の型です。
  ランダム・アクセス・リストを使用するには属性を意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>リストが空かどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List non_empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>リストが要素をもつかどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List length @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>リストの長さ（要素の個数）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Index elem @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を返します。
  先頭は0番目です。
  該当する要素が無い場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List first | head @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>リストの先頭要素を返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List last @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>リストの末尾要素を返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List tail @public -&gt; &lt;&lt;A ralist&gt; maybe&gt; ;;</code></td></tr></table>
<p>リストから先頭要素を取り除いた残りを返します。
  空リストの場合は<code>none$</code>が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Index &lt;A&gt; *X insert_at @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素として<code>X</code>を挿入します。
  <code>Index</code>が負の場合は先頭に挿入します。
  <code>Index</code>が要素の個数以上の場合は末尾に挿入します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;A&gt; *X append @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストの末尾に<code>X</code>を挿入します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Index remove_at @public -&gt; &lt;&lt;A ralist&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を削除し，結果のリストと削除された要素の組を返します。
  該当する要素が無い場合は，リストは変化せず，タプルの第二要素は<code>none$</code>になります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Index delete_at @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を削除します。
  該当する要素が無い場合は，リストは変化しません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Index &lt;A&gt; *X replace_at @public -&gt; &lt;&lt;A ralist&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を<code>X</code>で置換し，結果のリストと置換された要素の組を返します。
  該当する要素が無い場合は，リストは変化せず，タプルの第二要素は<code>none$</code>になります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Index &lt;A&gt; *X update_at @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストの<code>Index</code>番目の要素を<code>X</code>で置換します。
  該当する要素が無い場合は，リストは変化しません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Count take @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストの先頭から<code>Count</code>個の要素をリストとして返します。
  要素の個数が<code>Count</code>個に満たない場合は，リストの全体が返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;int&gt; *Count drop @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストの先頭から<code>Count</code>個の要素を取り除いたリストを返します。
  要素の個数が<code>Count</code>個に満たない場合は，空リストが返ります。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List clear @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>リストを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;A list&gt; *Xs append_list @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p><code>Xs</code>の要素を順に末尾に追加します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist&gt; *List &lt;A iter&gt; *Iter append_iter @public -&gt; &lt;A ralist&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を順に末尾に追加します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.ralist.2"><code>sango.util.ralist</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A ralist_fs&gt; @public :=
  empty?_f_: &lt;&lt;&lt;A _1+&gt; bool fun&gt; maybe&gt;
  length_f: &lt;&lt;A _1+&gt; int fun&gt;
  elem_f: &lt;&lt;A _1+&gt; int &lt;A maybe&gt; fun&gt;
  first_f_: &lt;&lt;&lt;A _1+&gt; &lt;A maybe&gt; fun&gt; maybe&gt;
  last_f_: &lt;&lt;&lt;A _1+&gt; &lt;A maybe&gt; fun&gt; maybe&gt;
  tail_f_: &lt;&lt;&lt;A _1+&gt; &lt;&lt;A _1+&gt; maybe&gt; fun&gt; maybe&gt;
  insert_at_f: &lt;&lt;A _1+&gt; int A &lt;A _1+&gt; fun&gt;
  append_f_: &lt;&lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; maybe&gt;
  remove_at_f: &lt;&lt;A _1+&gt; int &lt;&lt;A _1+&gt; &lt;A maybe&gt; tuple&gt; fun&gt;
  replace_at_f_: &lt;&lt;&lt;A _1+&gt; int A &lt;&lt;A _1+&gt; &lt;A maybe&gt; tuple&gt; fun&gt; maybe&gt;
  take_f_: &lt;&lt;&lt;A _1+&gt; int &lt;A _1+&gt; fun&gt; maybe&gt;
  drop_f_: &lt;&lt;&lt;A _1+&gt; int &lt;A _1+&gt; fun&gt; maybe&gt;
  clear_f: &lt;&lt;A _1+&gt; &lt;A _1+&gt; fun&gt;
  ralist_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_empty?_f | empty?_f @public -&gt; &lt;&lt;A _1+&gt; bool fun&gt; ;;</code></td></tr></table>
<p>リストが空かどうかを判定する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_first_f | first_f @public -&gt; &lt;&lt;A _1+&gt; &lt;A maybe&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの先頭要素を返す関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_last_f | last_f @public -&gt; &lt;&lt;A _1+&gt; &lt;A maybe&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの末尾要素を返す関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_tail_f | tail_f @public -&gt; &lt;&lt;A _1+&gt; &lt;&lt;A _1+&gt; maybe&gt; fun&gt; ;;</code></td></tr></table>
<p>先頭要素を除いたリストを返す関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_append_f | append_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>値をリストの末尾に追加する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_delete_at_f | delete_at_f @public -&gt; &lt;&lt;A _1+&gt; int &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの指標の位置の要素を削除する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_replace_at_f | replace_at_f @public -&gt; &lt;&lt;A _1+&gt; int A &lt;&lt;A _1+&gt; &lt;A maybe&gt; tuple&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの指標の位置の要素を置換する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_update_at_f | update_at_f @public -&gt; &lt;&lt;A _1+&gt; int A &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの指標の位置の要素を置換する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_take_f | take_f @public -&gt; &lt;&lt;A _1+&gt; int &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの先頭から指定された個数の要素を取り出す関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A ralist_fs&gt; *Fs ralist_fs_drop_f | drop_f @public -&gt; &lt;&lt;A _1+&gt; int &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>リストの先頭から指定された個数の要素を除く関数を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.set"><code>sango.util.set</code></h1>

<p>セットは，重複のない値の集合です。
  セットを実装するには，さまざまなデータ構造が用いられます。
  それらを統一的に扱えるようにしたフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.set.1"><code>sango.util.set</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*D *A set&gt; @public :=
  d: &lt;A _1+&gt;
  fs: &lt;A set_fs&gt;
  set$ ;;</code></td></tr></table>
<p>カプセル化されたセットオブジェクトを表します。
  <code>&lt;A&gt;</code>は要素の型です。
  セットを使用するには属性を意識する必要はありません。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>セットが空かどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set size @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>セットの大きさ（値の数）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Elem get @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>セットに登録されている等価な値を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Elem contain? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>値がセットに登録されているかどうか判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Elem put @public -&gt; &lt;&lt;A set&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>値をセットに登録します。
  処理後のセットと，登録されていた値が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Elem put_new @public -&gt; &lt;&lt;A set&gt; bool tuple&gt; ;;</code></td></tr></table>
<p>新しい値をセットに登録します。
  すでに値が登録されている場合，セットは変化しません。
  処理後のセットとセットの更新有無が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Elem add @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>値をセットに登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Eelm remove @public -&gt; &lt;&lt;A set&gt; &lt;A maybe&gt; tuple&gt; ;;</code></td></tr></table>
<p>値をセットから削除します。
  処理後のセットと，実際に削除された（事前に含まれていた）値が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A&gt; *Elem delete @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>値をセットから削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set take @public -&gt; &lt;&lt;A &lt;A set&gt; tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>値をセットから一個取り出します。
  取り出された値と，残りのセットが返されます。
  セットが空の場合，<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set clear @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>セットを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素を供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A list&gt; *Elems contain_just_list? | contain_just? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>セットの要素がリストに含まれる値と同一か判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A iter&gt; *Iter contain_just_iter? | contain_just? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>セットの要素がイテレータの供給する値と同一か判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A list&gt; *Elems add_list @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>リストに含まれる値を全て登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A iter&gt; *Iter add_iter @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を全て登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A list&gt; *Elems delete_list @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>リストに含まれる値を全て削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A iter&gt; *Iter delete_iter @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を全て削除します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set &lt;A bool fun&gt; *Filter filter @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p><code>Filter</code>の条件を満たす要素の集合を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set0 &lt;A set&gt; *Set1 intersection @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p><code>Set1</code>に含まれる<code>Set0</code>の要素の集合（<code>Set0</code>と<code>Set1</code>の積集合）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set&gt; *Set0 &lt;A set&gt; *Set1 difference @public -&gt; &lt;A set&gt; ;;</code></td></tr></table>
<p><code>Set1</code>に含まれない<code>Set0</code>の要素の集合（<code>Set0</code>と<code>Set1</code>の差集合）を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.set.2"><code>sango.util.set</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A set_fs&gt; @public :=
  empty?_f: &lt;&lt;A _1+&gt; bool fun&gt;
  size_f: &lt;&lt;A _1+&gt; int fun&gt;
  get_f: &lt;&lt;A _1+&gt; A &lt;A maybe&gt; fun&gt;
  contain?_f_: &lt;&lt;&lt;A _1+&gt; A bool fun&gt; maybe&gt;
  put_f: &lt;&lt;A _1+&gt; A &lt;&lt;A _1+&gt; &lt;A maybe&gt; tuple&gt; fun&gt;
  put_new_f_: &lt;&lt;&lt;A _1+&gt; A &lt;&lt;A _1+&gt; bool tuple&gt; fun&gt; maybe&gt;
  add_f_: &lt;&lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt;  maybe&gt;
  remove_f: &lt;&lt;A _1+&gt; A &lt;&lt;A _1+&gt; &lt;A maybe&gt; tuple&gt; fun&gt;
  delete_f_: &lt;&lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; maybe&gt;
  take_f: &lt;&lt;A _1+&gt; &lt;&lt;A &lt;A _1+&gt; tuple&gt; maybe&gt; fun&gt;
  clear_f: &lt;&lt;A _1+&gt; &lt;A _1+&gt; fun&gt;
  set_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set_fs&gt; *Fs
  set_fs_contain?_f | contain?_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;bool&gt; fun&gt; ;;</code></td></tr></table>
<p>値がセットに登録されているかどうか判定する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set_fs&gt; *Fs set_fs_add_f | add_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>値をセットに登録する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set_fs&gt; *Fs
  set_fs_put_new_f | put_new_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;&lt;A _1+&gt; bool tuple&gt; fun&gt; ;;</code></td></tr></table>
<p>新しい値をセットに登録する関数を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A set_fs&gt; *Fs set_fs_delete_f | delete_f @public -&gt; &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt; ;;</code></td></tr></table>
<p>値をセットから削除する関数を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.set.hashset"><code>sango.util.set.hashset</code></h1>

<p>オブジェクトのハッシュ値を使用して，コレクション内部の探索を高速化したセットです。</p>

<table border width="100%"><tr><td class="def"><code>eval new_set @public -&gt; &lt;*A &quot;sango.util.set&quot;.set&gt; ;;</code></td></tr></table>
<p>セットを生成します。
  オブジェクトの等価比較以外で比較する場合は，次の関数を使用します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A eq_fs&gt; *Eq new_set_eq | new_set @public -&gt; &lt;A &quot;sango.util.set&quot;.set&gt; ;;</code></td></tr></table>
<p>セットを生成します。
  <code>Eq</code>に値の等価比較を行う関数群を指定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.set.simpleset"><code>sango.util.set.simpleset</code></h1>

<p>簡易なセットの実装を提供します。
  サイズに比例したアクセスコストがかかります。</p>

<table border width="100%"><tr><td class="def"><code>eval new_set @public -&gt; &lt;*A &quot;sango.util.set&quot;.set&gt; ;;</code></td></tr></table>
<p>セットを生成します。
  オブジェクトの等価比較以外で比較する場合は，次の関数を使用します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A eq_fs&gt; *Eq new_set_eq | new_set @public
  -&gt; &lt;A &quot;sango.util.set&quot;.set&gt; ;;</code></td></tr></table>
<p>セットを生成します。
  <code>Eq</code>に値の等価比較を行う関数群を指定します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.set.weakset"><code>sango.util.set.weakset</code> 【Alpha】</h1>

<p>実体を要素とするセットです。
  要素は弱参照で保持され，これ以外からの参照がなくなると，自動的に削除されます。
  このセットは複数のアクタから共有可能です。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A! set_h&gt; @opaque ;;</code></td></tr></table>
<p>セットへのハンドルを表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! &quot;sango.entity.existence&quot;.dress_fs&gt; *Dress_fs create_weak_set @public -&gt; &lt;A set_h&gt; ;;</code></td></tr></table>
<p>セットを生成し，ハンドルを返します。
  <code>Dress_fs</code>には，要素とする実体のundress・redress機能関数群を指定します。
  以下に呼び出し例を示します。</p>
<blockquote class="code-sample">コード例
<code>import &quot;sango.util.map.weakset&quot; -&gt; ws ;;
import &quot;sango.entity.existence&quot; -&gt; ex ;;
import &quot;sango.entity.box&quot; -&gt; box ;;
(&amp;\\ &lt;&lt;int box.box_h&gt; ex.dress_fs&gt; { box.dress_fs })
  ws.create_weak_set = ...</code></blockquote>
<p>この例では，要素が<code>&lt;int &quot;sango.entity.box&quot;.box_h&gt;</code>のセットを生成しています。
  引数を具象型にするためcastします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! set_h&gt; *Set_h all_elems @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>有効な要素をリストします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A! set_h&gt; *Set_h empty? @public -&gt; &lt;bool&gt;  ;;
eval &lt;*A! set_h&gt; *Set_h size @public -&gt; &lt;int&gt;  ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X get @public -&gt; &lt;A maybe&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X contain? @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X put @public -&gt; &lt;A maybe&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X put_new @public -&gt; &lt;bool&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X add @public -&gt; &lt;void&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X remove @public -&gt; &lt;A maybe&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A&gt; *X delete @public -&gt; &lt;void&gt; ;;
eval &lt;*A! set_h&gt; *Set_h take @public -&gt; &lt;A maybe&gt; ;;
eval &lt;*A! set_h&gt; *Set_h clear @public -&gt; &lt;void&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A list&gt; *Xs add_list @public -&gt; &lt;void&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A iter&gt; *Iter add_iter @public -&gt; &lt;void&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A list&gt; *Xs delete_list @public -&gt; &lt;void&gt; ;;
eval &lt;*A! set_h&gt; *Set_h &lt;A iter&gt; *Iter delete_iter @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p>セットの対応する関数の機能を提供します。
  ただし，セット本体は返り値に含まれません。
  <code>empty?</code>関数，<code>size</code>関数においては，実行効率にまつわる実装上の都合により，無効になった弱参照もカウントされることがあるため，厳密な結果が返されるわけではないことに注意してください。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.shell"><code>sango.util.shell</code> 【Alpha】</h1>

<p>シェルプログラミングのユーティリティ機能を提供します。
  実際に処理を行う関数へ中継する関数を多く提供します。
  これらを使用することにより，インポートを簡素化することができます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.1"><code>sango.util.shell</code> - プログラム実行環境取得</h2>

<table border width="100%"><tr><td class="def"><code>eval prog_name @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.system.runtime&quot;.prog_name }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval args @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.system.runtime&quot;.args }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.2"><code>sango.util.shell</code> - ディレクトリとファイルの操作</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path exist? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.exist?  }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path directory? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.directory? }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path file? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.file? }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path last_updated @public -&gt; &lt;&quot;sango.num.bigint&quot;.bigint&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.last_updated }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path absolute_path | absolute @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.absolute_path }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path delete @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.delete }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path_cur &lt;cstr&gt; *Path_new move @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ Path_cur Path_new &quot;sango.io.filesys&quot;.move }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path dir_entries @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.dir_entries }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path create_dir @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.create_dir }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path create_dirs @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.create_dirs }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.3"><code>sango.util.shell</code> - パスの操作</h2>

<table border width="100%"><tr><td class="def"><code>eval file_separator @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.filesys&quot;.file_separator }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval file_separator_char @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.filesys&quot;.file_separator_char }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval path_separator @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.filesys&quot;.path_separator }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval path_separator_char @public -&gt; &lt;char&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.filesys&quot;.path_separator_char }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval current_dir_name @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.filesys&quot;.current_dir_name }を実行します。</code></p>

<table border width="100%"><tr><td class="def"><code>eval parent_dir_name @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.filesys&quot;.parent_dir_name }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  path_area @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.path_area }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  path_base_name @public -&gt; &lt;cstr maybe&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.path_base_name }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  path_names @public -&gt; &lt;cstr list&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.path_names }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Area &lt;cstr list&gt; *Names
  new_path @public -&gt; &lt;&quot;sango.io.filesys&quot;.path_struct&gt; ;;</code></td></tr></table>
<p><code>{ Area Names &quot;sango.io.filesys&quot;.new_path }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  absolute_path? | absolute? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.absolute_path? }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  parent_path @public -&gt; &lt;&quot;sango.io.filesys&quot;.path_struct maybe&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.parent_path }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS &lt;cstr&gt; *Child
  child_path @public -&gt; &lt;&quot;sango.io.filesys&quot;.path_struct&gt; ;;</code></td></tr></table>
<p><code>{ PS Child &quot;sango.io.filesys&quot;.child_path }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Names
  new_relative_path @public -&gt; &lt;&quot;sango.io.filesys&quot;.path_struct&gt; ;;</code></td></tr></table>
<p><code>{ Names &quot;sango.io.filesys&quot;.new_relative_path }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Path parse_path | parse @public
  -&gt; &lt;&quot;sango.io.filesys&quot;.path_struct&gt; ;;</code></td></tr></table>
<p><code>{ Path &quot;sango.io.filesys&quot;.parse_path }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  path_repr | repr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.path_repr }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io.filesys&quot;.path_struct&gt; *PS
  dir_path_repr @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ PS &quot;sango.io.filesys&quot;.dir_path_repr }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *Name split_ext @public -&gt; &lt;cstr cstr tuple&gt; ;;</code></td></tr></table>
<p><code>{ Name &quot;sango.io.filesys&quot;.split_ext }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.4"><code>sango.util.shell</code> - バイトストリーム</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *File open_byte_instream @public
  -&gt; &lt;byte &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p><code>{ File &quot;sango.io.filesys&quot;.open_byte_instream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *File open_byte_outstream_init | open_byte_outstream @public
  -&gt; &lt;byte &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p><code>{ File &quot;sango.io.filesys&quot;.open_byte_outstream_init }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *File &lt;bool&gt; *Append open_byte_outstream @public
  -&gt; &lt;byte &quot;sango.io&quot;.outstream_h&gt; ;;
</code></td></tr></table>
<p><code>{ File Append &quot;sango.io.filesys&quot;.open_byte_outstream }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.5"><code>sango.util.shell</code> - 文字ストリーム</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte &quot;sango.io&quot;.instream_h&gt; *BI
  open_char_instream_for_default_encoding | open_char_instream @public
  -&gt; &lt;char &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p><code>{ BI &quot;sango.io&quot;.open_char_instream_for_default_encoding }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte &quot;sango.io&quot;.instream_h&gt; *BI
  &lt;&quot;sango.char.encoding&quot;.decoder_h&gt; *Decoder
  open_char_instream @public -&gt; &lt;char &quot;sango.io&quot;.instream_h&gt; ;;</code></td></tr></table>
<p><code>{ BI Decoder &quot;sango.io&quot;.open_char_instream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte &quot;sango.io&quot;.outstream_h&gt; *BO
  open_char_outstream_for_default_encoding | open_char_outstream @public
  -&gt; &lt;char &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p><code>{ BO &quot;sango.io&quot;.open_char_outstream_for_default_encoding }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.char.encoding&quot;.encoder_h&gt; *Encoder
  &lt;byte &quot;sango.io&quot;.outstream_h&gt; *BO
  open_char_outstream @public -&gt; &lt;char &quot;sango.io&quot;.outstream_h&gt; ;;</code></td></tr></table>
<p><code>{ Encoder BO open_char_outstream }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.6"><code>sango.util.shell</code> - 行入力ストリーム</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte &quot;sango.io&quot;.instream_h&gt; *BI
  open_line_instream_for_default_encoding_from_byte_instream | open_line_instream @public
  -&gt; &lt;&quot;sango.io&quot;.line_instream_h&gt; ;;</code></td></tr></table>
<p><code>{ BI &quot;sango.io&quot;.open_line_instream_for_default_encoding_from_byte_instream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char &quot;sango.io&quot;.instream_h&gt; *CI
  open_line_instream_from_char_instream | open_line_instream @public
  -&gt; &lt;&quot;sango.io&quot;.line_instream_h&gt; ;;</code></td></tr></table>
<p><code>{ CI &quot;sango.io&quot;.open_line_instream_from_char_instream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.line_instream_h&gt; *In
  read_line_from_line_instream | read_line @public
  -&gt; &lt;cstr.line &quot;sango.io&quot;.instream_read_res&gt; ;;</code></td></tr></table>
<p><code>{ In &quot;sango.io&quot;.read_line_from_line_instream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.line_instream_h&gt; *In
  close_line_instream | close @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ In &quot;sango.io&quot;.close_line_instream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.line_instream_h&gt; *In
  line_instream_status | status @public -&gt; &lt;&quot;sango.io&quot;.instream_status&gt; ;;</code></td></tr></table>
<p><code>{ In &quot;sango.io&quot;.line_instream_status }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.7"><code>sango.util.shell</code> - プリントストリーム</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;byte &quot;sango.io&quot;.outstream_h&gt; *BO
  open_print_stream_to_byte_outstream | open_print_stream @public
  -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p><code>{ BO &quot;sango.io&quot;.open_default_print_stream_to_byte_outstream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char &quot;sango.io&quot;.outstream_h&gt; *CO
  open_print_stream @public -&gt; &lt;&quot;sango.io&quot;.print_stream_h&gt; ;;</code></td></tr></table>
<p><code>{ CO &quot;sango.io&quot;.open_print_stream_with_default_line_terminator }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out &lt;char&gt; *Char
  print_raw_char | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out Char &quot;sango.io&quot;.print_raw_char }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out &lt;cstr&gt; *CharStr
  print_raw_cstr | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out CharStr &quot;sango.io&quot;.print_raw_cstr }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out &lt;cstr&gt; *CharStr &lt;int&gt; *Start &lt;int&gt; *Len
  print_raw_cstr_part | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out CharStr Start Len &quot;sango.io&quot;.print_raw_cstr_part }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out &lt;cstr&gt; *CharStr
  print_cstr | print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out CharStr &quot;sango.io&quot;.print_cstr }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out &lt;cstr&gt; *CharStr
  print_and_newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out CharStr &quot;sango.io&quot;.print_and_newline }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out
  flush_print_stream | flush @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out &quot;sango.io&quot;.flush_print_stream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out
  close_print_stream | close @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out &quot;sango.io&quot;.close_print_stream }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out
  print_stream_status | status @public -&gt; &lt;&quot;sango.io&quot;.outstream_status&gt; ;;</code></td></tr></table>
<p><code>{ Out &quot;sango.io&quot;.print_stream_status }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.io&quot;.print_stream_h&gt; *Out
  break_print_stream | newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ Out &quot;sango.io&quot;.break_print_stream }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.8"><code>sango.util.shell</code> - 標準入出力</h2>

<table border width="100%"><tr><td class="def"><code>eval cstdin_read_line | read_line @public
  -&gt; &lt;&quot;sango.cstr&quot;.line &quot;sango.io&quot;.instream_read_res&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstdin_read_line }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;char&gt; *C cstdout_print_raw_char | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ C &quot;santo.io.stdio&quot;.cstdout_print_raw_char }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S cstdout_print_cstr | print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ S &quot;sango.io.stdio&quot;.cstdout_print_cstr }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S cstdout_print_cstr_and_newline | print_and_newline @public
  -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ S &quot;sango.io.stdio&quot;.cstdout_print_cstr_and_newline }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S &lt;int&gt; *Start &lt;int&gt; *Len
  cstdout_print_cstr_raw_part | print_raw @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ S Start Len &quot;sango.io.stdio&quot;.cstdout_print_cstr_raw_part }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdout_flush | flush @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstdout_flush }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstdout_newline | newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstdout_newline }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S cstderr_print_cstr | e_print @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstderr S io.print_cstr }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr&gt; *S cstderr_print_cstr_and_newline | e_print_and_newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstderr S &quot;sango.io&quot;.print_and_newline }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstderr_flush | e_flush @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstderr &quot;sango.io&quot;.flush }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval cstderr_newline | e_newline @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.io.stdio&quot;.cstderr &quot;sango.io&quot;.newline }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.9"><code>sango.util.shell</code> - システムプロパティ</h2>

<table border width="100%"><tr><td class="def"><code>eval line_terminator @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p><code>{ &quot;sango.system&quot;.line_terminator }</code>を実行します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.shell.10"><code>sango.util.shell</code> - サブプロセス起動</h2>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Command exec_command | exec @public
  -&gt; &lt;&quot;sango.system.os&quot;.process_h&gt; ;;</code></td></tr></table>
<p></code>{ Command "" exec_in }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;cstr list&gt; *Command &lt;cstr&gt; *Dir exec_command_in | exec_in @public
  -&gt; &lt;&quot;sango.system.os&quot;.process_h&gt; ;;</code></td></tr></table>
<p><code>{ Command Dir &quot;sango.system.os&quot;.default_process_opts &quot;sango.system.os&quot;.exec }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.system.os&quot;.process_h list&gt;
  *Processes connect_processes @public -&gt; &lt;void&gt; ;;</code></td></tr></table>
<p><code>&quot;sango.system.os&quot;.connect_processes</code>を使用して，プロセスを順に接続します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.system.os&quot;.process_h&gt; *P
  process_exit_code | exit_code @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p><code>{ P &quot;sango.system.os&quot;.exit_code }</code>を実行します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.system.os&quot;.process_h&gt; *P
  take_output @public -&gt; &lt;cstr&gt; ;;</code></td></tr></table>
<p>プロセスの標準出力を1行取得し，行の終端を取り除いて返します。
行が取得できない場合は，空文字列を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;&quot;sango.system.os&quot;.process_h&gt; *P &lt;int maybe&gt; *Count_
  take_lines @public -&gt; &lt;&quot;sango.cstr&quot;.line list&gt; ;;</code></td></tr></table>
<p>プロセスの標準出力を取得します。
<code>Count_</code>が指定されている場合は，その行数だけ取得し，残りの行は破棄します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.sort"><code>sango.util.sort</code></h1>

<p>ソート機能を提供します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *List &lt;A ord_fs&gt; *Ord sort_list | sort @public -&gt; &lt;A list&gt; ;;
eval &lt;*A string&gt; *Str &lt;A ord_fs&gt; *Ord sort_string | sort @public -&gt; &lt;A string&gt; ;;</code></td></tr></table>
<p>それぞれ，リスト，ストリングの要素を<code>Ord</code>の順序関係でソートします。
  互いに等価な値の順序は，元の順序に保たれます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A iter&gt; *Iter &lt;A ord_fs&gt; *Ord sort @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p><code>Iter</code>から供給される値を，<code>Ord</code>の順序関係でソートします。
  互いに等価な値の順序は，供給の順序に保たれます。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.stack"><code>sango.util.stack</code></h1>

<p>スタックは，後入れ先出し（Last In First Out，LIFO）のコレクションです。
  スタックを実装するにはリストを使うのが一般的ですが，それ以外の実装もありえます。
  それらを統一的に扱えるようにしたフレームワークを提供します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.stack.1"><code>sango.util.stack</code> - フレームワーク</h2>

<p>データと機能関数群をカプセル化しています。</p>

<table border width="100%"><tr><td class="def"><code>data &lt;*A stack&gt; @public :=
  d: &lt;A _1+&gt;
  fs: &lt;A stack_fs&gt;
  stack$ ;;</code></td></tr></table>
<p>カプセル化されたスタックオブジェクトを表します。
  &lt;A&gt;は値の型です。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack empty? @public -&gt; &lt;bool&gt; ;;</code></td></tr></table>
<p>スタックが空かどうかを判定します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack depth @public -&gt; &lt;int&gt; ;;</code></td></tr></table>
<p>スタックの深さ（値の数）を返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack &lt;A&gt; *Elem push @public -&gt; &lt;A stack&gt; ;;</code></td></tr></table>
<p>値をスタックに登録します。
  登録された値はスタックの一番上に位置づけられます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack top @public -&gt; &lt;A maybe&gt; ;;</code></td></tr></table>
<p>スタックの一番上の値を返します。
  スタックが空の場合は<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack pop @public -&gt; &lt;&lt;A &lt;A stack&gt; tuple&gt; maybe&gt; ;;</code></td></tr></table>
<p>スタックの一番上の値を取り出し，残りのスタックと共に返します。
  スタックが空の場合は<code>none$</code>が返されます。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack to_list @public -&gt; &lt;A list&gt; ;;</code></td></tr></table>
<p>スタックをリストに変換します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack clear @public -&gt; &lt;A stack&gt; ;;</code></td></tr></table>
<p>スタックを空にします。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack iter @public -&gt; &lt;A iter&gt; ;;</code></td></tr></table>
<p>要素をスタックの上から順に供給するイテレータを返します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack &lt;A list&gt; *Elems push_list @public -&gt; &lt;A stack&gt; ;;</code></td></tr></table>
<p>リストに含まれる値を全て登録します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack&gt; *Stack &lt;A iter&gt; *Iter push_iter @public -&gt; &lt;A stack&gt; ;;</code></td></tr></table>
<p>イテレータが供給する値を全て登録します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h2 id="sango.util.stack.2"><code>sango.util.stack</code> - 実装者向け情報</h2>

<table border width="100%"><tr><td class="def"><code>data &lt;*A stack_fs&gt; @public :=
  empty?_f: &lt;&lt;A _1+&gt; bool fun&gt;
  depth_f: &lt;&lt;A _1+&gt; int fun&gt;
  push_f: &lt;&lt;A _1+&gt; A &lt;A _1+&gt; fun&gt;
  top_f: &lt;&lt;A _1+&gt; &lt;A maybe&gt; fun&gt;
  pop_f: &lt;&lt;A _1+&gt; &lt;&lt;A &lt;A _1+&gt; tuple&gt; maybe&gt; fun&gt;
  to_list_f_: &lt;&lt;&lt;A _1+&gt; &lt;A list&gt; fun&gt; maybe&gt;
  clear_f: &lt;&lt;A _1+&gt; &lt;A _1+&gt; fun&gt;
  stack_fs$ ;;</code></td></tr></table>
<p>機能関数群を表します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A stack_fs&gt; *Fs stack_fs_to_list_f | to_list_f @public -&gt; &lt;&lt;A _1+&gt; &lt;A list&gt; fun&gt; ;;</code></td></tr></table>
<p>リストに変換する関数を返します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>
<h1 id="sango.util.stack.liststack"><code>sango.util.stack.liststack</code></h1>

<p>リストをスタックのフレームワークで使用できるようラップしたオブジェクトを提供します。
  リストとの相互変換を低コストで行います。</p>

<table border width="100%"><tr><td class="def"><code>eval new_stack @public -&gt; &lt;*A &quot;sango.util.stack&quot;.stack&gt; ;;</code></td></tr></table>
<p>空のスタックを生成します。</p>

<table border width="100%"><tr><td class="def"><code>eval &lt;*A list&gt; *L to_stack @public -&gt; &lt;A &quot;sango.util.stack&quot;.stack&gt; ;;</code></td></tr></table>
<p>リストをスタックに変換します。</p>

<p class="toc-ref"><a href="#toc">[目次]</a></p>

</body>
</html>
